<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="LyX 2.3.6" name="GENERATOR"/>
<meta content="text/html;charset=utf-8" http-equiv="Content-type"/>
<title>ML-MDS - Machine Learning</title>
<style type="text/css">
/* LyX Provided Styles */
mstyle.math { font-style: italic; }
div.bibtexentry { margin-left: 2em; text-indent: -2em; }
span.bibtexlabel:before{ content: "["; }
span.bibtexlabel:after{ content: "] "; }

/* Layout-provided Styles */
h1.title {
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.date {
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: center;

}
div.author {
font-size: large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.standard {
	margin-bottom: 2ex;
}
div.address {
margin-bottom: 1.5ex;
text-align: left;

}
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
div.plain_layout {
text-align: left;

}
h4.subsubsection {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
div.lemma {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.lemma_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proof {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proof_label {
font-style: italic;
font-variant: normal;
font-size: medium;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.definition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.definition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
h4.subsubsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
div.exercise {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.exercise_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.toc {
  margin: 2em 0em;
  border-style: solid;
  border-width: 2px 0px;
  padding: 1em 0em;
}
h2.tochead { font-size: x-large; font-weight: bold; }
div.lyxtoc-0 {
  margin: 2em 0em 0em 0em;
  font-size: xx-large;
  font-weight: bold;
}
div.lyxtoc-1 {
  margin: 1em 0em 0em 0em;
  font-size: x-large;
  font-weight: bold;
}
div.lyxtoc-2 {
  margin: 0em 0.1em 0em 1em;
  font-size: large;
  font-weight: normal;
}
div.lyxtoc-3 { margin: 0em 0.1em 0em 0.5em; font-size: medium; }
div.lyxtoc-4 { margin: 0em 0.1em 0em 0.5em; }
div.lyxtoc-5 { margin: 0em 0.1em 0em 0.5em; }
div.lyxtoc-6 { margin: 0em 0.1em 0em 0.5em; }
a.tocentry {
  text-decoration: none;
  color: black;
}
a.tocentry:visited { color: black; }
a.lyxtoc-floats { 
  text-decoration: none; 
  color: black;
}
a.lyxtoc-floats:visited { color: black; }
div.lyxtoc-floats { 
  margin: 0em 0em 0.1em 1em;
  font-size: large;
  font-weight: normal;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}
div.float-listings {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}
div.listings-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	}
table {
	border-collapse: collapse;
	display: inline-block;
}
td {
	border: 1px solid black;
	padding: 0.5ex;
}
span.foot_label {
	vertical-align: super;
	font-size: smaller;
	font-weight: bold;
	text-decoration: underline;
}
div.foot {
	display: inline;
	font-size: small;
	font-weight: medium;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.foot_inner { display: none; }
div.foot:hover div.foot_inner {
	display: block;
	border: 1px double black;
	margin: 0em 1em;
	padding: 1em;
}


</style>
</head>
<body dir="auto">
<h1 class="title" id="magicparlabel-1">ML-MDS - Machine Learning</h1>
<div class="date" id="magicparlabel-2">Spring 2023</div>
<div class="author" id="magicparlabel-3">Jose Antonio Lorencio Abril</div>
<div class="standard" id="magicparlabel-4" style="text-align: center;"><img alt="image: 0_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Big_Data_Mng_LectureNotes_source_upc-logo.png" src="0_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Big_Data_Mng_LectureNotes_source_upc-logo.png" style="width:50%;"/>
</div>
<div class="standard" id="magicparlabel-5" style="text-align: right;">Professor: Marta Arias</div>
<div class="standard" id="magicparlabel-6" style="text-align: right;">Student e-mail: jose.antonio.lorencio@estudiantat..upc.edu</div>
<div class="standard" id="magicparlabel-7"><br/>
</div>
<div class="address" id="magicparlabel-8">This is a summary of the course <em>Machine Learning</em> taught at the Universitat Politècnica de Catalunya by Professor Marta Arias in the academic year 22/23. Most of the content of this document is adapted from the course notes by Arias, [<a href="#LyXCite-Arias2022"><span class="bib-label">2</span></a>], so I won't be citing it all the time. Other references will be provided when used.</div>
<div class="standard" id="magicparlabel-9"><br/>
</div>
<div class="toc"><h2 class="tochead section">Table of Contents</h2>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-15">1 Introduction</a>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-28">2 Linear regression</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-29">2.1 Introduction</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-41">2.2 Least squares method</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-78">Intuitive interpretation</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-128">2.3 Things that could go wrong when using linear regression</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-165">2.4 Basis Functions</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-285">2.5 Probabilistic approach</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-311">2.6 Bias-Variance decomposition</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-420">2.7 Ridge Regression from Gaussian prior</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-456">2.8 LASSO regression</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-473">2.9 The full-Bayesian perspective</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-510">3 Clustering</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-519">3.1 k-Means</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-570">3.2 k-Means++</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-592">3.3 Choosing the number of cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math></a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-878">3.4 Gaussian Mixtures</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-1132">4 Linear Classifiers</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1166">4.1 Decision boundary in probabilistic models</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1357">4.2 Generative classifiers</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1392">4.3 Naïve Bayes</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1549">4.4 Perceptron and Logistic Regression </a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-2111">5 Nearest Neighbor Prediction</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2139">5.1 Locality: similarities and distances</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2170">5.2 Choosing <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math></a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2172">5.3 How to combine outputs to make predictions</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2180">5.4 Decision boundaries for nearest neighbors classifier</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2204">5.5 Final considerations</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-2217">6 Trees and Random Forests</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2223">6.1 Trees</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2458">6.2 Random Forests</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-2508">7 Multi-Layer Perceptron (Neural Networks)</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2510">7.1 Multiclass classification</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2537">7.2 Multi-Layer Perceptron</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2601">7.3 Error functions</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2608">7.4 Training the MLP: Backprogragation</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2697">7.5 Some activation functions</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-3236">A Notes on probability theory, Bayes theorem and Bayesian learning</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3238">A.1 Probability theory basic</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3303">A.2 Bayes rule in the context of learning</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3309">A.3 Maximum likelihood estimation</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3317">A.4 Properties of estimators</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3350">A.5 Maximum a posteriori estimation</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3359">A.6 Bayesian Learning</a>
</div>
</div>
</div>
</div>
<div class="standard" id="magicparlabel-11"><br/>
</div>
<div class="toc toc-floats"><h2 class="tochead toc-figure algorithm">List of Figures</h2><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-35">Figure 1: Matlab's accidents dataset and best linear fit.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-84">Figure 2: SVD visual.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-135">Figure 3: The independent variable does not provide enough information.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-147">Figure 4: The variables are not linearly related.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-159">Figure 5: The outlier distort the fit.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-293">Figure 6: Likelihood example.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-303">Figure 7: Using likelihood to select the distribution.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-324">Figure 8: Visual representation of the Bias-Variance errors.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-886">Figure 9: Different Gaussian mixtures with the same components.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-1157">Figure 10: Different classifiers. Linear (left). Quadratic (middle). knn (right).</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-1555">Figure 11: A neuron.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-1576">Figure 12: A simple perceptron.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2186">Figure 13: Voronoi diagrams. Code in MATLAB script voronoi.mlx.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2197">Figure 14: kNN decision regions for different values of k.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2517">Figure 15: Multi-class classification with perceptrons.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2530">Figure 16: Multi-class classification with perceptrons and softmax.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2549">Figure 17: A Multi-Layer Perceptron.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2566">Figure 18: Different kinds of NN.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2570">Sub-Figure a: MLP.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2579">Sub-Figure b: FFNN not MLP.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-2589">Sub-Figure c: RNN.</a></div></div>
<div class="standard" id="magicparlabel-14"><br/>
</div>
<h2 class="section" id="magicparlabel-15"><span class="section_label">1</span> Introduction</h2>
<div class="standard" id="magicparlabel-16">I gave ChatGPT the index of these notes, and asked him for an introduction for them. Here is the result:</div>
<div class="standard" id="magicparlabel-17">Welcome to the comprehensive study notes for your course in Machine Learning. This document is designed to provide you with a thorough overview of the primary topics in machine learning, to supplement your coursework and study.</div>
<div class="standard" id="magicparlabel-18">Our journey will begin with an overview of Machine Learning and the foundational elements that build this exciting field. The aim is to provide you with a sound understanding of the core principles and techniques involved in the development and application of Machine Learning algorithms.</div>
<div class="standard" id="magicparlabel-19">We will kick-off with 'Linear Regression,' a cornerstone of machine learning, going in-depth into topics like least squares method, issues encountered in linear regression, basis functions, and probabilistic approaches. It will also focus on Bias-Variance decomposition, ridge regression, LASSO regression, and finally, a full-Bayesian perspective.</div>
<div class="standard" id="magicparlabel-20">Our exploration then continues with 'Clustering' where we cover important clustering techniques like k-Means, k-Means++, and ways to determine the optimal number of clusters. We delve deeper into the realm of Gaussian Mixtures and the Expectation-Maximization technique.</div>
<div class="standard" id="magicparlabel-21">In the 'Linear Classifiers' chapter, we inspect the decision boundary in probabilistic models, generative classifiers, Naive Bayes, and methodologies like Perceptron and Logistic Regression.</div>
<div class="standard" id="magicparlabel-22">Following this, we introduce 'Nearest Neighbor Prediction'—a different way of approaching classification problems. The section will equip you with tools to understand the concept of locality and choosing the best 'k', and how to combine outputs to make predictions.</div>
<div class="standard" id="magicparlabel-23">We also explore the use of 'Trees and Random Forests' in machine learning. It will demystify decision trees and random forests, dealing with imbalanced data in classification, and providing insights into the interpretability of random forests.</div>
<div class="standard" id="magicparlabel-24">Next, we journey into the world of 'Neural Networks' with the 'Multi-Layer Perceptron (MLP)', learning about the different error functions used for regression, binary classification, and multi-class classification. We also cover the critical process of training the MLP using Backpropagation and some common activation functions.</div>
<div class="standard" id="magicparlabel-25">Finally, the notes conclude with an appendix section, 'Notes on probability theory, Bayes theorem and Bayesian learning.' This section is critical for understanding the probability theory basics, Bayes rule in the context of learning, maximum likelihood estimation, properties of estimators, maximum a posteriori estimation, and finally, Bayesian learning.</div>
<div class="standard" id="magicparlabel-26">These notes aim to serve as a comprehensive reference guide for you as you explore machine learning, providing both a high-level understanding of the field and the mathematical and algorithmic details that underlie each concept. Happy learning!</div>
<div class="standard" id="magicparlabel-27"><br/>
</div>
<h2 class="section" id="magicparlabel-28"><span class="section_label">2</span> Linear regression</h2>
<h3 class="subsection" id="magicparlabel-29"><span class="subsection_label">2.1</span> Introduction</h3>
<div class="standard" id="magicparlabel-30">In Figure <a href="#fig_Matlab_s_accidents_dataset">1</a>, we can observe a dataset of the population of different states plotted against the number of fatal accidents in each of the states. Here, each blue circle corresponds to a row of our data, and the coordinates are the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>p</mi><mi>o</mi><mi>p</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>,</mo>#<mi>a</mi><mi>c</mi><mi>c</mi><mi>i</mi><mi>d</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> values in the row. The red line is the linear regression model of this data. This means it is the line that 'best' approximates the data, where best refers to minimizing some kind of error: the squared error between each point to its projection on the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math> axis of the line, in this case. This approach is called the <b>least squares method</b>.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-35" style="text-align: center;"><img alt="image: 1_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado2.png" src="1_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado2.png"/>
</div>
<div class="plain_layout" id="magicparlabel-36"><span class="float-caption-Standard float-caption float-caption-standard">Figure 1:  <a id="fig_Matlab_s_accidents_dataset"></a>
Matlab's accidents dataset and best linear fit.</span></div>
</div>
<h3 class="subsection" id="magicparlabel-41"><span class="subsection_label">2.2</span> Least squares method</h3>
<h4 class="subsubsection" id="magicparlabel-42"><span class="subsubsection_label">2.2.1</span> Least squares in 2D</h4>
<div class="standard" id="magicparlabel-43">In 2D, we have a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> and we want to find the line that best approximates <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math> as a function of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>. As we want a line, we need to specify its slope, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math>, and its intercept, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math>. So, our estimations are:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> The least squares linear regression method chooses <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> in such a way that the <b>error function</b><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>J</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow></math> is minimized. </div>
<div class="standard" id="magicparlabel-44">Note that this function only depends on the parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math>, since the data is assumed to be fixed (they are observations).</div>
<div class="standard" id="magicparlabel-45">To compute them, we just need to find the minimum of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>J</mi>
</mrow></math>, by taking partial derivatives and setting them to 0. Let's do this optimization. First, we can develop the square:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>J</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>+</mo>
<msubsup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>+</mo>
<msubsup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> Thus:</div>
<div class="standard" id="magicparlabel-46"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>J</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>2</mn><mi>n</mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>-</mo><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow></math>and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>J</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> We have now to solve the system given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd>
<mrow><mn>2</mn><mi>n</mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>-</mo><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
</mtable>
</mrow></math> which is equivalent to<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd>
<mrow><mi>n</mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
</mtable><mn>.</mn>
</mrow>
</mrow></math> We can isolate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math> from the first equation:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> and substitute it in the second one<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> which is equivalent to<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> or<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>=</mo><mn>0.</mn>
</mrow>
</mrow></math> At this point, we can divide everything by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math>, yielding:</div>
<div class="standard" id="magicparlabel-47"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>=</mo><mn>0.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-48">If we now assume that the observations are equiprobable, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
</mrow>
</mrow></math>, and we call <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> the random variable from which observations <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> are obtained and the same for the observations <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, obtained from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math>, then:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mspace width="10px"></mspace>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>=</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>,</mo><mspace width="10px"></mspace>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>X</mi><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mspace width="10px"></mspace>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>Y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math> This means that the previous equation can be rewritten as:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>X</mi><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>Y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn><mo> ⟺ </mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>C</mi><mi>o</mi><mi>v</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> So<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>Y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<h4 class="subsubsection" id="magicparlabel-49"><span class="subsubsection_label">2.2.2</span> Least squares regression: multivariate case</h4>
<div class="standard" id="magicparlabel-50">Now, we can assume that we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> independent variables <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mrow>
</mrow></math> which we want to use to predict the dependent variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math>. Again, we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> observations of each variable. Now, we want to construct an hyperplane in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>m</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
</mrow></math>, whose predictions would be obtained as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mn>1</mn>
</mrow>
</mrow>
</msub><mo>+</mo><mn>...</mn><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>m</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>0</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
</mrow>
</mrow></math> where we define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mn>0</mn>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>,</mo>
</mrow>
</mrow></math> for all <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>i</mi>
</mrow></math>. We can represent<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>;</mo><mspace width="10px"></mspace><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi>
</mrow>
</mrow>
</msub><mo>,</mo><mspace width="10px"></mspace><mi>Y</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo>,</mo><mspace width="10px"></mspace><mi> θ </mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo>,</mo>
</mrow>
</mrow></math> so that we can write<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>Y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>=</mo><mi>X</mi><mi> θ </mi><mn>.</mn>
</mrow>
</mrow></math> The error function is defined as in the simple case<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>J</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> but now we can rewrite this as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>J</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>-</mo>
<mover>
<mrow><mi>Y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>-</mo>
<mover>
<mrow><mi>Y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Again, to obtain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> we need to optimize this function using matrix calculus.</div>
<div class="lemma" id="magicparlabel-51"><div class="lemma_item"><span class="lemma_label">Lemma 2.1.</span>
If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>11</mn>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>m</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mn>1</mn>
</mrow>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>m</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo> ∈ </mo>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>M</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> × </mo><mi>m</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> , <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> θ </mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>11</mn>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>n</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mn>1</mn>
</mrow>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>n</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo> ∈ </mo>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>M</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>m</mi><mo> × </mo><mi>m</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is a symmetric matrix, it holds:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>A</mi><mi> θ </mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo>=</mo><mi>A</mi><mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo>=</mo><mi>A</mi><mo>,</mo>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>B</mi><mi> θ </mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo>=</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>B</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="proof" id="magicparlabel-52"><div class="proof_item"><span class="proof_label">Proof.</span>
First, notice that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mi> θ </mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math>so it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>A</mi><mi> θ </mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>11</mn>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>m</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mn>1</mn>
</mrow>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>m</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo>=</mo><mi>A</mi><mn>.</mn>
</mrow>
</mrow></math> For the second result, the procedure is the same.</div>
<div class="proof_item">Lastly, notice that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>B</mi><mi> θ </mi><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> ∈ </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
</mrow></math>, so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>B</mi><mi> θ </mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<mrow><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<mrow><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mo>=</mo><mn>2</mn>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>B</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>=</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>B</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="standard" id="magicparlabel-54">Now, we can proceed and minimize <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>J</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>J</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Y</mi><mo>-</mo>
<msup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi><mo>-</mo>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Y</mi><mo>+</mo>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mn>0</mn><mo>-</mo>
<msup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>-</mo>
<msup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> setting this to be 0, we get<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>=</mo>
<msup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo> ⟺ </mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi><mo>=</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Y</mi><mo> ⟺ </mo><mi> θ </mi><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Y</mi><mn>.</mn>
</mrow>
</mrow></math> Thus, the 'best' linear model is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>l</mi><mi>s</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Y</mi><mn>.</mn>
</mrow>
</mrow></math> Once we have this model, if we have an observation of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo>'</mo><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo><mi>x</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and we want to make a prediction, we compute<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>x</mi><mo>'</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>l</mi><mi>s</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> The approach that we have followed here is the <b>optimization</b> view of learning, which basically consists of the steps:</div>
<ol class="enumerate" id="magicparlabel-55"><li class="enumerate_item">Set up an error function as a function of some parameters.</li>
<li class="enumerate_item">Optimize this function to find the suitable values for this parameters, assuming the data as given.</li>
<li class="enumerate_item">Use incoming values to make predictions.</li>
</ol>
<h4 class="subsubsection" id="magicparlabel-58"><span class="subsubsection_label">2.2.3</span> Computation of least squares solution via the singular values decomposition (SVD)</h4>
<div class="standard" id="magicparlabel-59">Inverting <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
</mrow></math> can entail numerical problems, so the SVD can be used instead.</div>
<div class="theorem" id="magicparlabel-65"><div class="theorem_item"><span class="theorem_label">Theorem 2.1.</span>
Any matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>m</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mo>&gt;</mo><mi>n</mi>
</mrow>
</mrow></math>, can be expressed as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>=</mo><mi>U</mi><mo> Σ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>U</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>m</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math> has orthonormal columns <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>U</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>U</mi><mo>=</mo><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Σ </mo><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math> is diagonal and contains the singular values in its diagonal and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>V</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math> is orthonormal <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>.</div>
</div>
<div class="proof" id="magicparlabel-71"><div class="proof_item"><span class="proof_label">Proof.</span>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>C</mi><mo>=</mo>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>A</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> is square, symmetric and positive semidefinite. Therefore, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> is diagonalizable, so it can be written as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>C</mi><mo>=</mo><mi>V</mi><mo> Λ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>V</mi><mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math> is orthogonal and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Λ </mo><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ≥ </mo><mn>...</mn><mo> ≥ </mo>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub><mo>&gt;</mo><mn>0</mn><mo>=</mo>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow>
<mrow><mi>r</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>=</mo><mn>...</mn><mo>=</mo>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math> is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≤ </mo><mi>n</mi>
</mrow>
</mrow></math>. </div>
<div class="proof_item">Now, define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msqrt>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</msqrt>
</mrow>
</mrow></math>, and form the matrix<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Σ </mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">[</mo>
<mtable>
<mtr>
<mtd>
<mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<msub>
<mrow><mn>0</mn>
</mrow>
<mrow>
<mrow><mi>r</mi><mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mn>0</mn>
</mrow>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>m</mi><mo>-</mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> × </mo><mi>r</mi>
</mrow>
</mrow>
</msub>
</mtd>
<mtd>
<msub>
<mrow><mn>0</mn>
</mrow>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>m</mi><mo>-</mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">]</mo><mn>.</mn>
</mrow>
</mrow></math> Define also<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mfrac><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msup><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>r</mi><mn>.</mn>
</mrow>
</mrow></math> Then, this vectors are orthonormal:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mfrac><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mfrac><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup><mi>C</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mover accent="false"><mo>=</mo><mo>*</mo></mover>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover accent="false"><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mover>
<mfrac>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mfrac>
<msubsup>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mover accent="false"><mo>=</mo>
<mrow><mo>*</mo><mo>*</mo>
</mrow></mover><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo>*</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> is because <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>V</mi>
</mrow></math> is formed with the eigenvectors of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>*</mo><mo>*</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> is because <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>V</mi>
</mrow></math> is orthonormal.</div>
<div class="proof_item">Now, we can complete the base with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow>
<mrow><mi>r</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math> (using Gram-Schmidt) in such a way that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>U</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow>
<mrow><mi>r</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math> is column orthonormal.</div>
<div class="proof_item">Now, if it is the case that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mi>V</mi><mo>=</mo><mi>U</mi><mo> Σ </mo>
</mrow>
</mrow></math>, then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo><mi>X</mi><mi>V</mi>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>=</mo><mi>U</mi><mo> Σ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> so it is only left to see that indeed this holds. Consider two cases:</div>
<ul class="itemize" id="magicparlabel-75"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1</mn><mo> ≤ </mo><mi>i</mi><mo> ≤ </mo><mi>r</mi><mo>:</mo>
</mrow>
</mrow></math> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> Σ </mo>
</mrow>
</mrow></math> by the definition of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>r</mi><mo>+</mo><mn>1</mn><mo> ≤ </mo><mi>i</mi><mo> ≤ </mo><mi>n</mi><mo>:</mo>
</mrow>
</mrow></math> It is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> because <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mi>C</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mover accent="false"><mo>=</mo>
<mrow><mi>i</mi><mo>&gt;</mo><mi>r</mi>
</mrow></mover><mn>0</mn>
</mrow>
</mrow></math>. As <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>,</mo>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ≠ </mo><mn>0</mn>
</mrow>
</mrow></math>, it must be <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>. On the other side of the equation we also have 0 because <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> Σ </mo><mo>=</mo>
<msub>
<mrow><mi>u</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> as <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>i</mi><mo>&gt;</mo><mi>r</mi>
</mrow>
</mrow></math>.</li>
</ul>
</div>
<div class="standard" id="magicparlabel-77">This, added to the fact that if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> has full rank, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
</mrow></math> is invertible and all its eigenvalues non null, gives us: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>l</mi><mi>s</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>U</mi><mo> Σ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>U</mi><mo> Σ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>U</mi><mo> Σ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>V</mi><mo> Σ </mo>
<msup>
<mrow><mi>U</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>U</mi><mo> Σ </mo>
<msup>
<mrow><mi>V</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>V</mi><mo> Σ </mo>
<msup>
<mrow><mi>U</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>2</mn>
</mrow>
</mrow>
</msup><mi>V</mi><mo> Σ </mo>
<msup>
<mrow><mi>U</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>=</mo><mi>V</mi>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>U</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>V</mi><mo> ⋅ </mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mfrac><mo>,</mo><mn>...</mn><mo>,</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo>
<msup>
<mrow><mi>U</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math></div>
<h3 class="subsection_" id="magicparlabel-78">Intuitive interpretation</h3>
<div class="standard" id="magicparlabel-79">The intuition behind the SVD is summarized in Figure <a href="#fig_SVD_visual_">2</a>. Basically, every linear transformation can be decomposed into a rotation, a scaling and a simpler transformation (column orthogonal).</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-84" style="text-align: center;"><img alt="image: 2_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_SVD.png" src="2_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_SVD.png" style="width:30%;"/>
</div>
<div class="plain_layout" id="magicparlabel-85"><span class="float-caption-Standard float-caption float-caption-standard">Figure 2:  SVD visual.<a id="fig_SVD_visual_"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-90">The intuition behind SVD lies in the idea of finding a low-rank approximation of a given matrix. The rank of a matrix is the number of linearly independent rows or columns it contains. A high-rank matrix has many linearly independent rows or columns, which makes it complex and difficult to analyze. On the other hand, a low-rank matrix has fewer linearly independent rows or columns, which makes it simpler and easier to analyze.</div>
<div class="standard" id="magicparlabel-91">SVD provides a way to find the best possible low-rank approximation of a given matrix by decomposing it into three components. The left singular vectors represent the <b>direction of maximum variance</b> in the data, while the right singular vectors represent the <b>direction of maximum correlation</b> between the variables. The singular values represent the <b>magnitude of the variance or correlation</b> in each direction.</div>
<div class="standard" id="magicparlabel-92">By truncating the diagonal matrix of singular values to keep only the top-k values, we can obtain a low-rank approximation of the original matrix that retains most of the important information. This is useful for reducing the dimensionality of data, compressing images, and solving linear equations, among other applications.</div>
<div class="example" id="magicparlabel-93"><div class="example_item"><span class="example_label">Example 2.1.</span>
How to use SVD in Python and Matlab.</div>
<div class="example_item">
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">import numpy as np

U, d, Vt = np.linalg.svd(X, full_matrices=False)
D = np.diag(1/d)
theta = Vt.T @ D @ U.T @ y</pre></div>
<div class="plain_layout" id="magicparlabel-107"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 1:  SVD in Python.</span></div>
</div>
</div>
<div class="example_item">
<div class="float-algorithm"><div class="float-listings"><pre class="listings Matlab">[U, d, V] = svd(X)
D = diag(diag(1./d))
theta = V'*D*U'*y</pre></div>
<div class="plain_layout" id="magicparlabel-123"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 2:  SVD in Matlab.</span></div>
</div>
</div>
</div>
<h3 class="subsection" id="magicparlabel-128"><span class="subsection_label">2.3</span> Things that could go wrong when using linear regression</h3>
<h4 class="subsubsection" id="magicparlabel-129"><span class="subsubsection_label">2.3.1</span> Our independent variable is not enough</h4>
<div class="standard" id="magicparlabel-130">It is possible that our variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> does not provide enough information to predict <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math>.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-135" style="text-align: center;"><img alt="image: 3_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado7.png" src="3_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado7.png"/>
</div>
<div class="plain_layout" id="magicparlabel-136"><span class="float-caption-Standard float-caption float-caption-standard">Figure 3:  The independent variable does not provide enough information.</span></div>
</div>
<h4 class="subsubsection" id="magicparlabel-141"><span class="subsubsection_label">2.3.2</span> The relationship between the variables is not linear (underfitting)<a id="subsec_The_relationship_between"></a>
</h4>
<div class="standard" id="magicparlabel-142">It is also possible that the variables are related in non-linear ways.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-147" style="text-align: center;"><img alt="image: 4_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado6.png" src="4_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado6.png"/>
</div>
<div class="plain_layout" id="magicparlabel-148"><span class="float-caption-Standard float-caption float-caption-standard">Figure 4:  The variables are not linearly related.</span></div>
</div>
<h4 class="subsubsection" id="magicparlabel-153"><span class="subsubsection_label">2.3.3</span> Outliers affect the fit</h4>
<div class="standard" id="magicparlabel-154">In the presence of outliers, the model obtained can be distorted, leading to bad results.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-159" style="text-align: center;"><img alt="image: 5_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado8.png" src="5_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado8.png"/>
</div>
<div class="plain_layout" id="magicparlabel-160"><span class="float-caption-Standard float-caption float-caption-standard">Figure 5:  The outlier distort the fit.</span></div>
</div>
<h3 class="subsection" id="magicparlabel-165"><span class="subsection_label">2.4</span> Basis Functions</h3>
<div class="standard" id="magicparlabel-166">In order to fix the second problem (Subsection <a href="#subsec_The_relationship_between">2.3.2</a>), we can make use of basis functions. The idea is to apply different transformations to the data, so that we can extend the expressive power of our model. </div>
<div class="definition" id="magicparlabel-172"><div class="definition_item"><span class="definition_label">Definition 2.1.</span>
A <b>feature mapping</b> is a non-linear transformation of the inputs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> φ </mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
</mrow>
</mrow></math>.</div>
<div class="definition_item">The resulting <b>predictive function</b> or model is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo><mi> φ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> θ </mi>
</mrow>
</mrow></math>.</div>
</div>
<div class="example" id="magicparlabel-179"><div class="example_item"><span class="example_label">Example 2.2.</span>
For example, we can consider the <b>polynomial expansion of degree <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math></b>, which is a commonly used feature mapping that approximates the relationship between the independent variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> and the dependent variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math> to be polynomial of degree <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>, i.e.:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mi>x</mi><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mn>...</mn><mo>+</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> The feature mapping is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> φ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd><mi>x</mi>
</mtd>
<mtd>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
</div>
<div class="standard" id="magicparlabel-180">Note that the idea is to transform the data so that the fit is still linear, even if the relationship is not. Of course, this requires to apply the same transformation whenever we receive an input for which we want to make predictions. Also, the resulting model is more complex, so <b>complexity control</b> is necessary to avoid overfitting.</div>
<div class="standard" id="magicparlabel-181">When we apply <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> φ </mi>
</mrow></math> to the input matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, we get a new input matrix, given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Φ </mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mrow><mi> φ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi> φ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi> φ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mi>…
      </mi>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mi>…
      </mi>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mi>…
      </mi>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> φ </mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>,</mo>
</mrow>
</mrow></math> and we obtain the optimal solution as before:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mo> Φ </mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mo> Φ </mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mo> Φ </mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo> Φ </mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo> Φ </mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example" id="magicparlabel-182"><div class="example_item"><span class="example_label">Example 2.3.</span>
A MATLAB example</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-225" style="text-align: center;"><img alt="image: 6_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Ma____source_scripts_example_2_3_images_figure_0.png" src="6_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Ma____source_scripts_example_2_3_images_figure_0.png" style="width:50%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-268" style="text-align: center;"><img alt="image: 7_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Ma____source_scripts_example_2_3_images_figure_1.png" src="7_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Ma____source_scripts_example_2_3_images_figure_1.png" style="width:50%;"/>
</div>
<div class="example_item"></div>
</div>
<h3 class="subsection" id="magicparlabel-285"><span class="subsection_label">2.5</span> Probabilistic approach</h3>
<div class="standard" id="magicparlabel-286">A review on probability theory, Bayes theorem and Bayesian Learning is in Appendix <a href="#sec_Notes_on_probability">A</a>.</div>
<h4 class="subsubsection" id="magicparlabel-287"><span class="subsubsection_label">2.5.1</span> Least squares regression from a probabilistic perspective</h4>
<div class="standard" id="magicparlabel-288">We are noe going to derive the linear regression estimates using the principle of maximum likelihood and the univariate Gaussian distribution, whose probability density function is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> Given a sample <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, we define its likelihood as the function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo><mi> σ </mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi> μ </mi><mo>,</mo><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>;</mo><mi> μ </mi><mo>,</mo><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> In Figure <a href="#fig_Likelihood_example_">6</a>, we can see how the likelihood relates to '<em>how likely it is that our points have been created froma certain distribution</em>', because the red outcomes are more likely to appear from the blue distribution than the green ones.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-293" style="text-align: center;"><img alt="image: 8_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado9.png" src="8_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado9.png" style="width:60%;"/>
<span class="float-caption-Standard float-caption float-caption-standard">Figure 6:  <a id="fig_Likelihood_example_"></a>
Likelihood example.</span></div>
</div>
<div class="standard" id="magicparlabel-298">Now, this can be used to select the distribution that best matches our data. As an easy approach, suppose we want to decide between two distributions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math>, and we have a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>. To decide, we can compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and select the distribution whose likelihood is greater. This is visually exemplified in Figure <a href="#fig_Using_likelihood_to">7</a>, where we can see that given the three red outcomes and the two distributions (blue and green), the blue one should be preferred, because it mazimizes the likelihood.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-303" style="text-align: center;"><img alt="image: 9_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado10.png" src="9_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado10.png" style="width:60%;"/>
</div>
<div class="plain_layout" id="magicparlabel-304"><span class="float-caption-Standard float-caption float-caption-standard">Figure 7:  Using likelihood to select the distribution.<a id="fig_Using_likelihood_to"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-309">This way, we can think of the likelihood of a function of the unknown parameters of the distribution, with the dataset fixed, and we can maximize this function to obtain the parameters that best describe our data.</div>
<div class="standard" id="magicparlabel-310">In the probabilistic setting of linear regression, we assume that each label <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> we observe is normally distributed, with mean <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> μ </mi><mo>=</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi>
</mrow>
</mrow></math> and variance <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi><mo>+</mo>
<msub>
<mrow><mi> ϵ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> ϵ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. This way, we seek to obtain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math> that best describe our data. Remember that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>,</mo><mspace width="10px"></mspace><mi>X</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>11</mn>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mi>d</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mn>1</mn>
</mrow>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>d</mi>
</mrow>
</mrow>
</msub>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>,</mo>
</mrow>
</mrow></math> so that the likelihood of the parameter vector <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>,</mo><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>X</mi><mo>;</mo><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>;</mo><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> It is usual to maximize the log-likelihood instead, basically because the likelihood tends to give values too close to zero (we may be multiplying thousands of small values), so numerical problems may arise. Thus:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>;</mo><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo> log </mo><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>;</mo><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> log </mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</msqrt>
</mrow>
</mfrac><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> At this point, we differentiate and set equal to 0:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>+</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> obtaining<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo><mi>M</mi><mi>S</mi><mi>E</mi><mn>.</mn>
</mrow>
</mrow></math> It is noticeable that the maximum likelihood estimates concide with the estimates we found minimizing the squared error. This is a consequence of assuming gaussian noise, and other types of distribution would give us the same estimates as minimizing a different error function.</div>
<h3 class="subsection" id="magicparlabel-311"><span class="subsection_label">2.6</span> Bias-Variance decomposition</h3>
<div class="standard" id="magicparlabel-312">Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo> → </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
</mrow></math> be the true function that we are trying to approximate and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> a finite training dataset, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo>
<msub>
<mrow><mi> ϵ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> ϵ </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> be a test data point. The setup is using <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math> to train a model <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mover>
<mrow><mi>f</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow></math> that we want to use to make predictions<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub><mo>=</mo>
<mover>
<mrow><mi>f</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> We are going to see how the expected squared error <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math> is the real value, can be decomosed as a sum of the following components:</div>
<ul class="itemize" id="magicparlabel-313"><li class="itemize_item"><b>Irreducible error</b>: given by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math>.</li>
<li class="itemize_item"><b>Bias</b>: the systematic limitation that the modelling assumptions impose. For example, if we choose linear approximations, we will never be able to model non-linear data well enough.</li>
<li class="itemize_item"><b>Variance</b>: refers to the sensitivity of the model to the training set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>. The more the model varies when the training set is changed, the higher variance it has.</li>
</ul>
<div class="standard" id="magicparlabel-316">Let's do this:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi> ϵ </mi><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi> ϵ </mi><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub><mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>+</mo><mo>+</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow><mo>+</mo><mn>2</mn><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mn>2</mn><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow><mo>+</mo><mn>2</mn><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow><mo>+</mo><mn>2</mn><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mn>2</mn><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow><mo>+</mo><mn>2</mn><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> And we now define<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>D</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math> The Bias reflects the expected difference between our assumed model and the real function, while the variance reflects the difference between the assumed model and the obtained model. In Figure <a href="#fig_Visual_representation_of">8</a>, we can see:</div>
<ul class="itemize" id="magicparlabel-317"><li class="itemize_item">The linear model has high bias and low variance.</li>
<li class="itemize_item">The polynomial of degree 3 has low bias and moderate variance.</li>
<li class="itemize_item">The polynomial of degree 8 has low bias but high variance.</li>
</ul>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-324" style="text-align: center;"><img alt="image: 10_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado14.png" src="10_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado14.png" style="width:60%;"/>
</div>
<div class="plain_layout" id="magicparlabel-325"><span class="float-caption-Standard float-caption float-caption-standard">Figure 8:  Visual representation of the Bias-Variance errors.<a id="fig_Visual_representation_of"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-330">A summary of commonly used errors used for regression is shown in Table <a href="#tab_Common_error_functions_">1</a>.</div>
<div class="float-table"><div class="plain_layout" id="magicparlabel-335" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-363">Name</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-366">Abbreviation</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-369">Formula</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-372">mean squared error</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-375">MSE</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-378"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-381">root mean squared error</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-384">RMSE</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-387"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msqrt>
<mrow><mi>M</mi><mi>S</mi><mi>E</mi>
</mrow>
</msqrt>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-390">normalized root mean squared error</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-393">NRMSE</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-396"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msqrt>
<mfrac>
<mrow>
<mrow><mi>M</mi><mi>S</mi><mi>E</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</msqrt>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-399">coefficient of determination</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-402"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>R</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-405">1-NRMSE<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup><mrow></mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-408">mean absolute error</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-411">MAE</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-414"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="plain_layout" id="magicparlabel-415"><span class="float-caption-Standard float-caption float-caption-standard">Table 1:  Common error functions.<a id="tab_Common_error_functions_"></a>
</span></div>
</div>
<h3 class="subsection" id="magicparlabel-420"><span class="subsection_label">2.7</span> Ridge Regression from Gaussian prior</h3>
<div class="standard" id="magicparlabel-421">We are going to consider MAP estimates in this section, which are explained in the Annex <a href="#sec_Notes_on_probability">A</a>. </div>
<div class="standard" id="magicparlabel-422">Assume isotropic Gaussian prior on <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math>-dimensional <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> θ </mi><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>=</mo><mn>0</mn><mo>,</mo><mo> Σ </mo><mo>=</mo>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mi>I</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> det </mo><mo> Σ </mo><mo>=</mo>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow>
<mrow><mn>2</mn><mi>d</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math>. Then, on one hand, we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>;</mo><mi> μ </mi><mo>=</mo><mn>0</mn><mo>,</mo><mo> Σ </mo><mo>=</mo>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mo> det </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo> Σ </mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> On the other hand, it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>y</mi><mo>,</mo><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>X</mi><mo>,</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ∝ </mo>
</mtd>
<mtd>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> To obtain the MAP, we maximize the log of this expression:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>A</mi><mi>P</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>X</mi><mo>,</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo>
<mfrac>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi> λ </mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> which is the <b>ridge regression </b>estimate with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo>=</mo>
<mfrac>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msup>
<mrow><mi> τ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mrow>
</mrow></math>. We can now differenciate this expression to find its minimum:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi> λ </mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo>-</mo>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>-</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>+</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi><mo>+</mo><mn>2</mn><mi> λ </mi><mi> θ </mi><mo>=</mo><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>+</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi><mo>+</mo><mn>2</mn><mi> λ </mi><mi> θ </mi><mo>=</mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ⟺ </mo>
</mtd>
<mtd>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mn>2</mn><mi> λ </mi><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> θ </mi><mo>=</mo><mn>2</mn>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ⟺ </mo>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>A</mi><mi>P</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>r</mi><mi>i</mi><mi>d</mi><mi>g</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi> λ </mi><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> </div>
<div class="remark" id="magicparlabel-423"><div class="remark_item"><span class="remark_label">Remark 2.1.</span>
There are a few remarks here:</div>
<ul class="itemize" id="magicparlabel-424"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math> controls the complexity of the solution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, the bigger <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math> is, the smaller <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> tends to be, leading to simpler solutions.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi> λ </mi><mi>I</mi>
</mrow>
</mrow></math> is guaranteed to be non-singular and behaves better numerically than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
</mrow></math>, specially if there is high correlation in the columns of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, or if there are few observations relative to the amount of variables.</li>
<li class="itemize_item">A general approach when we have a regularized objective function is to use models that are potentially more complex than needed, and then adjust <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math> until obtaining good result and simpler models.</li>
</ul>
</div>
<h4 class="subsubsection" id="magicparlabel-427"><span class="subsubsection_label">2.7.1</span> Tuning <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math></h4>
<h4 class="subsubsection_" id="magicparlabel-428">Cross-validation</h4>
<div class="standard" id="magicparlabel-429">Given a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>, the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-cross-validation approach starts by separating <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math> into two subsets:</div>
<ul class="itemize" id="magicparlabel-430"><li class="itemize_item">The <b>training dataset</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi>
</mrow>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item">The <b>test dataset</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi>
</mrow>
</mrow>
</msub>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-432">These are obtained in such a way that:</div>
<ol class="enumerate" id="magicparlabel-433"><li class="enumerate_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi>
</mrow>
</mrow>
</msub><mo> ∩ </mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mi> ∅ </mi>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi>
</mrow>
</mrow>
</msub><mo> ∪ </mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mi>D</mi>
</mrow>
</mrow></math>.</li>
</ol>
<div class="standard" id="magicparlabel-435">Now, we divide <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi>
</mrow>
</mrow>
</msub>
</mrow></math> into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> subsets of equal size, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>,</mo><mi>i</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
</mrow></math>, called <b>folds</b>, and imagine we want to decide on a set of values for our model's parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo> ∈ </mo><mo> Λ </mo><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi> λ </mi>
</mrow>
<mrow><mi>l</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>.</div>
<ol class="enumerate" id="magicparlabel-436"><li class="enumerate_item">For each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo> ∈ </mo><mo> Λ </mo>
</mrow>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-437"><li class="enumerate_item">For each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
</mrow>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-438"><li class="enumerate_item">Train the model in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi>
</mrow>
</mrow>
</msub><mo> ∖ </mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>,</mo><mi>i</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Evaluate the model in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>,</mo><mi>i</mi>
</mrow>
</mrow>
</msub>
</mrow></math>.</li>
</ol>
</li><li class="enumerate_item">Average the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> evaluations to obtain an estimation of the performance of the model.</li>
</ol>
</li><li class="enumerate_item">Select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math> that gives us the best estimation.</li>
</ol>
<h4 class="subsubsection_" id="magicparlabel-442">Leave-one-out cross-validation (LOOCV)</h4>
<div class="standard" id="magicparlabel-443">Is a special case of cross-validation, in which <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mi>n</mi>
</mrow>
</mrow></math>, i.e., each data point is a fold.</div>
<h4 class="subsubsection" id="magicparlabel-444"><span class="subsubsection_label">2.7.2</span> LOOCV for Ridge regression</h4>
<div class="standard" id="magicparlabel-445">As a particularity of linear and ridge regression, for a given value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math>, only one training is necessary for LOOCV, so we can proceed as follows:</div>
<ol class="enumerate" id="magicparlabel-446"><li class="enumerate_item">For each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo> ∈ </mo><mo> Λ </mo>
</mrow>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-447"><li class="enumerate_item">Compute the optimal solution<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi> λ </mi><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Compute the <em>hat matrix </em>or smoothing matrix<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>H</mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mi>X</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi> λ </mi><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Compute LOOCV directly for each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math>, without folding<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mi>O</mi><mi>O</mi><mi>C</mi><mi>V</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> λ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>i</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
</ol>
</li><li class="enumerate_item">Return <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> λ </mi>
</mrow></math> with minimum LOOCV.</li>
</ol>
<h4 class="subsubsection" id="magicparlabel-451"><span class="subsubsection_label">2.7.3</span> Generalized Cross-Validation (GCV)</h4>
<div class="standard" id="magicparlabel-452">Generalized Cross-Validation (GCV) is a model selection technique used to estimate the performance of a model in terms of prediction accuracy. GCV is particularly useful for choosing the optimal parameters in regularization or smoothing methods, where the goal is to balance model complexity and goodness of fit. Examples of such methods include ridge regression, LASSO, and smoothing splines.</div>
<div class="standard" id="magicparlabel-453">The main idea of GCV is to approximate the leave-one-out cross-validation (LOOCV) error without actually performing the computationally expensive process of fitting the model to all but one data point multiple times. Also, it is more computationally stable than the previous approach.</div>
<div class="standard" id="magicparlabel-454">The GCV score is defined as follows:</div>
<div class="standard" id="magicparlabel-455"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mi>C</mi><mi>V</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> λ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>H</mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>M</mi><mi>S</mi>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>H</mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>H</mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the trace of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>H</mi>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</msub>
</mrow></math>.</div>
<h3 class="subsection" id="magicparlabel-456"><span class="subsection_label">2.8</span> LASSO regression</h3>
<div class="definition" id="magicparlabel-462"><div class="definition_item"><span class="definition_label">Definition 2.2.</span>
The <b><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold">
<mrow><mi>L</mi><mi>p</mi><mo>-</mo>
</mrow></mstyle>
</mrow></math>norm</b> of a vector <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>p</mi>
</mrow>
</mfrac>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="remark" id="magicparlabel-468"><div class="remark_item"><span class="remark_label">Remark 2.2.</span>
As we have seen, assuming an isotropic Gaussian prior on the parameters leads to ridge regression, which minimizes the L2-norm of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> and the squared error.</div>
</div>
<div class="standard" id="magicparlabel-469">Another very common choice is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, which leads to <b>LASSO regression</b>. Thus, LASSO regression minimizes the L1-norm of parameters and squared error:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>L</mi><mi>A</mi><mi>S</mi><mi>S</mi><mi>O</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>+</mo><mi> λ </mi>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math> In fact, LASSO regression arises assuming a Lapace distribution prior over the parameters.</div>
<div class="standard" id="magicparlabel-470">Some characteristics:</div>
<ul class="itemize" id="magicparlabel-471"><li class="itemize_item">LASSO regularized cost function is not quadratic anymore, and it has no close solution, so an approximation procedure is used: the <b>least angle regression</b>, which provides an efficient way to compute the solutions for a list of possible values for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math>, giving the <b>regularization path</b>.</li>
<li class="itemize_item">LASSO regression gives sparse solutions, in which many coefficients/coordinates of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> might be 0. This means that LASSO performs feature selection automatically.</li>
</ul>
<h3 class="subsection" id="magicparlabel-473"><span class="subsection_label">2.9</span> The full-Bayesian perspective</h3>
<div class="standard" id="magicparlabel-474">Both maximum likelihood (ML) and maximum a priori (MAP) produce point estimates of the parameters, while in Bayesian Learning<div class="foot"><span class="foot_label">1</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-478">Refer to Appendix <a href="#sec_Notes_on_probability">A</a> for more details.</div>
</div></div> we want the full posterior distribution of the parameters. The idea is that if we know the posterior distribution of the parameters, then we can use all the information provided by this distribution for our predictions, instead of just a single point-estimate that summarizes it. For instance, if the probability function of the posterior is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and we receive a new input point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>, then we can compute the probability of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>y</mi>
</mrow>
</mrow></math> by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi> θ </mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mn>.</mn>
</mrow>
</mrow></math>Now, when we do this for all possible values of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math>, we obtain the full distribution of the predictions, instead of just one estimation. Nonetheless, computing this integral is usually too hard, so it needs to be approximated, but in the context of linear regression all these expressions have close-form formulas<div class="foot"><span class="foot_label">2</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-482">For computational speed we may use approximations as well.</div>
</div></div>.</div>
<div class="standard" id="magicparlabel-483">Technically, ML and MAP assume that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>Y</mi><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> so a prediction for a new test point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mover>
<mrow><mi>x</mi>
</mrow><mo stretchy="true">¯</mo>
</mover>
</mrow></math> is going to have a distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi>x</mi>
</mrow><mo stretchy="true">¯</mo>
</mover>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Note now the lack of flexibility of this approach, since the width of the normal distribution is going to be the same for any new test point, which may be a dangerous assumption.</div>
<div class="standard" id="magicparlabel-484">Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
</mrow>
</mrow></math> be our dataset, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
</mrow></math>, and assume:</div>
<ul class="itemize" id="magicparlabel-485"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math> are independent given <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup><mi> θ </mi><mo>,</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>a</mi>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math> being the prevision of the noise in the observations <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>.</li>
<li class="itemize_item">A spherical or isotropic Gaussian for the parameter's prior, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo>
<msup>
<mrow><mi>b</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>a</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>b</mi>
</mrow></math> are known.</li>
<li class="itemize_item">The only parameter variables are the coefficients <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> θ </mi><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-490">Then, the likelihood function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mrow></math> As usual, using Bayes, we can derive the posterior distribution<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ∝ </mo>
</mtd>
<mtd>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ∝ </mo>
</mtd>
<mtd>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Notice here that the exponent of this expression is quadratic on <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, so it is going to be a multivariate Gaussian<div class="foot"><span class="foot_label">3</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-494">The idea is that the product of two Gaussians is also Gaussian. Think of it as if you are measuring height and IQ: these variables can be assumed independent, and have a normal distribution. You can multiply them and obtain a combined normal distribution in 2-D. The idea here is basically the same.</div>
</div></div>. We need to turn the exponent into something resembling<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> so that we can derive what the mean <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> and the precision <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Q</mi>
</mrow></math> of the posterior density is. For this, we are going to complete squares so that we can 'match the terms' between <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>b</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
</mrow></math>. On one hand:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>-</mo><mi> θ </mi><mi>Q</mi><mi> μ </mi><mo>-</mo>
<msup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>+</mo>
<msup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi><mo>+</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> We don't mind about constant terms with respect to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, since we only care about proportionality. On the other hand, we have:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>a</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>X</mi><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>b</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>-</mo><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi><mo>-</mo><mi>a</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>+</mo><mi>a</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi> θ </mi><mo>+</mo><mi>b</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>-</mo><mn>2</mn><mi>a</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>+</mo>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi>b</mi><mi>I</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> θ </mi><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> From here, we obtain that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>Q</mi><mo>=</mo><mi>a</mi>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi>b</mi><mi>I</mi><mo>,</mo>
</mrow>
</mrow></math> and we now match <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>-</mo><mn>2</mn><mi>a</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi>
</mrow>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
</mrow></math><div class="foot"><span class="foot_label">4</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-498"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Q</mi>
</mrow></math> is invertible because it is positive definite, thanks to the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>+</mo><mi>b</mi><mi>I</mi>
</mrow>
</mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>b</mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math>.</div>
</div></div>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mo>=</mo><mi>Q</mi><mi> μ </mi><mo> ⟺ </mo><mi> μ </mi><mo>=</mo><mi>a</mi>
<msup>
<mrow><mi>Q</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mn>.</mn>
</mrow>
</mrow></math> Thus, the posterior probability is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi>Q</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> with<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>Q</mi><mo>=</mo><mi>a</mi>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi>b</mi><mi>I</mi><mo>,</mo><mspace width="10px"></mspace><mi> μ </mi><mo>=</mo><mi>a</mi>
<msup>
<mrow><mi>Q</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>y</mi><mn>.</mn>
</mrow>
</mrow></math> The MAP estimate can be directly obtained from here, since the maximum density is obtained at the mean in any Gaussian distribution. Additionally, in ridge regression we let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo>=</mo>
<mfrac>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>a</mi>
</mrow>
</mfrac>
</mrow>
</mrow></math> and turn it into a parameter that we can tune to control complexity against training error.</div>
<h4 class="subsubsection" id="magicparlabel-499"><span class="subsubsection_label">2.9.1</span> Using the posterior distribution for predictions</h4>
<div class="standard" id="magicparlabel-500">Let's now see how to compute the <b>predictive distribution</b>, i.e., <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi> θ </mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mn>.</mn>
</mrow>
</mrow></math> For this, we substitute the densities<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi><mo>,</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>a</mi>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo>
<msup>
<mrow><mi>Q</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mover accent="false"><mo> ∝ </mo>
<mrow><mi>w</mi><mn>.</mn><mi>r</mi><mn>.</mn><mi>t</mi><mn>.</mn><mspace width="10px"></mspace><mi>y</mi>
</mrow></mover>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>y</mi><mo>+</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi><mo>+</mo>
<menclose notation="updiagonalstrike">
<mrow>
<msup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
</menclose>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ∝ </mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>y</mi><mo>+</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Now, our objective is to set this integral to equate (or be proportional to) another of the form <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mn>...</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mo>=</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mn>...</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mo>=</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> and finally to see that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mn>...</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. We then have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
</mrow>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>y</mi><mo>+</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mi>a</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi><mi>y</mi><mo>+</mo><mi>a</mi>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>x</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi> θ </mi><mo>+</mo>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mi>x</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>+</mo><mi>Q</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mi>y</mi><mi>a</mi><mo>+</mo><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Again, we want to match to something of the form <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>+</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>,</mo>
</mrow>
</mrow></math> so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mo>=</mo><mi>a</mi><mi>x</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>+</mo><mi>Q</mi>
</mrow>
</mrow></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mi>m</mi><mo>=</mo><mi>x</mi><mi>y</mi><mi>a</mi><mo>+</mo><mi>Q</mi><mi> μ </mi><mo> ⟺ </mo><mi>m</mi><mo>=</mo>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mi>y</mi><mi>a</mi><mo>+</mo><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> assuming <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
</mrow></math> exists for now. Then:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
</mrow>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mi>x</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo>+</mo><mi>Q</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mi>y</mi><mi>a</mi><mo>+</mo><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi> θ </mi><mo>-</mo><mn>2</mn>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>+</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>-</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>+</mo><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>+</mo><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Notice here that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> is independent of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> so that we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
</mrow>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>+</mo><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ∝ </mo>
</mtd>
<mtd>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> And now... we complete squares again :D <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mi>y</mi><mi>x</mi><mo>+</mo><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<menclose notation="updiagonalstrike">
<mrow><mi>L</mi>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
</mrow>
</menclose><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mi>y</mi><mi>x</mi><mo>+</mo><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>a</mi><mi>y</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>a</mi><mi>y</mi><mi>x</mi><mo>+</mo><mn>2</mn><mi>a</mi><mi>y</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>Q</mi><mi> μ </mi><mo>+</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>y</mi><mo>+</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math>So<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>L</mi><mi>m</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>-</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>Q</mi><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>y</mi><mo>+</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi>
</mrow>
</mrow></math> If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is a Gaussian, then this should look something like<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>u</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo><mi> λ </mi>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mi> λ </mi><mi>u</mi><mi>y</mi><mo>+</mo><mi> λ </mi>
<msup>
<mrow><mi>u</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mo>=</mo><mi>a</mi><mo>-</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>x</mi>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> λ </mi><mi>u</mi><mo>=</mo><mi>a</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>Q</mi><mi> μ </mi><mo>,</mo>
</mrow>
</mrow></math> so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>u</mi><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</mfrac><mi>a</mi>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>L</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>Q</mi><mi> μ </mi><mn>.</mn>
</mrow>
</mrow></math> And then, we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo> ∝ </mo>
</mtd>
<mtd>
<mrow><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mi> λ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi>u</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> so we have that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>u</mi><mo>,</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-501">Not only this, but<div class="foot"><span class="foot_label">5</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-505">The derivation for these values is a bit involved. It can be consulted in <a href="https://www.youtube.com/watch?v=LCISTY9S6SQ&amp;t=287s">https://www.youtube.com/watch?v=LCISTY9S6SQ&amp;t=287s</a>.</div>
</div></div><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>u</mi><mo>=</mo>
<msup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>x</mi>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>a</mi>
</mrow>
</mfrac><mo>+</mo>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mi>Q</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>x</mi><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-506">We note now that the predictive distribution's mean prediction equals the point-prediction of the MAP. However, the variance of the prediction does depend on <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>, which is good, since the unvertainty of out predictions depends on how far observed samples are:</div>
<ul class="itemize" id="magicparlabel-507"><li class="itemize_item">If observed samples are near from our new inputs, then we should be more certain.</li>
<li class="itemize_item">If they are far, then we should be less certain.</li>
</ul>
<div class="standard" id="magicparlabel-509"><br/>
</div>
<h2 class="section" id="magicparlabel-510"><span class="section_label">3</span> Clustering</h2>
<div class="standard" id="magicparlabel-511">The goal of clustering is to partition a dataset into groups called <b>clusters</b>, in such a way that observations in the same cluster tend to be more similar than observations in different clusters. The input data is embedded in a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math>-dimensional space with a similarity/dissimilarity function defined among elements in the space, which should capture relatedness among elements in this space. Two elements are understood to be related when they are close in the space. Thus, a cluster is a compact group that is separated from other groups or elements outside the cluster.</div>
<div class="standard" id="magicparlabel-512">There is a large variety of clustering algorithms, such as hierarchical bottom-up or top-down clustering, probabilistic clustering, possibilistic clustering, algorithmic clustering, sprectral clustering or density-based clustering.</div>
<div class="standard" id="magicparlabel-513">The problem of clustering is quite complex, as if we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math> data points which we want to separate into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> clusters, then there are<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>N</mi><mo>,</mo><mi>K</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mi>K</mi><mo>!</mo>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true">(</mo><mfrac linethickness="0"><mi>K</mi><mi>i</mi></mfrac><mo fence="true" form="postfix" stretchy="true">)</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>K</mi><mo>-</mo><mi>i</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>N</mi>
</mrow>
</msup>
</mrow>
</mrow></math> possibilities. This is the <b>stirling number of the second king</b>.</div>
<div class="standard" id="magicparlabel-514">If in addition we don't know how many clusters we want to use, we have to add all possible <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>K</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>N</mi>
</mrow>
</mrow></math>, summing up to<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>N</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>K</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>N</mi>
</mrow>
</msubsup><mi>S</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>N</mi><mo>,</mo><mi>K</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> possibilites. This number is the <b>Bell number</b>, which is really gigantic<div class="foot"><span class="foot_label">6</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-518">For example, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>71</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≈ </mo><mn>4</mn><mo> × </mo><mn>1</mn>
<msup>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>71</mn>
</mrow>
</msup>
</mrow>
</mrow></math>.</div>
</div></div>.</div>
<h3 class="subsection" id="magicparlabel-519"><span class="subsection_label">3.1</span> k-Means</h3>
<div class="standard" id="magicparlabel-520">The <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means clustering algorithm takes a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> and an integer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn>
</mrow>
</mrow></math> as input, and separates <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math> into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> disjoint clusters. It is a <b>representative-based clustering</b>, meaning that each cluster is represented by one single point. In the case of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-means, the representative is the <b>cluster center</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo>,</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>, i.e., the average of all the points in that cluster. Each point in thus assigned to its closest representative point.</div>
<div class="standard" id="magicparlabel-521">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> is the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-th cluster, then we consider it a better cluster when the value<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow></math> is smaller.</div>
<div class="standard" id="magicparlabel-522">Now, let's formalize all this. First, we introduce an indicator variable<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mn>0</mn>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mo>,</mo>
</mrow>
</mrow></math> and the objective function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>J</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> which we aim to minimize by selecting appropriate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow></math>. The issue is that this problem is NP-hard, so we use an heuristic method that is only guaranteed to find local minima. This method relies in two facts:</div>
<ol class="enumerate" id="magicparlabel-523"><li class="enumerate_item">For fixed cluster centers <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>, it is easy to optimize cluster assignments <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow></math>.

<div class="proof" id="magicparlabel-524"><div class="proof_item"><span class="proof_label">Proof.</span>
Assume fixed <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>, then we assign <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> to the closest <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>, because if we assign it to a different center, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>, then we can minimize the sum as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>&gt;</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
</li><li class="enumerate_item">For fixed cluster assignments <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow></math>, it is easy to optimize cluster centers <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>.

<div class="proof" id="magicparlabel-526"><div class="proof_item"><span class="proof_label">Proof.</span>
Assume fixed <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow></math>, then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<mstyle mathvariant="script"><mi>J</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mover accent="false"><mo>=</mo>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn><mo>,</mo><mi> ∀ </mi><mi>k</mi><mo> ≠ </mo><mi>j</mi>
</mrow></mover>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>2</mn>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo><mn>2</mn>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>2</mn>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Thus, the minimum is obtained at<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mi>x</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> This is the average of the points of the cluster.</div>
</div>
</li></ol>
<div class="standard" id="magicparlabel-527">The pseudocode is illustrated in Algorithm <a href="#alg_k_Means_">3</a>.</div>
<div class="float-algorithm"><div class="plain_layout" id="magicparlabel-546"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 3:  k-Means.<a id="alg_k_Means_"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-551">The characteristics of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means are:</div>
<ol class="enumerate" id="magicparlabel-552"><li class="enumerate_item">:

<ol class="enumerate" id="magicparlabel-557"><li class="enumerate_item">Easy implementation.</li>
<li class="enumerate_item">Fast, even for large datasets.</li>
</ol>
</li><li class="enumerate_item">:

<ol class="enumerate" id="magicparlabel-564"><li class="enumerate_item">Can converge to local minimum.</li>
<li class="enumerate_item">Needs the number of clusters, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>, as input.</li>
<li class="enumerate_item">Hard cluster assignments: meaning that each point corresponds to a single cluster, which may not always be what we want.</li>
<li class="enumerate_item">Sensitive to ourliers and clusters of different sizes and densities.</li>
<li class="enumerate_item">Sensitive to initialization, so it is usual to run it many times and keep the best run.</li>
<li class="enumerate_item">Biased towards rounded clusters, because it uses the Euclidean distance.</li>
</ol>
</li></ol>
<h3 class="subsection" id="magicparlabel-570"><span class="subsection_label">3.2</span> k-Means++</h3>
<div class="standard" id="magicparlabel-571"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means++ is a variant of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means that uses a heuristic for initializing cluster centers as in Algorithm <a href="#alg_k_Means___">4</a>.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">choose first center &lt;@$\mu_1$@&gt; uniformly at random from all available examples

for k=2,...,K do
	choose next center &lt;@$\mu_k$ at random, with probability proportional to $||x_i-\mu_l||$@&gt;
	here, &lt;@$\mu_l$@&gt; is the closest center picked so far

proceed with standard k-Means</pre></div>
<div class="plain_layout" id="magicparlabel-587"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 4:  k-Means++.<a id="alg_k_Means___"></a>
</span></div>
</div>
<h3 class="subsection" id="magicparlabel-592"><span class="subsection_label">3.3</span> Choosing the number of cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math></h3>
<div class="standard" id="magicparlabel-593">The number of clusters is a hyper-parameter that has to be set by the user, and there is no obvious way to choose an optimal <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>, since it may not even exist. This is due to the fact that there is no such thing as a true clustering against to compare. Nevertheless, there are reasonable cluster quality criteria, that can be used to select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>. These criteria measure a balance between separation of clusters and their compactness. Depending on the problem, one criterion or another should be chosen.</div>
<h4 class="subsubsection" id="magicparlabel-594"><span class="subsubsection_label">3.3.1</span> Calinski-Harabasz index</h4>
<div class="standard" id="magicparlabel-595">The <b>CH index</b> uses Euclidean distances to measure cluster quality, so it is usually used with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-means. It measures the ratio between:</div>
<ul class="itemize" id="magicparlabel-596"><li class="itemize_item">Separation of cluster centers: sum of distances of cluster centers to the overall mean.</li>
<li class="itemize_item">Cluster compactness: sum of distances from each point to its assigned cluster center.</li>
</ul>
<div class="standard" id="magicparlabel-598">Thus, it is:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>C</mi><mi>H</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>N</mi><mo>-</mo><mi>K</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>K</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo>
<mover>
<mrow><mi>x</mi>
</mrow><mo stretchy="true">¯</mo>
</mover>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>r</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>x</mi>
</mrow><mo stretchy="true">¯</mo>
</mover><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
</mrow>
</mrow></math>. Notice that the quantities are normalized by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow>
<mrow><mi>N</mi><mo>-</mo><mi>K</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>K</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
</mrow></math> to avoid larger <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> having better values.</div>
<div class="standard" id="magicparlabel-599">The usual approach is run <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means with different values of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>, and then select the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> that maximizes the index.</div>
<div class="example" id="magicparlabel-600"><div class="example_item"><span class="example_label">Example 3.1.</span>
A <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means example in Matlab.</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-670" style="text-align: center;"><img alt="image: 11_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_0.png" src="11_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_0.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-727" style="text-align: center;"><img alt="image: 12_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_1.png" src="12_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_1.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-779" style="text-align: center;"><img alt="image: 13_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_2.png" src="13_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_2.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-831" style="text-align: center;"><img alt="image: 14_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_3.png" src="14_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___Notes_source_scripts_kmeans_images_figure_3.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
</div>
<h3 class="subsection" id="magicparlabel-878"><span class="subsection_label">3.4</span> Gaussian Mixtures</h3>
<div class="standard" id="magicparlabel-879">A <b>mixture of Gaussians</b> is a distributions that is built using a convex sum of Gaussians, making it more flexible than a single Gaussian distribution. If the <b>components</b> of the mixture are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math> are the <b>mixing coefficients</b>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>0</mn><mo> ≤ </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo> ≤ </mo><mn>1</mn><mo>,</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, then, the density function of the mixture is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> θ </mi><mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math> represents the parameters of the distribution.</div>
<div class="standard" id="magicparlabel-880">The key assumption is that each data point has been generated from only one component, we just don't know which one.</div>
<div class="standard" id="magicparlabel-881">In Figure <a href="#fig_Different_Gaussian_mixtures">9</a>, we can see different Gaussian Mixtures that arise from the same components, choosing different mixing coefficients.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-886" style="text-align: center;"><img alt="image: 15_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado15.png" src="15_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado15.png"/>
</div>
<div class="plain_layout" id="magicparlabel-887"><span class="float-caption-Standard float-caption float-caption-standard">Figure 9:  <a id="fig_Different_Gaussian_mixtures"></a>
Different Gaussian mixtures with the same components.</span></div>
</div>
<h4 class="subsubsection" id="magicparlabel-892"><span class="subsubsection_label">3.4.1</span> Clustering with a Gaussian mixture</h4>
<div class="standard" id="magicparlabel-893">The idea is to identify each component with a cluster, so we want to determine the component from which each point in the dataset is more likely to have been created, as well as the parameters of each of the distribution.</div>
<div class="standard" id="magicparlabel-894">Thus, to cluster a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> clusters, the approach is the following:</div>
<ol class="enumerate" id="magicparlabel-895"><li class="enumerate_item">Use Expectation-Maximization (EM) to estimate the mixture, obtaining approximations <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> π </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> for each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Find assignments for each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> to the clusters.</li>
</ol>
<div class="standard" id="magicparlabel-897">In this case, the clustering is <b>soft</b>, in opposition to the hard clustering of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means. This means that we will obtain the probability for each point belonging to each cluster.</div>
<h4 class="subsubsection" id="magicparlabel-898"><span class="subsubsection_label">3.4.2</span> A generative mixture of Gaussians</h4>
<div class="standard" id="magicparlabel-899">To sample from a mixture of Gaussians, we use a <b>generative model </b>that uses a latent variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>z</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> whose components are all 0, except one which denotes the component from which we sample, and we do:</div>
<ol class="enumerate" id="magicparlabel-900"><li class="enumerate_item">Pick component <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> with probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>. This means that we set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math> with probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="enumerate_item">Generate a sample <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> according to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
</ol>
<div class="standard" id="magicparlabel-902">The probability of generating a sample <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> using this generative model is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>z</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>z</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> the joint distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>z</mi>
</mrow></math> is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>z</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msubsup>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</msubsup>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math>and the marginal distribution over <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>z</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>z</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>z</mi>
</mrow>
</msub>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<msubsup>
<mrow><mi> π </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
</mrow>
</msubsup>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
</mrow>
</msup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Therefore, we can use Bayes to compute the conditional distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>z</mi>
</mrow></math> given <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mrow><mo>=</mo>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> The quantity <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> indicates how probable it is that a particular data point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> has been generated by the mixture component <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. Or, in the context of clustering: <em>how probable it is that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> belongs to cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. </em>We use these quantities as the <b>soft membership</b> to each cluster. If a hard membserhip is needed, then we assign <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> to cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>j</mi>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>j</mi><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
<h4 class="subsubsection" id="magicparlabel-903"><span class="subsubsection_label">3.4.3</span> Learning Gaussian mixtures with Expectation-Maximization</h4>
<div class="standard" id="magicparlabel-904">We have a dataset of unlabelled observations <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> and we want to model it as a Gaussian mixture, with unknown parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> θ </mi><mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math>, with a fixed <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>. For this we use the maximum likelihood approach. First, we compute the loglikelihood of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>;</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> log </mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> This is hard to optimize... so we use the Expectation-Maximization approach. First, we can differenciate it to see what conditions must hold for local maxima, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> leading to<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> which is a weighted average of the points in our data, with weights being the soft assignments of each point to cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. </div>
<div class="standard" id="magicparlabel-905">The problem now, is we cannot know <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> without <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>. Now, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> gives us<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> which is the sample covariance matrix of all <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, weigthed by the soft assignments of each point to cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. We have the same problem!</div>
<div class="standard" id="magicparlabel-906">Since we have the constraint <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, we now maximize the Lagrangian<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo>=</mo><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi> λ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> obtaining<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> π </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> which is the average of all soft assignments for each point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>. Again the same problem is present.</div>
<div class="standard" id="magicparlabel-907">Therefore, we are in a situation in which we can estimate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> if we know <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>, and we can compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> γ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> from the estimates <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> π </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>; and we can use this in our benefit by following the pseudocode depicted in Algorithm <a href="#alg_EM">5</a>. Commonly, the initializations are done using the result of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means in the following manner:</div>
<ul class="itemize" id="magicparlabel-908"><li class="itemize_item">Run <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-Means with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mi>K</mi>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> to the mean of cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</li>
<li class="itemize_item">Set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> to the sample covariance of cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</li>
<li class="itemize_item">Set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> π </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> as the fraction of examples assigned to cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</li>
</ul>
<div class="float-algorithm"><div class="plain_layout" id="magicparlabel-934"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 5:  EM algorithm.<a id="alg_EM"></a>
</span></div>
</div>
<div class="example" id="magicparlabel-939"><div class="example_item"><span class="example_label">Example 3.2.</span>
An example of the EM algorithm using Matlab</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-994" style="text-align: center;"><img alt="image: 16_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___s_source_scripts_EM_example_images_figure_0.png" src="16_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___s_source_scripts_EM_example_images_figure_0.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1057" style="text-align: center;"><img alt="image: 17_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___s_source_scripts_EM_example_images_figure_1.png" src="17_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___s_source_scripts_EM_example_images_figure_1.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
</div>
<h4 class="subsubsection" id="magicparlabel-1126"><span class="subsubsection_label">3.4.4</span> Special cases</h4>
<div class="standard" id="magicparlabel-1127">The shape of the Gaussians can be restricted, obtaining special cases of mixtures:</div>
<ul class="itemize" id="magicparlabel-1128"><li class="itemize_item">No restrictions on <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>: the general case, in which each cluster can have general Gaussian shape.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> are diagonal: each Gaussian component is forced to have no correlation among input dimensions.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>I</mi>
</mrow>
</mrow></math> are isotropic or spherical: each Gaussian component is forced to be spherical, so no correlation among input variables and same scaling across each input variable.</li>
</ul>
<div class="standard" id="magicparlabel-1131"><br/>
</div>
<h2 class="section" id="magicparlabel-1132"><span class="section_label">4</span> Linear Classifiers</h2>
<div class="standard" id="magicparlabel-1133">In classification, we have a <b>labelled</b> dataset, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> are <b>labels</b>. Thus, the tuple <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> means that the vector <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is associated to the label <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>. With this setup, we aim at producing a <b>classification model</b>, meaning a function that, given a new input <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo>'</mo>
</mrow>
</mrow></math>, predicts the label <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo>
</mrow>
</mrow></math> that it should be associated with. Usually, we distinguish between two kinds of classification, attending to the number of labels considered:</div>
<ul class="itemize" id="magicparlabel-1134"><li class="itemize_item">In <b>binary classification</b>, there are only two possible labels, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">In <b>multi-class classification</b>, there are more than two labels, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>&gt;</mo><mn>2</mn>
</mrow>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-1136">Now, we introduce some useful terms:</div>
<div class="definition" id="magicparlabel-1142"><div class="definition_item"><span class="definition_label">Definition 4.1.</span>
The <b>decision regions</b> are a partition of the feature space, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>P</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>P</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⊂ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math>, such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mo> ⋂ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>P</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mi> ∅ </mi>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mo> ⋃ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>P</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math>. Intuitively, they are the regions in which we divide the feature space, so that all elements inside a region have the same label.</div>
<div class="definition_item">The <b>decision boundaries</b> are the points in the frontier between decision regions.</div>
<div class="definition_item">A <b>classifier</b> can then be understood as the creation of the decision regions.</div>
<div class="definition_item">A <b>linear classifier</b> is a classifier in which the decision boundaries are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math>-dimensional hyperplanes.</div>
</div>
<div class="example" id="magicparlabel-1151"><div class="example_item"><span class="example_label">Example 4.1.</span>
A visualization.</div>
<div class="example_item">In Figure <a href="#fig_Different_classifiers__Linear">10</a>, we can see different classification models and the regions they generate for the iris dataset. The left model correspond to a linear classifier, and we can see how the decision boundaries are linear. The other two models are not linear.</div>
<div class="example_item"><div class="float-figure"><div class="plain_layout" id="magicparlabel-1157" style="text-align: center;"><img alt="image: 18_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado16.png" src="18_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado16.png" style="width:40%;"/>
<img alt="image: 19_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado17.png" src="19_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado17.png" style="width:40%;"/>
<img alt="image: 20_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado18.png" src="20_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado18.png" style="width:40%;"/>
</div>
<div class="plain_layout" id="magicparlabel-1158"><span class="float-caption-Standard float-caption float-caption-standard">Figure 10:  Different classifiers. Linear (left). Quadratic (middle). knn (right).<a id="fig_Different_classifiers__Linear"></a>
</span></div>
</div>
</div>
</div>
<div class="standard" id="magicparlabel-1163"><br/>
</div>
<div class="standard" id="magicparlabel-1164">Many useful classifiers don't just predict the input's class, but also the probabilities of the input belonging to each class. This is desirable, as it enables us to express uncertainty about the prediction that we make. For example, in binary classification it is a common approach to map the target labels to be 0 or 1, and then make predictions as a continuous value in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>. More explicitly, we can have labels <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>'</mo><mi>s</mi><mi>i</mi><mi>c</mi><mi>k</mi><mo>'</mo><mo>,</mo><mo>'</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>h</mi><mi>y</mi><mo>'</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> and encode <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>'</mo><mi>s</mi><mi>i</mi><mi>c</mi><mi>k</mi><mo>'</mo><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>'</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>h</mi><mi>y</mi><mo>'</mo><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>, so that given a patient <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo>'</mo>
</mrow>
</mrow></math>, we obtain a prediction <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, indicating the probability of the patient being sick. </div>
<div class="standard" id="magicparlabel-1165">In classification with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>K</mi><mo>&gt;</mo><mn>2</mn>
</mrow>
</mrow></math> classes, it is common to encode the labels using <b>one-hot encoding</b>, meaning that we map the labels into the set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msup>
</mrow></math>. For example, if we have three labels, then they are encoded as <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. When in this scenario, predictions are usually points in the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>K</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-simplex, i.e., a prediction <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> must be <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>0</mn><mo> ≤ </mo><mi>y</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo> ≤ </mo><mn>1</mn><mo>,</mo><mi> ∀ </mi><mi>k</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mi>y</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>. Each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi>
<msub>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> represents the probability of the input belonging to class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</div>
<h3 class="subsection" id="magicparlabel-1166"><span class="subsection_label">4.1</span> Decision boundary in probabilistic models</h3>
<div class="standard" id="magicparlabel-1167">From a probabilistic perspective, we can think of the joint probability of examples and labels, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. When we are building a classifier, we then want to minimize the expected loss, or expected error. Note, nonetheless, that loss here is a bit different from the regression loss. A natural way to think about this loss is through loss or cost matrices. A cost matrix is a table as the following:</div>
<div class="standard" id="magicparlabel-1168" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1210">Real</div>
</td>
<td align="center" rowspan="2" valign="middle">
<div class="plain_layout" id="magicparlabel-1213"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" rowspan="2" valign="middle">
<div class="plain_layout" id="magicparlabel-1216"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" rowspan="2" valign="middle">
<div class="plain_layout" id="magicparlabel-1219">...</div>
</td>
<td align="center" rowspan="2" valign="middle">
<div class="plain_layout" id="magicparlabel-1222"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1225">Predicted</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1240"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1243">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1246"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>,</mo><mn>2</mn>
</mrow>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1249">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1252"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow>
</msub>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1255"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1258"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mn>2</mn><mo>,</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1261">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1264">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1267"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mn>2</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow>
</msub>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1270"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1273"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1276"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1279"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋱
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1282"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1285"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1288"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mi>K</mi><mo>,</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1291"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mi>K</mi><mo>,</mo><mn>2</mn>
</mrow>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1294">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1297">0</div>
</td>
</tr></tbody>
</table>
</div>
<div class="standard" id="magicparlabel-1298">This matrix indicates the cost of each error. Note that not all errors need to have the same cost. For example, in a medical context, it has a higher cost to predict that a sick patient is healthy (this person could potentially die), than to predict that a healthy person is sick (in which case further tests would probably correct the mistake). A cost matrix for this case could look like the following:</div>
<div class="standard" id="magicparlabel-1299" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1321">Real</div>
</td>
<td align="center" rowspan="2" valign="middle">
<div class="plain_layout" id="magicparlabel-1324"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>h</mi><mi>y</mi>
</mrow>
</mrow></math></div>
</td>
<td align="center" rowspan="2" valign="middle">
<div class="plain_layout" id="magicparlabel-1327"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>c</mi><mi>k</mi>
</mrow>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1330">Predicted</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1339"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>h</mi><mi>y</mi>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1342">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1345">60</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1348"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>c</mi><mi>k</mi>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1351">10</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1354">0</div>
</td>
</tr></tbody>
</table>
</div>
<div class="standard" id="magicparlabel-1355">We will focus in the case of all errors having the same impact, which is called the 0-1 loss.</div>
<div class="standard" id="magicparlabel-1356">Let's now see how, given a new example <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>, we can use a 'rule' to choose the label that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> should have. We have random variables <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> with joint distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. We can compute the expected loss of assigning the label <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
</mrow>
</mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>. For this, we first define the loss function as the 0-1 loss:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>0</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>a</mi><mo>=</mo><mo>=</mo><mi>b</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mn>.</mn>
</mrow>
</mrow></math> Therefore:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>Y</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>,</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>y</mi><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
</mrow>
</mrow>
</msub><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>,</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>=</mo><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>y</mi><mo> ≠ </mo><mi>c</mi>
</mrow>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>=</mo><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo> ≠ </mo><mi>c</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>=</mo><mi>c</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Of course, we want to minimize the expected loss, so we aim at predicting the class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo>
</mrow>
</mrow></math> minimizing <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>Y</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>,</mo><mi>y</mi><mo>'</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi>y</mi>
</mrow>
</msub>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>Y</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>Y</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi>y</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi>y</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This is called the <b>Bayes classifier</b>, and it is optimal when we use 0-1 loss. Its error is given by the so-called <b>Bayes error rate</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>E</mi><mi>R</mi><mo>=</mo><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>X</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>'</mo><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mn>1</mn><mo>-</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>'</mo><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi>x</mi>
</mrow><mo>=</mo><mn>1</mn><mo>-</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>y</mi><mo>'</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>'</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi>x</mi>
</mrow><mn>.</mn>
</mrow>
</mrow></math> Of course, we can use this classifier to partition the feature space into regions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub><mo>,</mo><mi>c</mi><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
</mrow>
</mrow></math>, and we can compute the BER summing over all regions:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>E</mi><mi>R</mi><mo>=</mo><mn>1</mn><mo>-</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>c</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi>x</mi>
</mrow><mn>.</mn>
</mrow>
</mrow></math> Before, we claimed that the Bayes classifier is optimal. However, in practice we don't know the distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>,</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so it cannot be implemented exactly. Therefore, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is estimated from data, and this estimates are used for classification, incurring in additional errors. To learn <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, there are two basic approaches, namely discrimintative classifiers and generative classifiers.</div>
<h3 class="subsection" id="magicparlabel-1357"><span class="subsection_label">4.2</span> Generative classifiers</h3>
<div class="standard" id="magicparlabel-1358">Generative classifiers learn <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> through the Bayes rule.</div>
<h4 class="subsubsection" id="magicparlabel-1359"><span class="subsubsection_label">4.2.1</span> Discriminant analysis</h4>
<div class="standard" id="magicparlabel-1360">Discriminant analysis is the result of implementing a Bayes classifier assuming that the class-conditional distributions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> are gaussian. This means that, having <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, then it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> If we also assume that the prior distributions are <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
</mrow>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, then we define the <b>discriminant functions<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo> ⋅ </mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mo> det </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> exp </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> det </mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> det </mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msubsup>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> </b>This is a <b>quadratic discriminant function</b>, and the corresponding classifier is implemented by predicting<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>'</mo><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub><mo>,</mo><mspace width="10px"></mspace><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mspace width="10px"></mspace><mi>k</mi><mo>'</mo><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This corresponds to chossing the label with maximum probability a posteriori.</div>
<div class="standard" id="magicparlabel-1361">The <b>decision boundaries</b> in this case are those regions in which there exist <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>k</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>k</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math> with<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>k</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>k</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-1362">These corresponds to hyper-quadrics in the feature space, and this is a quadratic method, usually called quadratic discriminant analysis (QDA).</div>
<div class="standard" id="magicparlabel-1363">Of course, we can further simplify our assumptions, by assuming that all labels have the same covariance matrix, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mo> Σ </mo>
</mrow>
</mrow></math> for all <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>. In this simpler case, the discriminant functions end up being<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>x</mi><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
</mrow>
</mrow></math> because now <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> det </mo>
<msub>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mo> det </mo><mo> Σ </mo>
</mrow>
</mrow></math> is constant for all <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>, so we can remove it. Furthermore, the term <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msubsup>
<mrow><mo> Σ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msubsup><mi>x</mi><mo>=</mo>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi>x</mi>
</mrow>
</mrow></math> is also constant with respect to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>, so it will not affect the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> chosen. Therefore, we end up with <b>linear discriminant functions</b>, in which the <b>decision boundaries</b> correspond to hyperplanes in the feature space. This is a linear method, usually called linear discriminant analysis (LDA).</div>
<div class="standard" id="magicparlabel-1364">In Figure <a href="#fig_Different_classifiers__Linear">10</a>, the left diagram corresponds to a LDA partitioning of the feature space for the iris dataset, while the one in the center is a QDA partitioning.</div>
<h4 class="subsubsection_" id="magicparlabel-1365">Further assumptions</h4>
<div class="standard" id="magicparlabel-1366">Of course, we can make more simplifying assumptions for our model, such as:</div>
<ul class="itemize" id="magicparlabel-1367"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Σ </mo><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>,</mo><mn>...</mn><mo>,</mo>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is diagonal. In this case, we obtain<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> Σ </mo>
</mrow></math> is an isotropic Gaussian, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Σ </mo><mo>=</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>I</mi>
</mrow>
</mrow></math>. In this case, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>K</mi>
</mrow>
</mfrac><mo>,</mo><mi> ∀ </mi><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>, all priors are equal. In this case<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<h4 class="subsubsection_" id="magicparlabel-1370">Distance-based learning perspective</h4>
<div class="standard" id="magicparlabel-1371">In all seen cases, we have a minimum-distance classifier in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow></math>:</div>
<ul class="itemize" id="magicparlabel-1372"><li class="itemize_item">The general QDA case corresponds to using different Mahalanobis distance from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> to each class center <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item">The LDA case uses the same Mahalanobis distance from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> to each class center <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item">In the case of all covariance matrix being equal and diagonal, the distance is the weighted Euclidean distance.</li>
<li class="itemize_item">In the isotropic Gaussians case, the distance corresponds to the usual Euclidean distance.</li>
</ul>
<h4 class="subsubsection_" id="magicparlabel-1376">Implementation</h4>
<div class="standard" id="magicparlabel-1377">It is usual to use MLE and estimate the centers and covariance matrices using the training dataset. If we define the sets<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, then, the estimates are<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> π </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>,</mo><mspace width="10px"></mspace>
<msub>
<mrow>
<mover>
<mrow><mi> μ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mi>x</mi><mo>,</mo>
</mrow>
</mrow></math> and the covariance matrix is:</div>
<ul class="itemize" id="magicparlabel-1378"><li class="itemize_item">In QDA:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">In LDA<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<h4 class="subsubsection_" id="magicparlabel-1380">Final remarks on discriminant analysis</h4>
<div class="standard" id="magicparlabel-1381">Bayesian classifiers are optimal when the class-conditional densities and priors are known. This means that, if know the underlying distributions, then these classifiers are our best choice. Of course, this is not realistic, and estimations need to be made. However, normal distributions appear in a wide range of real scenarios, and even if we have to estimate the centers and covariance matrices, QDA and LDA are a very good choice when data resembles Gaussian distributions. In addition, they are well-principled, having a solid mathematical theory behind them, they are fast and reliable.</div>
<div class="standard" id="magicparlabel-1382">Of course, if the real distribution is very far from being a Gaussian, then the model obtained will be poor, so one should take care of this.</div>
<div class="standard" id="magicparlabel-1383">Also, it is important to ensure that we are correctly estimating the parameters of the Gaussians, because otherwise the model will not work, not even with underlying Gaussian data.</div>
<div class="standard" id="magicparlabel-1384">And it is clear that once we are relying on sample estimates instead of population parameters, we loose the optimality of the method.</div>
<div class="standard" id="magicparlabel-1385">In practice, it is really hard to assess which assumptions hold and which ones do not, so we can be limited to use a trial and error approach.</div>
<h4 class="subsubsection" id="magicparlabel-1386"><span class="subsubsection_label">4.2.2</span> Regularized discriminant analysis (RDA)</h4>
<div class="standard" id="magicparlabel-1387">When data is scarce, some problems can arise while using discriminant analysis. For example:</div>
<ul class="itemize" id="magicparlabel-1388"><li class="itemize_item">If there are more dimensions than samples with some label, i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo>&gt;</mo>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math>, for some <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>, then QDA cannot be applied, because <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> is singular. The reason is that each of the sample is adding a rank-1 matrix. Therefore, to get a rank-<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math> matrix, we need at least <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> samples. Not only this, but in fact, as we are subtracting the sample mean, the last value is linearly dependant of the previous <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> values. Therefore, we need at least <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo><mn>1</mn>
</mrow>
</mrow></math> samples to be able to construct a rank-<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math> covariance matrix.</li>
<li class="itemize_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo>&gt;</mo><mi>n</mi>
</mrow>
</mrow></math>, then we cannot use QDA nor LDA, as all covariance matrices are singular.</li>
</ul>
<div class="standard" id="magicparlabel-1390">RDA computes the covariance matrices as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> α </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> α </mi>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> α </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> α </mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> is the regularization parameter. The method is QDA when <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> α </mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math> and is LDA when <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> α </mi><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>. In any other case, it is something in between. </div>
<div class="standard" id="magicparlabel-1391">A further way to regularize the matrices is by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> α </mi><mo>,</mo><mi> γ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> γ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> α </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi> γ </mi>
<msup>
<mrow>
<mover>
<mrow><mi> σ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>I</mi><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi> σ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mo> Σ </mo>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> α </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</mfrac>
</mrow>
</mrow></math>, and the diagonal term improves the well-conditioning of the method.</div>
<h3 class="subsection" id="magicparlabel-1392"><span class="subsection_label">4.3</span> Naïve Bayes</h3>
<div class="standard" id="magicparlabel-1393">The Naïve Bayes Classifier is a Bayesian classifier that assumes that the features are pair-wise independent in the class-conditional distribution. This means that the probability can be written as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This assumptions does not hold in general, but this approach can provide a good approximation in many cases. Also, it is practical, as the amount of parameters to estimate is small. </div>
<div class="standard" id="magicparlabel-1394">As before, we classify the input record <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> in the class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> that maximizes the discriminant function:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup><mo> log </mo><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Therefore, we need to</div>
<ol class="enumerate" id="magicparlabel-1395"><li class="enumerate_item">Estimate the class priors as the sample frequency, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Estimate the class-conditional densities for each input feature independently.</li>
</ol>
<div class="standard" id="magicparlabel-1397">Naïve Bayes can also be used in the case of categorical variables. To model binary features, we can use, for example, the Bernoulli distribution<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo><mi>x</mi>
</mrow>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> is the probability of the event happening. For a binary feature, we would need to estimate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> parameters, one for each class, so that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>|</mo><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo><mi>x</mi>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> If we had all our features as binary, then the discriminant functions would be<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mo> log </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> log </mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow>
</msub><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow></math> is the Bernoulli parameter for the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>j</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> feature and the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> class. Note that this is a linear function with respect to to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-1398">If instead we have categorical features with more values, we can then use the Categorical distribution<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<msub>
<mrow><mi> π </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>v</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mi>v</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> log </mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>v</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> is 1 if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>r</mi>
</mrow>
</mrow></math> is True and 0 otherwise, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>v</mi>
</mrow>
</mrow>
</msub>
</mrow></math> is the Categorical parameter for the value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>v</mi>
</mrow></math> of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>j</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> feature and the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> class.</div>
<div class="standard" id="magicparlabel-1399">Now, we need to estimate these parameters, for which we can use the sample frequencies. Note how 0-frequencies can be a problem, so it is a common approach to utilize <b>Laplace smoothing</b><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>v</mi><mo>|</mo><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>,</mo><mi>v</mi>
</mrow>
</mrow>
</msub><mo>+</mo><mi>p</mi>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo><mi>p</mi><mi>V</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> Here:</div>
<ul class="itemize" id="magicparlabel-1400"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mo>+</mo>
</mrow>
</msup>
</mrow>
</mrow></math> is a weight parameter assigned to the prior distribution of observing values <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>v</mi>
</mrow></math>. It is typically set to 1, just to avoid 0 values.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>V</mi>
</mrow></math> is the number of modalities (number of distinct values) of the feature modelled.</li>
</ul>
<div class="example" id="magicparlabel-1402"><div class="example_item"><span class="example_label">Example 4.2.</span>
Naïve Bayes in MATLAB</div>
<div class="example_item"></div>
</div>
<h4 class="subsubsection" id="magicparlabel-1543"><span class="subsubsection_label">4.3.1</span> Gaussian Naïve Bayes</h4>
<div class="standard" id="magicparlabel-1544">If we have numericla features, the usual approach is to assume they follow Gaussian distributions, then we estimate their mean and variance using MLE. If all features are assumed Gaussian, this approach is equivalent to QDA with diagonal covariance matrices.</div>
<div class="standard" id="magicparlabel-1545">Other approaches are:</div>
<ul class="itemize" id="magicparlabel-1546"><li class="itemize_item">Discretize numerical values and proceed with Categorical NB.</li>
<li class="itemize_item">Assume a different distribution and estimate its sample parameters from data.</li>
</ul>
<div class="standard" id="magicparlabel-1548">Note that when the data is mixed, we can assume a different distribution for each feature, and then add the log-likelihoods altogether.</div>
<h3 class="subsection" id="magicparlabel-1549"><span class="subsection_label">4.4</span> Perceptron and Logistic Regression <a id="subsec_Perceptron_and_Logistic"></a>
</h3>
<div class="standard" id="magicparlabel-1550">The <b>perceptron</b> is a mathematical model of the functioning of a neuron in our brain. In Figure <a href="#fig_A_neuron_">11</a> we can see a diagram of a neuron. Other neurons transmit signals into our neuron via the dendrites, then 'something' happens inside the neuron, and it transmits or not signals through its axon towards the neurons to which it is connected.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-1555" style="text-align: center;"><img alt="image: 21_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_neuron.png" src="21_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_neuron.png" style="width:60%;"/>
</div>
<div class="plain_layout" id="magicparlabel-1556"><span class="float-caption-Standard float-caption float-caption-standard">Figure 11:  A neuron.<a id="fig_A_neuron_"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-1561">This behavior was mathematically modeled by Roosenblatt in his pioneer paper [<a href="#LyXCite-Rosenblatt_1958"><span class="bib-label">4</span></a>]. He did this with the concept of perceptron:</div>
<ul class="itemize" id="magicparlabel-1562"><li class="itemize_item">A perceptron is a function <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo> → </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, where

<ul class="itemize" id="magicparlabel-1563"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math> is the number of inputs. In the neuron analogy, it is the number of dendrites of the neuron.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> represents that a neuron can send a signal, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, or not, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo>=</mo><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
</ul>
</li><li class="itemize_item">This function operates in the following maner:

<ul class="itemize" id="magicparlabel-1566"><li class="itemize_item">For each input <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, there is a weight <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>
</mrow>
</mrow></math>. This models somehow the strength of the connection between two neurons.</li>
<li class="itemize_item">There is an aritificial input called <b>bias</b>, which is always set to 1 and serves the purpose of being able to center the inputs. It is usually depicted by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math> and goes with its weight <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math>, used to determine the true bias.</li>
<li class="itemize_item">The inputs are weighted and sum, to form a state of the neuron<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>0</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Finally, we apply the <b>activation</b> <b>function</b> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>S</mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mn>.</mn>
</mrow>
</mrow></math> </li>
</ul>
<div class="standard" id="magicparlabel-1570">Therefore,<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
</li></ul>
<div class="standard" id="magicparlabel-1571">This is depicted in Figure <a href="#fig_A_simple_perceptron_">12</a>. Notice</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-1576" style="text-align: center;"><img alt="image: 22_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___rning_LectureNotes_source_perceptron_drawio.png" src="22_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___rning_LectureNotes_source_perceptron_drawio.png" style="width:60%;"/>
<span class="float-caption-Standard float-caption float-caption-standard">Figure 12:  A simple perceptron.<a id="fig_A_simple_perceptron_"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-1581">This way, we can classify the input variables <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> into two classes, 1 or -1. But... what are the weights?</div>
<div class="example" id="magicparlabel-1582"><div class="example_item"><span class="example_label">Example 4.3.</span>
Imagine we have the following classification function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>x</mi><mo>&gt;</mo><mn>0.5</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mo>,</mo>
</mrow>
</mrow></math> then it is easy to construct a perceptron that can classify the instances. We have:</div>
<ul class="itemize" id="magicparlabel-1583"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>=</mo><mn>0.5</mn><mo>,</mo>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Therefore, we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>-</mo><mn>0.5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>x</mi><mo>-</mo><mn>0.5</mn><mo>&gt;</mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>x</mi><mo>&gt;</mo><mn>0.5</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<div class="standard" id="magicparlabel-1586">And we are good!</div>
</div>
<div class="standard" id="magicparlabel-1587">In this previous example we can grab some intuition on how the weights are chosen, but doing this by hand is not scalable at all. When we have several input variables, this process is complicated quite a lot. Luckily, the <b>perceptron algorithm</b> helps us estimate the weigths.</div>
<div class="standard" id="magicparlabel-1588">This algorithm is an on-line algorithm, meaning that it process one training example at a time, updating <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>W</mi>
</mrow></math> incrementally. The training examples are pairs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>. Also, we can scale all <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> to lie in the unit sphere, because this also scales the hyperplanes of classification and classes remain the same. The algorithm goes as follows:</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">init W=0

for i in range(1,e):
	for each (X,y):
	
		compute prediction=&lt;@$F(S(W^TX))$@&gt;
	
		if prediction != y:
			# update W
			W = W + lr*X*y
return W</pre></div>
<div class="plain_layout" id="magicparlabel-1608"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 6:  Perceptron algorithm (input X, classes y, learning rate lr, epochs e) -&gt; weights W</span></div>
</div>
<div class="standard" id="magicparlabel-1613">The updates are made like that because we can consider the error function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi>y</mi>
</mrow>
</mrow></math> only when <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> is misclasified. In that case, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mi>y</mi><mo>&lt;</mo><mn>0</mn>
</mrow>
</mrow></math> and thus the minus sign. We want to minimize this error, for which we follow a gradient descent approach (we will deepen on this later), so we update <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>W</mi>
</mrow></math> as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>W</mi><mo>'</mo><mo>=</mo><mi>W</mi><mo>-</mo><mi> η </mi><mi> ∇ </mi><mi>E</mi><mo>=</mo><mi>W</mi><mo>+</mo><mi> η </mi><mi>X</mi><mi>y</mi><mn>.</mn>
</mrow>
</mrow></math> The basic idea is that if we now utilize this new weights in the same input, we would get<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>W</mi>
<msup>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>W</mi><mo>+</mo><mi> η </mi><mi>X</mi><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>=</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi> η </mi><mi>y</mi>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mn>.</mn>
</mrow>
</mrow></math> Now, say <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, then it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>W</mi>
<msup>
<mrow><mo>'</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>=</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>+</mo><mi> η </mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>&gt;</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi><mo>,</mo>
</mrow>
</mrow></math> so we have made the input to be closer to be positive, and thus correctly classified. If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo>=</mo><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> the same logic applies.</div>
<div class="standard" id="magicparlabel-1614">In fact, under some conditions, convergence is ensured:</div>
<div class="theorem" id="magicparlabel-1620"><div class="theorem_item"><span class="theorem_label">Theorem 4.1.</span>
<b>Perceptron convergence theorem</b></div>
<div class="theorem_item">For any finite set of linearly separable labeled examples, the Perceptron Learning Algorithm will halt after a finite number of iterations. In other words, after a finite number of iterations, the algorithm yields a vector W that classifies perfectly all the examples.</div>
</div>
<div class="standard" id="magicparlabel-1627">The proof can be read in <a href="https://web.mit.edu/course/other/i2course/www/vision_and_learning/perceptron_notes.pdf">https://web.mit.edu/course/other/i2course/www/vision_and_learning/perceptron_notes.pdf</a>.</div>
<div class="example" id="magicparlabel-1628"><div class="example_item"><span class="example_label">Example 4.4.</span>
A simple perceptron in MATLAB</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1645" style="text-align: center;"><img alt="image: 23_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_0.png" src="23_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_0.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1683" style="text-align: center;"><img alt="image: 24_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_1.png" src="24_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_1.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1722" style="text-align: center;"><img alt="image: 25_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_2.png" src="25_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_2.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1755" style="text-align: center;"><img alt="image: 26_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_3.png" src="26_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M____scripts_perceptron_example_images_figure_3.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
</div>
<div class="standard" id="magicparlabel-1808">We can improve the approach by choosing a different activation function, which would be differentiable ideally. A usual alternative is the <b>logistic function</b><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>+</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>z</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> which maps <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo> → </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, so that this input can be interpreted as a probability, allowing us to represent uncertainty in the prediction. This function has the following properties:</div>
<ul class="itemize" id="magicparlabel-1809"><li class="itemize_item">It verifies a pseudo-symmetry<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>-</mo><mi>z</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">It is differentiable, with derivative<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Its inverse is the logit function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>p</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<div class="standard" id="magicparlabel-1812">When we use the logistic function, we are performing what is called logistic regression for binary classification. Again, we have a dataset of pairs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, associating label <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math> with a positive example, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> with a negative example. In logistic regression we model<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where, again, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>W</mi>
</mrow></math> is the weight vector. Therefore, we are modelling <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo><mi>B</mi><mi>e</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. Notice that we don't assume anything about the distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, though.</div>
<h4 class="subsubsection_" id="magicparlabel-1813">Why is logistic regression a linear classifier?</h4>
<div class="standard" id="magicparlabel-1814">When we classify, we need to set a threshold above which we classify the label to be 1. Usually, this threshold is set to be <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mn>0.5</mn>
</mrow></math>. Now,<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>&gt;</mo><mn>0.5</mn><mo> ⟺ </mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>z</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>&gt;</mo><mn>0.5</mn><mo> ⟺ </mo><mn>1</mn><mo>&gt;</mo><mn>0.5</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>z</mi>
</mrow>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⟺ </mo><mn>2</mn><mo>&gt;</mo><mn>1</mn><mo>-</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>z</mi>
</mrow>
</mrow>
</msup><mo> ⟺ </mo><mn>1</mn><mo>&gt;</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>z</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ⟺ </mo><mn>0</mn><mo>&gt;</mo><mo>-</mo><mi>z</mi><mo> ⟺ </mo><mi>z</mi><mo>&gt;</mo><mn>0.</mn>
</mrow>
</mrow></math> And remember that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>z</mi><mo>=</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
</mrow></math>, so, in fact, we are classifying using the same criteria as before.</div>
<div class="standard" id="magicparlabel-1815">At this point, we can try to use maximum likelihood in the search of an optimal <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>W</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo><mi>W</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>B</mi><mi>e</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi> σ </mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> As usual, we take the log-likelihood, but in this case we minimize the negative log-likelihood instead, which can be interpreted as an error function:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo><mo> log </mo>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo> log </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo><mi>W</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> log </mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> This error expression is known as <b>log loss</b> or <b>binary cross-entropy</b>, and it is widely used in classification schemes.</div>
<div class="standard" id="magicparlabel-1816">Now, as we aim to find its minimum, we compute its gradient. For this, recall that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> and notice that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi>W</mi>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> Recall also that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mo> ○ </mo><mi>g</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>'</mo><mo>=</mo><mi>g</mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>f</mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Now, let's go for this derivative:</div>
<div class="standard" id="magicparlabel-1817"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi> ∇ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi>W</mi>
</mrow>
</mrow>
</mfrac><mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> log </mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi>W</mi>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi>W</mi>
</mrow>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mrow>
<menclose notation="downdiagonalstrike">
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</menclose>
</mrow>
</mfrac>
<menclose notation="downdiagonalstrike">
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</menclose><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<mfrac>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<menclose notation="updiagonalstrike">
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</menclose>
</mrow>
</mfrac><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<menclose notation="updiagonalstrike"><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</menclose>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<menclose notation="updiagonalstrike">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</menclose><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<menclose notation="updiagonalstrike">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</menclose>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> In this case, it is not possible to find a close-form solution, so we use iterative methods to approximate local minima. We are going to use gradient descent, which is one of the simplest approaches, but it is widely used.</div>
<h4 class="subsubsection" id="magicparlabel-1818"><span class="subsubsection_label">4.4.1</span> Gradient descent</h4>
<div class="standard" id="magicparlabel-1819">Gradient descent is a general numerical method to find local minima of a differentiable function <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>Z</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. The idea is to use the fact that the gradient of a vector function points in the direction of maximum growth, and the negative gradient points in the direction of maximum decrease. Therefore, if we 'follow' this direction, we should approach a minimum of the function, although it might not be the global minimum.</div>
<div class="standard" id="magicparlabel-1820">The approach works as follows. To approximate a local minimum of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>:</div>
<ol class="enumerate" id="magicparlabel-1821"><li class="enumerate_item">We start at a weight vector <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math> and set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> ∇ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Update the weight vector<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mi> γ </mi><mi> ∇ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Also update <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow></math>. The parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> γ </mi>
</mrow></math> is called learning rate, and it quantifies 'how much' we advance in the direction of the gradient. It has to be chosen beforehand and it is critical, since:

<ol class="enumerate" id="magicparlabel-1824"><li class="enumerate_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> γ </mi>
</mrow></math> is too big, we might jump over the minimum and the method might never converge.</li>
<li class="enumerate_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> γ </mi>
</mrow></math> is too small, the method might converge too slowly.</li>
</ol>
<div class="standard" id="magicparlabel-1826">Related to the learning rate is the importance of feature scaling, as the same learning rate impacts all features, so if they have different scales, the method might be good for some of them, but bad for others.</div>
</li><li class="enumerate_item">Repeat until convergence or maximum number of steps is reached.</li>
</ol>
<h4 class="subsubsection" id="magicparlabel-1828"><span class="subsubsection_label">4.4.2</span> Newton's algorithm</h4>
<div class="standard" id="magicparlabel-1829">Newton's algorithm<div class="foot"><span class="foot_label">7</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-1833">There is an infinite amount of Newton's algorithms haha, this is one of them :D</div>
</div></div> is an algorithm used to find roots of a function which converges faster than gradient descent and does not need a learning rate parameter. As this algorithm finds roots (i.e. zeros), we don't apply directly to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>F</mi>
</mrow></math>, but rather to its gradient. Thus, in this case, we need <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>F</mi>
</mrow></math> to be twice differentiable and to be able to afford computing its second derivatives, which can sometimes be costly.</div>
<div class="standard" id="magicparlabel-1834">In this case, the algorithm works as follows:</div>
<ol class="enumerate" id="magicparlabel-1835"><li class="enumerate_item">We start at a weight vector <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math> and set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Compute the Hessian of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>F</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>H</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi> ∇ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mi> ∂ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msubsup>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mi>…
      </mi>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> ∂ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mi>…
      </mi>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
<mtd>
<mi>⋱
      </mi>
</mtd>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mi> ∂ </mi>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
<mtd>
<mi>…
      </mi>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> ∂ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Update the weight vector<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>-</mo><mi>H</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mi> ∇ </mi><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> and set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Repeat until convergence or maximum number of steps is reached.</li>
</ol>
<div class="remark" id="magicparlabel-1839"><div class="remark_item"><span class="remark_label">Remark 4.1.</span>
Notice that:</div>
<ul class="itemize" id="magicparlabel-1840"><li class="itemize_item">The update rule is obtained by finding the minimum of the second order Taylor series of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>F</mi>
</mrow></math> around <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item">No learning rate is needed this time, but we need to compute the Hessian.</li>
</ul>
</div>
<h4 class="subsubsection_" id="magicparlabel-1842">Iterated Reweighted Least Squares (IRLS)</h4>
<div class="standard" id="magicparlabel-1843">When we apply Newton's method to the log-likelihood of the logistic regression, it is called the IRLS method. The gradient of the log-likelihood is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> ∇ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and the Hessian<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>H</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msubsup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup><mo>=</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>X</mi><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example" id="magicparlabel-1844"><div class="example_item"><span class="example_label">Example 4.5.</span>
Logistic regression example using MATLAB</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1881" style="text-align: center;"><img alt="image: 27_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_0.png" src="27_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_0.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1932" style="text-align: center;"><img alt="image: 28_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_1.png" src="28_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_1.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1964" style="text-align: center;"><img alt="image: 29_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_2.png" src="29_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_2.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2004" style="text-align: center;"><img alt="image: 30_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_3.png" src="30_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___logistic_regression_example_images_figure_3.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
</div>
<h4 class="subsubsection" id="magicparlabel-2105"><span class="subsubsection_label">4.4.3</span> Multi-class logistic regression</h4>
<div class="standard" id="magicparlabel-2106">The multi-class case, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>K</mi><mo>&gt;</mo><mn>2</mn>
</mrow>
</mrow></math>, is handled by having a separator <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>k</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow></math> for each class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>. In this case, instead of a Bernoulli distribution for the targets <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, we use a categorical distribution. Each target <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is represented with its one.hot encoding.</div>
<div class="standard" id="magicparlabel-2107">In this case, the likelihood function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>,</mo><mn>...</mn><mo>,</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>K</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msubsup>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow>
</msubsup><mo>,</mo>
</mrow>
</mrow></math> and the <b>cross-entropy los</b>s is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>,</mo><mn>...</mn><mo>,</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>K</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo> log </mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> As in the binary case, we optimize this by using gradient descent or Newton's method.</div>
<h4 class="subsubsection" id="magicparlabel-2108"><span class="subsubsection_label">4.4.4</span> Regularization</h4>
<div class="standard" id="magicparlabel-2109">Finally, note that we can add regularization to the weights, in the same way we did for linear regression, by adding the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mn>1</mn>
</mrow>
</mrow></math> or <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mn>2</mn>
</mrow>
</mrow></math> norms of the weights to the cross-entropy loss<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow>
<mrow><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>o</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> log </mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi> λ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>,</mo>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow>
<mrow><mi>r</mi><mi>i</mi><mi>d</mi><mi>g</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> log </mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow>
<mover>
<mrow><mi>y</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi> λ </mi>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mn>.</mn>
</mrow>
</mrow></math> Note that this is for the binary case, but for the general case is similar.</div>
<div class="standard" id="magicparlabel-2110"><br/>
</div>
<h2 class="section" id="magicparlabel-2111"><span class="section_label">5</span> Nearest Neighbor Prediction</h2>
<div class="standard" id="magicparlabel-2112">The <b>nearest neighbor predictor</b> uses the local neighborhood of an input point to compute a prediction. A well known family of this kind is the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mi>N</mi><mi>N</mi>
</mrow>
</mrow></math> models, which predicts the output of the input point by combining the known outputs of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> nearest training data points, for example by voting if we are classifying the data.</div>
<div class="standard" id="magicparlabel-2113">The approach of these method is quite straightforward, and is detailed in Algorithm <a href="#alg_kNN_Pseudocode_">7</a>.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">Training
	Store all training examples

Prediction
	Given an input X:
		1. Compute distance/similarity with all examples in the training set.
		2. Locate &lt;@$k$@&gt; closest points.
		3. Emit prediction by combining outputs of the &lt;@$k$@&gt; closest points.</pre></div>
<div class="plain_layout" id="magicparlabel-2130"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 7:  <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mi>N</mi><mi>N</mi>
</mrow>
</mrow></math> Pseudocode.<a id="alg_kNN_Pseudocode_"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-2135">Of course, we have to decide:</div>
<ul class="itemize" id="magicparlabel-2136"><li class="itemize_item">The distance/similarity function.</li>
<li class="itemize_item">How many neighbors to choose, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</li>
<li class="itemize_item">How to combine the outputs of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> nearest neighbors to emit the final prediction.</li>
</ul>
<h3 class="subsection" id="magicparlabel-2139"><span class="subsection_label">5.1</span> Locality: similarities and distances</h3>
<div class="standard" id="magicparlabel-2140">It is important to decide what distance or similarity between points means in our feature space, since this will determine the neighborhoods of the points.</div>
<div class="definition" id="magicparlabel-2146"><div class="definition_item"><span class="definition_label">Definition 5.1.</span>
A <b>distance function</b> is a function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo> × </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo> → </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo>,</mo>
</mrow>
</mrow></math> verifying:</div>
<ol class="enumerate" id="magicparlabel-2147"><li class="enumerate_item">Non-negativity: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≥ </mo><mn>0</mn><mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Zero distance is equal: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn><mo> ⟺ </mo><mi>a</mi><mo>=</mo><mi>b</mi><mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Symmetric: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>b</mi><mo>,</mo><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Triangle inequality: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≤ </mo><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>c</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
</ol>
<div class="definition_item">A <b>similarity function</b> is a function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo> × </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mo> → </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo>,</mo>
</mrow>
</mrow></math></div>
<div class="definition_item">verifying:</div>
<ol class="enumerate" id="magicparlabel-2153"><li class="enumerate_item">Ranged: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> or <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Completely similar is equal: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo> ⟺ </mo><mi>a</mi><mo>=</mo><mi>b</mi><mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item">Symmetry: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>b</mi><mo>,</mo><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi> ∀ </mi><mi>a</mi><mo>,</mo><mi>b</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
</ol>
</div>
<div class="example" id="magicparlabel-2161"><div class="example_item"><span class="example_label">Example 5.1.</span>
Some examples of distances are:</div>
<ul class="itemize" id="magicparlabel-2162"><li class="itemize_item">The <b>Minkownski distance</b> family:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>a</mi><mo>-</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>p</mi>
</mrow>
</mfrac>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> Which has as special cases the Euclidean distance (<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>) or the Manhattan distance (<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>).</li>
<li class="itemize_item">The <b>Mahalanobis distance</b> is an interesting distance between points that takes into account the covariance matrix of the features, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> Σ </mo>
</mrow></math>. Its formula is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>-</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
<msup>
<mrow><mo> Σ </mo>
</mrow>
<mrow>
<mrow><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>-</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> which might already be familiar to you, since we have used it for some probabilistic methods.</li>
</ul>
<div class="example_item">Some examples of similarities are:</div>
<ul class="itemize" id="magicparlabel-2165"><li class="itemize_item">The <b>cosine similarity</b> function:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>a</mi><mo> ⋅ </mo><mi>b</mi>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi>a</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi>b</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>=</mo><mo> cos </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> ∠ </mi><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> which leverages the dot product, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mo> ⋅ </mo><mi>b</mi><mo>=</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>b</mi><mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi>a</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mi>b</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo> cos </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> ∠ </mi><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. Therefore, this captures 'how parallel' <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>a</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>b</mi>
</mrow></math> are.</li>
<li class="itemize_item">The <b>Pearson correlation measure</b> is similar to cosine similarity, but centers data:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>b</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>a</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>b</mi><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> is the mean of the points.</li>
<li class="itemize_item">The <b>Hamming distance</b> is computed between two sequences of bits, and it is just the proportion of common bits.</li>
<li class="itemize_item">The <b>Jaccard coefficient</b> is also computed between two sequences of bits, and it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>|</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math>
<div class="standard" id="magicparlabel-2169">If we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>10010000110000</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi>b</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>11000001100001</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow>
<mrow><mi>H</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>i</mi><mi>n</mi><mi>g</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo>=</mo><mn>0.643</mn><mo>,</mo>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow>
<mrow><mi>J</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac><mo>=</mo><mn>0.286.</mn>
</mrow>
</mrow></math></div>
</li></ul>
</div>
<h3 class="subsection" id="magicparlabel-2170"><span class="subsection_label">5.2</span> Choosing <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math></h3>
<div class="standard" id="magicparlabel-2171">Nearest neighbor methods are very sensitive to the chosen value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. If it is too low, it is easy to overfit; if it is too large, we can underfit. Therefore, we need to choose it thoughfully. This will depend on the dataset, and the typical approach is to use cross-validation, or other resampling methods, seeing <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> as an hyperparamter that trades-off bias and variance of the resulting model.</div>
<h3 class="subsection" id="magicparlabel-2172"><span class="subsection_label">5.3</span> How to combine outputs to make predictions</h3>
<h4 class="subsubsection" id="magicparlabel-2173"><span class="subsubsection_label">5.3.1</span> Classification</h4>
<ul class="itemize" id="magicparlabel-2174"><li class="itemize_item">Majority vote, broking ties randomly.</li>
<li class="itemize_item">Distance-weighted vote: a more advanced approach that weights the votes higher for closer points and lower for further points.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-2176"><span class="subsubsection_label">5.3.2</span> For regression</h4>
<ul class="itemize" id="magicparlabel-2177"><li class="itemize_item">Use the average of the outputs of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> nearest neighbors.</li>
<li class="itemize_item">Use the weighted average of the outputs of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> nearest neighbors. Again, the weights should be inversely proportional to distance or proportional to similarity.</li>
</ul>
<div class="standard" id="magicparlabel-2179">When we weight the predictions, we can relax the constraint of using only <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> examples, and we can even use the whole training set for making predictions, since this approach lowers the chances of underfitting.</div>
<h3 class="subsection" id="magicparlabel-2180"><span class="subsection_label">5.4</span> Decision boundaries for nearest neighbors classifier</h3>
<div class="standard" id="magicparlabel-2181">In 1-nearest neighbor, the decision regions correspond the union of each example's Voronoi cell, with appropriate class. Given a set of points <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ∈ </mo><mi>I</mi>
</mrow>
</mrow>
</msub><mo> ⊂ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math>, the Voronoi cell of point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> corresponds to the set of points whose nearest neighbor is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>. For example, here I show two different Voronoi diagrams, which show the Voronoi diagram of 6 different points:</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2186" style="text-align: center;"><img alt="image: 31_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado19.png" src="31_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado19.png" style="width:60%;"/>
<img alt="image: 32_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado20.png" src="32_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado20.png" style="width:60%;"/>
</div>
<div class="plain_layout" id="magicparlabel-2187"><span class="float-caption-Standard float-caption float-caption-standard">Figure 13:  Voronoi diagrams. Code in MATLAB script <span style="font-family:monospace;">voronoi.mlx</span>.</span></div>
</div>
<div class="standard" id="magicparlabel-2192">The decision boundaries and regions are non-linear, but they get smoother as we increase the value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. This effect can be observed in the following Figure:</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2197" style="text-align: center;"><img alt="image: 33_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado28.png" src="33_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado28.png" style="width:60%;"/>
<img alt="image: 34_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado22.png" src="34_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado22.png" style="width:60%;"/>
<img alt="image: 35_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado27.png" src="35_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado27.png" style="width:60%;"/>
</div>
<div class="plain_layout" id="magicparlabel-2198" style="text-align: center;"><img alt="image: 36_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado26.png" src="36_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado26.png" style="width:60%;"/>
<img alt="image: 37_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado25.png" src="37_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_pegado25.png" style="width:60%;"/>
</div>
<div class="plain_layout" id="magicparlabel-2199"><span class="float-caption-Standard float-caption float-caption-standard">Figure 14:  kNN decision regions for different values of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</span></div>
</div>
<h3 class="subsection" id="magicparlabel-2204"><span class="subsection_label">5.5</span> Final considerations</h3>
<ul class="itemize" id="magicparlabel-2205"><li class="itemize_item">Making predictions can be slow, specially if the training dataset is large. To improve the prediction speed, there are several approaches:

<ul class="itemize" id="magicparlabel-2206"><li class="itemize_item">Use data structures like <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mi>d</mi><mo>-</mo><mi>t</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow></math> to speed up neighbor retrieval, although this is only good when we have a moderate amount of features. A <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
</mrow></math>, or k-dimensional tree, is a binary search tree data structure used to organize points in k-dimensional space. In the context of kNN models, kd-trees can help speed up neighbor retrieval by partitioning the space and reducing the search area for nearest neighbors. However, the efficiency gain of kd-trees is reduced when there are many features (i.e., high-dimensional data), as the search time approaches that of a linear search.</li>
<li class="itemize_item">Use prototypes. A protoype is a representative point or a summary of a group of points that belong to the same class. Using prototypes can reduce the size of the training dataset while still maintaining its overall structure. The idea is to replace multiple points with a single prototype, thus reducing the number of distance calculations during prediction. Examples of prototype selection methods include the nearest neighbor condensation algorithm and the edited nearest neighbor rule.</li>
<li class="itemize_item">Use approximate neighbors, for example using locality sensitive hashing. The main idea behind LSH is to hash the input items in such a way that similar items are more likely to be hashed to the same bucket. By doing this, it reduces the search space for nearest neighbors and allows for faster retrieval. LSH trades off some accuracy for improved speed, making it suitable for large-scale applications where an approximate answer is acceptable.</li>
</ul>
</li><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mi>N</mi><mi>N</mi>
</mrow>
</mrow></math> is prone to overfitting. To avoid this, usual approaches include:

<ul class="itemize" id="magicparlabel-2210"><li class="itemize_item">Remove noisy examples from the training data, for example, data points with neierst neighbors of different class.</li>
<li class="itemize_item">Again, use prototypes.</li>
<li class="itemize_item">Set the appropriate value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</li>
</ul>
</li><li class="itemize_item">It suffers from the curse of dimensionality: as dimension increases, everything seems to be close.</li>
<li class="itemize_item">Suffers from the presence of irrelevant features, so feature selection is an important pre-processing step.</li>
<li class="itemize_item">Standardization of features is crucial to avoid domination of features with larger values.</li>
</ul>
<div class="standard" id="magicparlabel-2216"><br/>
</div>
<h2 class="section" id="magicparlabel-2217"><span class="section_label">6</span> Trees and Random Forests</h2>
<div class="standard" id="magicparlabel-2218">An <b>ensemble method</b> is a method that combines two or more predictors, instead of using a single prediction. These are useful when we have several models that are better that just a random guess, and that are independent between them. The combination of the models can be done averaging predictions, when in regression, or by majority vote in classification.</div>
<div class="standard" id="magicparlabel-2219">The main types of ensemble methods are:</div>
<ul class="itemize" id="magicparlabel-2220"><li class="itemize_item">Stacking: involves training a learning algorithm to combine the predictions of several other learning algorithms. First, all sub-models are trained based on the complete training set, then the meta-model is fitted based on the outputs — meta-features — of the sub-models in the ensemble. Therefore, stacking allows you to use multiple heterogeneous, possibly weak learning models and "stack" them together in a manner that allows you to use information from their predictions to make a final prediction which often has better performance.</li>
<li class="itemize_item">Bagging: is a way to decrease the variance of the prediction by generating additional data for training from dataset using combinations with repetitions to produce multi-sets of the original data. Bagging helps to avoid overfitting by averaging or voting the prediction from the multiple models. Random Forest is a classic example of bagging algorithm.</li>
<li class="itemize_item">Boosting: is a sequential technique in which the first algorithm is trained on the entire data set, and the following algorithms are built by fitting the residuals of the first algorithm, thereby giving higher weight to those observations that were poorly predicted by the previous model. It relies on creating a series of weak learners each of which might not be good at the entire problem, but might be good at recognizing some part of it, and then combining their predictions to get the final prediction. The idea is to add new models to the ensemble sequentially. At each particular iteration, a new weak, base-learner model is trained with respect to the error of the whole ensemble learnt so far. Gradient Boosting, AdaBoost and XGBoost are examples of boosting algorithms.</li>
</ul>
<h3 class="subsection" id="magicparlabel-2223"><span class="subsection_label">6.1</span> Trees</h3>
<div class="standard" id="magicparlabel-2224">A regression tree partitions the feature space into axis-parallel regions and predicts using the average of training points that fall into that region. We can think of a tree in terms of nodes and edges: each node in the tree specifies a test of some attribute, and each edge descending from that node corresponds to one of the possible outcomes for the test. The leaf nodes (or terminal nodes) of the tree contain an output value which is used to make a prediction. When a new data point is presented to the tree for prediction, it is routed down the tree based on the outcome of the tests in each node, starting from the root and ending at a leaf node. The value in the leaf node is then returned as the prediction.</div>
<div class="standard" id="magicparlabel-2225">A classification tree also partitions the feature space into axis-parallel regions, each of them representing a class. It is NP-hard to find the optimal tree of minimum size, so greedy approaches are usually used. A general approach is explained in Algorithm <a href="#alg_Training_a_Tree_">8</a>.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">1- Feature selection
	Find the feature that best splits the data into two subsets, minimizing a impurity function.

2- Binary splitting
	Decide how to split the feature. If it is categorical, split in each possible value. If it is continuous, find a value that divides it in two, minimizing the impurity.

3- Recursion
	Repeat 1- and 2- until the stopping criterion is met.

4- Pruning
	To avoid overfitting.</pre></div>
<div class="plain_layout" id="magicparlabel-2245"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 8:  <a id="alg_Training_a_Tree_"></a>
Training a Tree.</span></div>
</div>
<div class="standard" id="magicparlabel-2251">We are going to use the Gini impurity metric to create trees. </div>
<div class="standard" id="magicparlabel-2252">Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> be a subset of example of the input data <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mo> ⊂ </mo><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
</mrow>
</mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>Y</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>=</mo><mi>K</mi><mo> ≥ </mo><mn>2</mn>
</mrow>
</mrow></math>. Let also <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> be the proportion of examples in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> that belongs to class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. Then, the Gini impurity metric is computed as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2253">Therefore, to find the node to expand the tree, we need to find the pair <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>v</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup><mo>,</mo>
<msup>
<mrow><mi>s</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>v</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup>
</mrow></math> is a feature and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>s</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup><mo> ∈ </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
</mrow></math>, such that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>v</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup><mo>,</mo>
<msup>
<mrow><mi>s</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow>
<mrow><mi>v</mi><mo>,</mo><mi>s</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>v</mi><mo> ≤ </mo><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>v</mi><mo> ≤ </mo><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>v</mi><mo>&gt;</mo><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>v</mi><mo>&gt;</mo><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2254">In the case of a regression tree, the approach is similar, but instead we minimize the sum of squared errors, relative to the average target value in each induced partition. In other words, we now seek for the pair <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>v</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup><mo>,</mo>
<msup>
<mrow><mi>s</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> such that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>v</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup><mo>,</mo>
<msup>
<mrow><mi>s</mi>
</mrow>
<mrow><mo>*</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow>
<mrow><mi>v</mi><mo>,</mo><mi>s</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>S</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>v</mi><mo> ≤ </mo><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>S</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>v</mi><mo>&gt;</mo><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>|</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo><mi>S</mi>
</mrow>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>a</mi><mi>v</mi><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example" id="magicparlabel-2255"><div class="example_item"><span class="example_label">Example 6.1.</span>
Classification trees in MATLAB</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2269" style="text-align: center;"><img alt="image: 38_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___cripts_classification_trees_images_figure_0.png" src="38_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___cripts_classification_trees_images_figure_0.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2357" style="text-align: center;"><img alt="image: 39_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___cripts_classification_trees_images_figure_1.png" src="39_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___cripts_classification_trees_images_figure_1.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2380" style="text-align: center;"><img alt="image: 40_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___cripts_classification_trees_images_figure_2.png" src="40_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___cripts_classification_trees_images_figure_2.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
</div>
<h3 class="subsection" id="magicparlabel-2458"><span class="subsection_label">6.2</span> Random Forests</h3>
<div class="standard" id="magicparlabel-2459">Let's deepen a bit in the bagging technique, which we said it can be used to reduce the variance of our estimates by averaging the estimates obtained from independent models. Assume we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> models <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>b</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>B</mi>
</mrow>
</msubsup>
</mrow></math>, and an input <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>. Each model produces an estimate<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> which tries to predict the real value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math>. Let's suppose these estimates are unbiased, i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>y</mi><mo>,</mo><mi> ∀ </mi><mi>b</mi>
</mrow>
</mrow></math>. Then, the average of the estimates is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>B</mi>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>B</mi>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>B</mi>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mi>y</mi><mo>=</mo><mi>y</mi><mn>.</mn>
</mrow>
</mrow></math>Therefore, this average is also an unbiased estimate of the value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math>. Let's see what happens with the variance when we perform this average. If we assume that the models are independent and that they all have the same variance, then it follows<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>B</mi>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>B</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>B</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>B</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow><mi>B</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Thus, the variance is reduced, making the predictions more consistent. </div>
<div class="standard" id="magicparlabel-2460">Since trees typically suffer from high variance (overfitting), so they seem like a good candidate to apply this technique. The application of bagging to trees are the <b>random forests</b>.</div>
<div class="standard" id="magicparlabel-2461">First, a bootstrapped dataset is created by randomly selecting samples from the original dataset with repetition. The samples that not chosen for the bootstrapped dataset are placed in a separate dataset, the out-of-bag dataset (OOB).</div>
<div class="standard" id="magicparlabel-2462">Then, we want to generate a diverse collection of trees that are better than a random choice, and are as independent from each other as possible. If we construct all these trees using the usual algorithm, then they will be very similar, so we have to inject stochasticity into this process. This is done by:</div>
<ul class="itemize" id="magicparlabel-2463"><li class="itemize_item">The sampling introduces stochasticity, but it is usually not enough to provide independence between the trees.</li>
<li class="itemize_item">We can manipulate features or targets, by not taking some of them into account. This is done for each tree, so that different trees focus on different features, providing the independence that we seek.</li>
<li class="itemize_item">Change the learning parameters, the impurity function,...</li>
<li class="itemize_item">Performing combinations of the above methods.</li>
</ul>
<div class="standard" id="magicparlabel-2467">The pseudocode of the random forest training algorithm is shown in Algorithm <a href="#alg_random_forest_D_n_estimators_max">9</a>.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">for b=1 to n_estimators do
	Sample &lt;@$D_b$@&gt; as a bootstrap of max_samples from D
	
	Create tree &lt;@$T_b$@&gt; on &lt;@$D_b$@&gt;, adding nodes by
		- Select max_features variables at random from all variables
		- Pick the best variable/split point according to Gini/SSE
		- Split the current node according to the split found
end

Output forest &lt;@$\{T_1,...,T_B\}$@&gt;</pre></div>
<div class="plain_layout" id="magicparlabel-2486"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 9:  <a id="alg_random_forest_D_n_estimators_max"></a>
random_forest(D,n_estimators,max_samples,max_features)</span></div>
</div>
<div class="standard" id="magicparlabel-2491">To make predictions on a test example <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>:</div>
<ul class="itemize" id="magicparlabel-2492"><li class="itemize_item">For classification: output class probabilities or majority vote among <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>B</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>.</li>
<li class="itemize_item">For regression: output average prediction <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>B</mi>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>b</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-2494">Then, to estimate the generalization error, we can use the OOB dataset to compute the <b>OOB error</b>. This generalization error can be used as a validation error to select appropriate values for the hyperparameters, so we don't need to perform cross-validation.</div>
<h4 class="subsubsection" id="magicparlabel-2495"><span class="subsubsection_label">6.2.1</span> Interpretability of random forests</h4>
<div class="standard" id="magicparlabel-2496">If n_estimators is too big (there are many trees in the forest), then it can be difficult to comprehend the decision process of the model: it is not interpretable. We can do variable importance plot to interpret better the results:</div>
<ul class="itemize" id="magicparlabel-2497"><li class="itemize_item">Gini based variable importance: we can add gini impurity gains for variables in the splits in each tree in the forest, and sort the variables by their sum. This approach is biased towards categorical variables with many splits.</li>
<li class="itemize_item">Permutation based variable importance: for each variable, we can permmute values and compute the difference in the OOB error metrics. If a variable is important, then accuracy in the permuted copy should decrease. We then sort the variables using this difference. This approach is more reliable, but is slower.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-2499"><span class="subsubsection_label">6.2.2</span> Proximities</h4>
<div class="standard" id="magicparlabel-2500">The idea of proximity of samples in a tree is that when two examples fall into the same leaf of a decision tree, this is evidence supporting the fact that these two examples are similar in some sense.</div>
<div class="standard" id="magicparlabel-2501">In the wider sense of forests, we can build a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo> × </mo><mi>n</mi>
</mrow>
</mrow></math> similarity matrix, where each entry <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>i</mi><mo>,</mo><mi>j</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> correspond to the fraction of trees in the forest such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow></math> end up in the same leaf. This matrix can be used in distance/similarity based methods, or to apply PCA to obtain numeric representation of the data.</div>
<h4 class="subsubsection" id="magicparlabel-2502"><span class="subsubsection_label">6.2.3</span> Imbalanced data in classification</h4>
<div class="standard" id="magicparlabel-2503">In random forest, there are several techniques to deal with imbalaced data:</div>
<ul class="itemize" id="magicparlabel-2504"><li class="itemize_item">Use <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo>-</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi>
</mrow>
</mrow></math> for model selection.</li>
<li class="itemize_item">Under-sampling majority class/over-sampling minority class when building the bootstrapped dataset.</li>
<li class="itemize_item">Use of weights when computing errors.</li>
</ul>
<div class="standard" id="magicparlabel-2507"><br/>
</div>
<h2 class="section" id="magicparlabel-2508"><span class="section_label">7</span> Multi-Layer Perceptron (Neural Networks)</h2>
<div class="standard" id="magicparlabel-2509">In Section <a href="#subsec_Perceptron_and_Logistic">4.4</a> we have seen the Perceptron, a mathematical model of a neuron that can be used in binary classification. We noted that this model is equivalent to a linear classifier, being thus a very limited model for a more general scenario. In this section, we are going to see how to extend this model to perform more complex tasks.</div>
<h3 class="subsection" id="magicparlabel-2510"><span class="subsection_label">7.1</span> Multiclass classification</h3>
<div class="standard" id="magicparlabel-2511">We saw how to use a single perceptron to perform binary classification, and there is a very natural way to extend this model to multi-class classification, using a one-hot encoding for the class.</div>
<div class="standard" id="magicparlabel-2512">For instance, let's work with a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo> ∈ </mo><mi>L</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>. We now encode <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math> as a one-hot vector, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>0</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>y</mi><mo> ≠ </mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>y</mi><mo>=</mo>
<msub>
<mrow><mi>l</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
</mtable><mo>,</mo>
</mrow>
</mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>. The idea is then to use <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> perceptrons, each of them focusing on predicting one of the classes and trained independently. The idea is depicted in Figure <a href="#fig_Multi_class_classification_with">15</a>. Notice that in this case is almost compulsory to use the logistic function (or a similar function, but definitely not the step function), since this way we can interpret the values as probabilities, and therefore select the value with highest probability as our prediction. Also, remember than in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> we are adding an artifical 1 to account for the bias.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2517" style="text-align: center;"><img alt="image: 41_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_1.png" src="41_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_1.png" style="width:40%;"/>
</div>
<div class="plain_layout" id="magicparlabel-2518"><span class="float-caption-Standard float-caption float-caption-standard">Figure 15:  Multi-class classification with perceptrons.<a id="fig_Multi_class_classification_with"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-2523">Let's formalize this idea a little bit. We have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> independent perceptrons, each of them predicting a variable, so that if we call <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>g</mi>
</mrow></math> our activation function, we obtain, for each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
</mrow></math>,<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msubsup><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> is the weight vector of perceptron <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. We can integrate all this into a single formula by introducing the notation <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo> ⋅ </mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, which applies <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>f</mi>
</mrow></math> to each component of the input vector:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>⋮
      </mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mn>.</mn>
</mrow>
</mrow></math> This way, we can unify the previous equations as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
</mrow>
</mrow></math> where we have arranged<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>W</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd><mo>|</mo>
</mtd>
<mtd><mrow></mrow>
</mtd>
<mtd><mo>|</mo>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mtd>
<mtd><mn>...</mn>
</mtd>
<mtd>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mtd>
</mtr>
<mtr>
<mtd><mo>|</mo>
</mtd>
<mtd><mrow></mrow>
</mtd>
<mtd><mo>|</mo>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mn>.</mn>
</mrow>
</mrow></math> Now, we can define what is a layer. A <b>layer</b> is just a set of parallel neurons and a layer with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>M</mi>
</mrow></math> neurons outputs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>M</mi>
</mrow></math> variables. Usually, all neurons in a layer use the same activation function, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>g</mi>
</mrow></math>. Note that if this is not the case, then our previous explanations needs to be slightly adapted.</div>
<div class="standard" id="magicparlabel-2524">Since we have discussed that a good alternative in multiclass classification is to use the sigmoid function as activation function, we can rewrite our model as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>y</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math> Note, nonetheless, that here we are obtaining a bunch of different probabilities, one for each class, which could be further used to increase the information about our prediction. For instance, instead of computing the maximum out of these independent probabilities, we can add a <b>softmax function</b> to the outputs, resulting in a normalized vector that can now be considered as a probability vector. The softmax function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>z</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>'</mo>
</mrow>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2525">Also, at doing this, it is not necessary to apply the activation function, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>g</mi>
</mrow></math>, beforehand. This approach is shown in Figure <a href="#fig_Multi_class_classification_with_1">16</a>. </div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2530" style="text-align: center;"><img alt="image: 42_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_2.png" src="42_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_2.png" style="width:40%;"/>
</div>
<div class="plain_layout" id="magicparlabel-2531"><span class="float-caption-Standard float-caption float-caption-standard">Figure 16:  Multi-class classification with perceptrons and softmax.<a id="fig_Multi_class_classification_with_1"></a>
</span></div>
</div>
<div class="standard" id="magicparlabel-2536">Note that we are still in the linear classification scenario, and the next step is to improve the flexibility of the model to be able to cope with more complex relationships.</div>
<h3 class="subsection" id="magicparlabel-2537"><span class="subsection_label">7.2</span> Multi-Layer Perceptron</h3>
<div class="standard" id="magicparlabel-2538">Notice now an interesting fact: if our activation function is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo>:</mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo> → </mo><mi>I</mi>
</mrow>
</mrow></math>, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math> is the range of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>g</mi>
</mrow></math>, then a layer with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>M</mi>
</mrow></math> perceptrons can be interpreted as a function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow><mi>I</mi>
</mrow>
<mrow><mi>M</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math>For the sake of simplicity, let's say <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>M</mi>
</mrow>
</msup>
</mrow>
</mrow></math>. Then, it is natural to think on stacking different layers, so that the output of a layers becomes the input of the following, effectively performing the composition of the functions defined by these layers. For example, if we have two layers, which we interpret as two functions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>G</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>G</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
</mrow></math>, we can take the output of the first layer and use it as input for the second one, effectively obtaining<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>G</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo> ○ </mo>
<msup>
<mrow><mi>G</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> This is interesting mainly because a single layer, as we have seen, is only able to perform linear classification, but let's deep a bit more on what is happening on the second layer. The second layer is using an activation function <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>g</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>:</mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo> → </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
</mrow></math>, which is applied in each perceptron of the second layer as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msubsup><mo> ⋅ </mo>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msubsup><mo> ⋅ </mo>
<msup>
<mrow><mi>g</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup><mo> ⋅ </mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This means that we are:</div>
<ul class="itemize" id="magicparlabel-2539"><li class="itemize_item">Creating <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> combinations of the input variables, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup><mo> ⋅ </mo><mi>x</mi>
</mrow>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo> ∈ </mo>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>M</mi>
</mstyle>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math> (the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>+</mo><mn>1</mn>
</mrow>
</mrow></math> is to account for the bias).</li>
<li class="itemize_item">Applying a different transformation <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msubsup>
</mrow></math> to each combination of variables. Note that this transformation can be arbitrary, but should be non-linear if we want to go out of the linear world, and should be differentiable if we want a smooth training process.</li>
<li class="itemize_item">For the second layer, the inputs are the transformations of the combinations of the input variables, which effectively become a base of functions (just as polynomials are), which are combined again by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msubsup>
</mrow></math>.</li>
<li class="itemize_item">Finally, we apply <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msubsup>
</mrow></math>, which will be again an activation function.</li>
</ul>
<div class="standard" id="magicparlabel-2543">The key steps for going beyond linearity are the second and third. Let's compare it to a normal linear regression. In that case, we introduced basis functions to be able to go out of the linearity world, by transforming the input variables. But then, we used still linear regression over this transformation. Therefore, it was the modification of the input what allowed us to model non-linear relationship, and not the algorithm itself, which was not changed at all. Here, the idea is similar. In fact, we could just perform the same transformations that we used to in this new case, and keep applying just one layer of perceptrons to obtain non-linear classifiers. But this is exactly the power of the multi-layer perceptron: we don't need to assume or guess the shape of the basis function! The different weights of the different layers will adapt to our problem, effectively auto-selecting how these functions should be. Of course, this is not free, and the cost is paid by obtaining harder trainings.</div>
<div class="standard" id="magicparlabel-2544">After this explanation, we can first integrate the previous formula as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>y</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi>g</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi>g</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math> We can also define the <b>multi-layer perceptron</b> as composition of layers of perceptrons, with the addition of what is called the <b>input layer</b>, which is not really a layer of perceptrons, but rather represents and fixes the size of the input, and the <b>output layer</b>, which is the final layer, outputing the predictions of the model. The rest of the layers, the real perceptron layers, are called <b>hidden layers</b>. This is depicted in Figure <a href="#fig_A_Multi_Layer_Perceptron_">17</a>. In this case, the first layer has <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> perceptrons, the second one has <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> perceptrons, and the output layers has as many perceptrons as possible labels, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2549" style="text-align: center;"><img alt="image: 43_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_3.png" src="43_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_3.png" style="width:40%;"/>
<span class="float-caption-Standard float-caption float-caption-standard">Figure 17:  A Multi-Layer Perceptron.<a id="fig_A_Multi_Layer_Perceptron_"></a>
</span></div>
</div>
<div class="remark" id="magicparlabel-2554"><div class="remark_item"><span class="remark_label">Remark 7.1.</span>
Observe that we have connected all outputs of each layer to all perceptrons in the second layer, also, note that two neurons within the same layer do not connect. These are just decisions and is not compulsory, and many different architectures exist.</div>
</div>
<div class="standard" id="magicparlabel-2555">More generally, a <b>neural network</b> is a directed graph whose nodes are perceptrons. If there are no cycles within the network, then it is a <b>feed-forward neural network</b> <b>(FFNN)</b>, and it is called a <b>recurrent network (RNN)</b> in the case of cycles existing within the network.</div>
<div class="standard" id="magicparlabel-2556">MLP are thus a special case of feed-forward neural network, in which:</div>
<ul class="itemize" id="magicparlabel-2557"><li class="itemize_item">Neurons are arranged in layers.</li>
<li class="itemize_item">There is at least one hidden layer.</li>
<li class="itemize_item">Every layer is fully connected to the next one.</li>
<li class="itemize_item">No connections are allowed within layers.</li>
</ul>
<div class="standard" id="magicparlabel-2561">A brief visualization on different kinds of networks is depicted in Figure <a href="#fig_Different_kinds_of">18</a>.</div>
<div class="float-figure"><div class="float-figure"><div class="plain_layout" id="magicparlabel-2570" style="text-align: center;"><img alt="image: 43_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_3.png" src="43_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_3.png" style="width:25%;"/>
<span class="float-caption-Standard float-caption float-caption-standard">Sub-Figure a:  MLP.</span></div>
</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2580" style="text-align: center;"><img alt="image: 44_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_4.png" src="44_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_4.png" style="width:25%;"/>
<span class="float-caption-Standard float-caption float-caption-standard">Sub-Figure b:  FFNN not MLP.</span></div>
</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-2589" style="text-align: center;"><img alt="image: 45_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_5.png" src="45_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_mlp_5.png" style="width:25%;"/>
</div>
<div class="plain_layout" id="magicparlabel-2590"><span class="float-caption-Standard float-caption float-caption-standard">Sub-Figure c:  RNN.</span></div>
</div>
<div class="plain_layout" id="magicparlabel-2596"><span class="float-caption-Standard float-caption float-caption-standard">Figure 18:  Different kinds of NN.<a id="fig_Different_kinds_of"></a>
</span></div>
</div>
<h3 class="subsection" id="magicparlabel-2601"><span class="subsection_label">7.3</span> Error functions</h3>
<h4 class="subsubsection" id="magicparlabel-2602"><span class="subsubsection_label">7.3.1</span> Regression</h4>
<div class="standard" id="magicparlabel-2603">The error in the regression case can be the empirical mean square error, i.e.,<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> where the dataset is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the prediction of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> with the weight matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>W</mi>
</mrow></math>. Note that in this formula we are assuming a single output, but it can be easily generalized as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> As usual, our objective will be to minimize this error.</div>
<h4 class="subsubsection" id="magicparlabel-2604"><span class="subsubsection_label">7.3.2</span> Binary classification</h4>
<div class="standard" id="magicparlabel-2605">If the target values are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, then we can express<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>|</mo><mi>x</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>y</mi>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo><mi>y</mi>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> If we assume independent and identically distributed examples, then we can define our likelihood function as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> and the negative log-likelihood defines the <b>cross-entropy error</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mstyle mathvariant="normal">
<mrow><mo>-</mo>
<mstyle class="math">
<mrow><mo> log </mo>
<mstyle mathvariant="script"><mi>L</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>W</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mstyle>
</mrow>
</mstyle>
</mrow>
</mrow></math></div>
<h4 class="subsubsection" id="magicparlabel-2606"><span class="subsubsection_label">7.3.3</span> Multi-class classification</h4>
<div class="standard" id="magicparlabel-2607">The last error formula can be generalized for multi-class classification with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>K</mi><mo>&gt;</mo><mn>2</mn>
</mrow>
</mrow></math> classes, as the <b>generalized cross-entropy error</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>W</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>,</mo><mi>k</mi>
</mrow>
</mrow>
</msub><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow>
<mrow><mi>W</mi><mo>,</mo><mi>k</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<h3 class="subsection" id="magicparlabel-2608"><span class="subsection_label">7.4</span> Training the MLP: Backprogragation</h3>
<div class="standard" id="magicparlabel-2609">Notice that the error functions that we have defined can be very complex, and there is no closed form solution to minimize them. Therefore, some iterative approach is necessary, as we did with the perceptron. But we encounter now a new problem: if we do gradient descent on the neural network, we will need to compute lots of gradients, and computing a gradient is not cheap. The idea to make this process more efficient is to use the chain rule and to notice that many of the gradients that we compute are actually used in many places along the network for the computation of the final gradient. Therefore, an improved version for computing gradients was developed: the <b>backpropagation algorithm</b>.</div>
<h4 class="subsubsection" id="magicparlabel-2610"><span class="subsubsection_label">7.4.1</span> The chain rule</h4>
<div class="standard" id="magicparlabel-2611">The chain rule<div class="foot"><span class="foot_label">8</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-2615">For more information you can just visit <a href="https://en.wikipedia.org/wiki/Chain_rule">Wikipedia</a>.</div>
</div></div> states that, given two composable differentiable functions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo>,</mo><mi>g</mi>
</mrow>
</mrow></math>, it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>f</mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>g</mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math>In the multivariate case, when we want to compute the derivative of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>f</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This is sometimes written by naming <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so that the formula becomes<div class="foot"><span class="foot_label">9</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-2619">Notice the abuse of notation though.</div>
</div></div><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi>d</mi><mi>z</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<mrow><mi>d</mi><mi>z</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> </div>
<div class="example" id="magicparlabel-2620"><div class="example_item"><span class="example_label">Example 7.1.</span>
Let's do an example to understand how this can be helpful in the case of neural networks.</div>
<div class="example_item">Imagine we have the functions:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mtd>
<mtd>
<mrow><mo>=</mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo> ⋅ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mtd>
<mtd>
<mrow><mo>=</mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msubsup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi>z</mi><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> and we want to compute the gradient of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>z</mi>
</mrow></math> in terms of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>. We can write this as a diagram:</div>
<div class="standard" id="magicparlabel-2622" style="text-align: center;"><img alt="image: 46_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_1.png" src="46_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_1.png" style="width:40%;"/>
</div>
<div class="example_item">We simply need to compute the gradient using the chain rule:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> ∇ </mi><mi>z</mi><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi>d</mi><mi>z</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd>
<mfrac>
<mrow>
<mrow><mi>d</mi><mi>z</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mrow><mn>2</mn>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup><mo>-</mo><mo> ⋅ </mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup><mo>-</mo><mn>3</mn>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mo>=</mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">(</mo>
<mtable>
<mtr>
<mtd>
<mrow><mn>2</mn>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</msup><mo>-</mo><mn>3</mn>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">)</mo><mn>.</mn>
</mrow>
</mrow></math> Basically, the idea is to be able to reuse as many values as possible (notice the coloured expressions). To do this, we can compute <b>local derivatives</b> in each layer, and <em>propagate</em> them back to the previous layer, multiplying them. The previous computation can be done in the diagram as follows:</div>
<div class="standard" id="magicparlabel-2624" style="text-align: center;"><img alt="image: 47_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_2.png" src="47_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_2.png" style="width:40%;"/>
</div>
</div>
<div class="standard" id="magicparlabel-2625">Note that:</div>
<ol class="enumerate" id="magicparlabel-2626"><li class="enumerate_item">We can avoid unnecessary computations by storing at each node:

<ol class="enumerate" id="magicparlabel-2627"><li class="enumerate_item">Forward values: when we evaluate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, we can keep this value stored in the node, because we will need it later. In this example we did symbolic differentiation, so this was not necessary, but in neural networks we need to first to the forward pass, and then assess the error.</li>
<li class="enumerate_item">Local derivatives: when we evaluate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
</mrow></math>, we can keep this value stored in the node, because we will use it several times.</li>
<li class="enumerate_item">Backwards gradients: local derivatives are sent to those nodes that will need them, so that each of this derivatives is computed only once. Then the gradient is constructed little by little, backwards, in a dynamic programming manner.</li>
</ol>
</li><li class="enumerate_item">When the gradients are flowing backwards, each node has to sum all incoming gradients, according to the multivariate chain rule (if there is only one incoming gradient, we just take that one).</li>
</ol>
<h4 class="subsubsection" id="magicparlabel-2631"><span class="subsubsection_label">7.4.2</span> The backpropagation algorithm</h4>
<div class="standard" id="magicparlabel-2632">The pseudocode for backpropagation is as in Algorithm <a href="#alg_Backpropagation_">10</a>. Let's break it down.</div>
<ul class="itemize" id="magicparlabel-2633"><li class="itemize_item"><span style="font-family:monospace;">a[layer]</span>=<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow></math> is the input vector for layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math>.</li>
<li class="itemize_item"><span style="font-family:monospace;">z[layer]</span>=<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow></math> is the output vector for layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math>, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>l</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>l</mi>
</mrow>
</msub>
</mrow></math> is the activation function of layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math> (note in the pseudocode we are assuming the same <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>g</mi>
</mrow></math> working on all layers).</li>
<li class="itemize_item"><span style="font-family:monospace;">W[layer]</span>=<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow></math> is the weight matrix of layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math>.</li>
<li class="itemize_item"><span style="font-family:monospace;">w[layer]</span>=<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi>W</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow></math> is the weight matrix of layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math>, without the weight of the bias.</li>
<li class="itemize_item">d[layer]=<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow></math> is the local gradient at layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math>, computed as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>-</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> for the output layer, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
</mrow></math> or <span style="font-family:monospace;">d[c+1]</span> in the pseudocode, and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mi>l</mi>
</mrow>
</msub><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi>W</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>l</mi><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> for the rest of the layers, i.e., the hidden layers. Here, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⊙ </mo>
</mrow></math> is the Hadamard product, i.e., the component-wise product. In the pseudocode, this is expressed by '<span style="font-family:monospace;">.*</span>'.</li>
</ul>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">1. Forward pass
	- for layer in {1...c+1}
		a[layer] = W[layer]^T * z[layer-1]
		z[layer] = g[a[layer]] # apply g[.] to each component of a[layer]

2. Backward pass
	- d[c+1] = dg[a[c+1]] .* (z[c+1]-y) # .* is the component-wise product and dg is the derivative of g
	- grad[c+1] = z[c]*d[c+1]^T
	- for layer in {c...1}
		d[layer] = dg[a[layer]] .* (w[layer+1]*d[layer+1]) # w[k] is W[k] without the bias weigth
		grad[layer] = z[layer-1]*d[layer]^T

return grad</pre></div>
<div class="plain_layout" id="magicparlabel-2659"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 10:  <a id="alg_Backpropagation_"></a>
Backpropagation.</span></div>
</div>
<div class="example" id="magicparlabel-2664"><div class="example_item"><span class="example_label">Example 7.2.</span>
Let's perform an example. Here is our neural network:</div>
<div class="standard" id="magicparlabel-2665" style="text-align: center;"><img alt="image: 48_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_3.png" src="48_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_3.png" style="width:40%;"/>
</div>
<div class="example_item">It is a fully connected two-layer network. Let's follow the algorithm, defining each of the variables at a time.</div>
<ol class="enumerate" id="magicparlabel-2667"><li class="enumerate_item"> We define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo><mi>x</mi><mo>,</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo><mi>z</mi><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> :
<div class="standard" id="magicparlabel-2672" style="text-align: center;"><img alt="image: 49_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_4.png" src="49_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_4.png" style="width:40%;"/>
</div>
</li><li class="enumerate_item">
<ol class="enumerate" id="magicparlabel-2678"><li class="enumerate_item"> Define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>-</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mi>r</mi><mi>a</mi>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup>
</mrow>
</mrow></math>:</li>
</ol>
<div class="standard" id="magicparlabel-2683" style="text-align: center;"><img alt="image: 50_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_5.png" src="50_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_5.png" style="width:40%;"/>
</div>
<ol class="enumerate" id="magicparlabel-2684"><li class="enumerate_item"> Define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi>W</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mi>u</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mi>r</mi><mi>a</mi>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup>
</mrow>
</mrow></math>:</li>
</ol>
<div class="standard" id="magicparlabel-2689" style="text-align: center;"><img alt="image: 51_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_6.png" src="51_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_6.png" style="width:40%;"/>
</div>
<ol class="enumerate" id="magicparlabel-2690"><li class="enumerate_item"> Define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msub>
<mrow><mi>g</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi>W</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>2</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mi>r</mi><mi>a</mi>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>0</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<msup>
<mrow><mi> δ </mi>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>T</mi>
</mrow>
</msup>
</mrow>
</msup>
</mrow>
</mrow></math>:</li>
</ol>
<div class="standard" id="magicparlabel-2695" style="text-align: center;"><img alt="image: 52_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_7.png" src="52_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_Machine_Learning_LectureNotes_source_backprop_7.png" style="width:40%;"/>
</div>
</li></ol>
<div class="example_item">And that's it! Now we can use the gradient at each layer to train the network, updating the weights in layer <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math> according to:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>W</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>-</mo><mi> γ </mi><mo> ⋅ </mo><mi>g</mi><mi>r</mi><mi>a</mi>
<msup>
<mrow><mi>d</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> γ </mi>
</mrow></math> is the learning rate.</div>
</div>
<h3 class="subsection" id="magicparlabel-2697"><span class="subsection_label">7.5</span> Some activation functions</h3>
<h4 class="subsubsection" id="magicparlabel-2698"><span class="subsubsection_label">7.5.1</span> Logistic</h4>
<div class="standard" id="magicparlabel-2699">The logistic function is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo>:</mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo> → </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, defined by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>+</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>x</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow></math> with derivative<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi> σ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> In this case, for the backpropagation algorithm, we use<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo> ⊙ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> which is a very efficient formula, since we have all this values computed in the forward pass.</div>
<h4 class="subsubsection" id="magicparlabel-2700"><span class="subsubsection_label">7.5.2</span> Hyperbolic tangent</h4>
<div class="standard" id="magicparlabel-2701">The hyperbolic tangent function is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo>:</mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo> → </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, defined by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>x</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msup><mo>+</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo><mi>x</mi>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> with derivative<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow>
<mrow><mi>d</mi><mi>x</mi>
</mrow>
</mrow>
</mfrac><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> Thus, we end up with another very efficient formula<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo>'</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>a</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mn>1</mn><mo>-</mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mo> ⊙ </mo>
<msup>
<mrow><mi>z</mi>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>l</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example" id="magicparlabel-2702"><div class="example_item"><span class="example_label">Example 7.3.</span>
Implementing a NN for digit classification in MATLAB</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2746" style="text-align: center;"><img alt="image: 53_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_0.png" src="53_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_0.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2907" style="text-align: center;"><img alt="image: 54_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_1.png" src="54_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_1.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2937" style="text-align: center;"><img alt="image: 55_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_2.png" src="55_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_2.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2954" style="text-align: center;"><img alt="image: 56_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_3.png" src="56_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_3.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2971" style="text-align: center;"><img alt="image: 57_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_4.png" src="57_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_4.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-3000" style="text-align: center;"><img alt="image: 58_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_5.png" src="58_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_5.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-3081" style="text-align: center;"><img alt="image: 59_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_6.png" src="59_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_6.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-3160" style="text-align: center;"><img alt="image: 60_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_7.png" src="60_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_neuralnet_example_images_figure_7.png" style="width:60%;"/>
</div>
<div class="example_item"></div>
</div>
<div class="standard" id="magicparlabel-3235"><br/>
</div>
<h2 class="section" id="magicparlabel-3236"><span class="section_label">A</span> Notes on probability theory, Bayes theorem and Bayesian learning<a id="sec_Notes_on_probability"></a>
</h2>
<div class="standard" id="magicparlabel-3237">These notes are adapted from [<a href="#LyXCite-AriasProbability"><span class="bib-label">3</span></a>].</div>
<h3 class="subsection" id="magicparlabel-3238"><span class="subsection_label">A.1</span> Probability theory basic</h3>
<div class="standard" id="magicparlabel-3239">Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> Ω </mo>
</mrow></math> be a sample space, i.e., the set of possible outcomes of an event, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ⊂ </mo><mo> Ω </mo>
</mrow>
</mrow></math> an event. A probability measure is a function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo>:</mo>
<mstyle mathvariant="script"><mi>P</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo> Ω </mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> → </mo>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle><mo>,</mo>
</mrow>
</mrow></math> that assigns a real number to every event, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. This represents how likely it is that the experiment's outcome is in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-3240">For <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo>,</mo><mi>P</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> to be a probability space<div class="foot"><span class="foot_label">10</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-3244">In fact, we need one more ingredient, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>F</mi>
</mstyle>
</mrow></math>, which is a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> σ </mi>
</mrow></math>-algebra of subsets of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> Ω </mo>
</mrow></math>. This is just a formalization, but we can abuse notation here to simplify some things. </div>
</div></div> we have to impose three axioms:</div>
<ol class="enumerate" id="magicparlabel-3245"><li class="enumerate_item"> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≥ </mo><mn>0</mn><mo>,</mo><mi> ∀ </mi><mi>A</mi><mo> ⊂ </mo><mo> Ω </mo>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item"> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo> Ω </mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item"> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∪ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi><mo>=</mo><mi> ∅ </mi>
</mrow>
</mrow></math>.</li>
</ol>
<div class="standard" id="magicparlabel-3260">From these axioms, some consequences can be derived:</div>
<ul class="itemize" id="magicparlabel-3261"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mi>A</mi>
</mrow><mo stretchy="true">¯</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover accent="false">
<mrow><mo>:</mo><mo>=</mo>
</mrow>
<mrow><mi>d</mi><mi>e</mi><mi>f</mi>
</mrow></mover><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.

<div class="proof" id="magicparlabel-3262"><div class="proof_item"><span class="proof_label">Proof.</span>
We can write <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Ω </mo><mo>=</mo><mi>A</mi><mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ∩ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi> ∅ </mi>
</mrow>
</mrow></math>, so we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1</mn><mover accent="false"><mo>=</mo>
<mrow><mi>A</mi><mn>2</mn>
</mrow></mover><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo> Ω </mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover accent="false"><mo>=</mo>
<mrow><mi>A</mi><mn>3</mn>
</mrow></mover><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> thus:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mi>A</mi>
</mrow><mo stretchy="true">¯</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> Ω </mo><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
</div>
</li><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> ∅ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>.

<div class="proof" id="magicparlabel-3264"><div class="proof_item"><span class="proof_label">Proof.</span>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> ∅ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mo> Ω </mo>
</mrow><mo stretchy="true">¯</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo> Ω </mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>.</div>
</div>
</li><li class="itemize_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ⊂ </mo><mi>B</mi>
</mrow>
</mrow></math>, then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≤ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.

<div class="proof" id="magicparlabel-3266"><div class="proof_item"><span class="proof_label">Proof.</span>
In this case, we can write <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mo>=</mo><mi>A</mi><mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and we have the inequality.</div>
</div>
</li><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∪ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.

<div class="proof" id="magicparlabel-3268"><div class="proof_item"><span class="proof_label">Proof.</span>
We have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∖ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ∪ </mo><mi>B</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∖ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∪ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∪ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∖ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∖ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math></div>
</div>
</li><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∪ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≤ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.

<div class="proof" id="magicparlabel-3270"><div class="proof_item"><span class="proof_label">Proof.</span>
This is obvious from the previous result.</div>
</div>
</li></ul>
<h4 class="subsubsection" id="magicparlabel-3271"><span class="subsubsection_label">A.1.1</span> Joint probability</h4>
<div class="standard" id="magicparlabel-3272">It is usal to be interested in the probability of two events happening simultaneously. This is called the <b>joint probability</b> of events <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover accent="false">
<mrow><mo>:</mo><mo>=</mo>
</mrow>
<mrow><mi>d</mi><mi>e</mi><mi>f</mi>
</mrow></mover><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> The join probability is useful when an event can be decomposed in simpler disjoint events, i.e., we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ⊂ </mo>
<msub>
<mrow><mi>B</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∪ </mo><mn>...</mn><mo> ∪ </mo>
<msub>
<mrow><mi>B</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>B</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∩ </mo>
<msub>
<mrow><mi>B</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mi> ∅ </mi><mo>,</mo><mi> ∀ </mi><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow></math>. In this situation, we can use the <b>sum rule</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>,</mo>
<msub>
<mrow><mi>B</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This is also known as <b>marginalization</b>: when we know the joint probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and we want to compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, we marginalize out <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math>. This basically means that if we know the probabilities of all possible pairs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>, we can know the probability of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math> by exploring all the possibilities. Here, 'exploring' is using the sum rule:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>y</mi>
</mrow>
</msub><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> or<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>y</mi>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi>y</mi>
</mrow><mo>,</mo>
</mrow>
</mrow></math> if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math> is continuous.</div>
<div class="example" id="magicparlabel-3273"><div class="example_item"><span class="example_label">Example A.1.</span>
We have two events:</div>
</div>
<ul class="itemize" id="magicparlabel-3274"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>: earns more than 100k or earns less than 100k.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>y</mi>
</mrow></math>: is a professor, a software engineer or a data scientist.</li>
</ul>
<div class="standard" id="magicparlabel-3276">We have some sources of information, and are able to determine that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>&gt;</mo><mn>100</mn><mo>,</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>f</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.05</mn><mo>,</mo><mspace width="10px"></mspace><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>&gt;</mo><mn>100</mn><mo>,</mo><mi>s</mi><mi>e</mi><mi>n</mi><mi>g</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.1</mn><mo>,</mo><mspace width="10px"></mspace><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>&gt;</mo><mn>100</mn><mo>,</mo><mi>d</mi><mi>s</mi><mi>c</mi><mi>i</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.2</mn><mo>,</mo>
</mrow>
</mrow></math> then we can conclude that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>&gt;</mo><mn>100</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.05</mn><mo>+</mo><mn>0.1</mn><mo>+</mo><mn>0.2</mn><mo>=</mo><mn>0.35.</mn>
</mrow>
</mrow></math></div>
<h4 class="subsubsection" id="magicparlabel-3277"><span class="subsubsection_label">A.1.2</span> Conditional probability</h4>
<div class="standard" id="magicparlabel-3278">The <b>conditional probability</b> of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> given <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> is the probability that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> occurs, knowing that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> has occurred. This means that we have to restrict the space of possible outcomes, from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> Ω </mo>
</mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math><div class="foot"><span class="foot_label">11</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-3282">Note that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math> is needed.</div>
</div></div>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> If we rearrange the terms, we can obtain the <b>product rule</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This formula can be generalized to an arbitrary number of events, the <b>general product rule</b>, given by<div class="foot"><span class="foot_label">12</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-3286">Note that here it is needed that all the intersections <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo><mn>...</mn><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow></math> have non-zero probability, for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math>.</div>
</div></div><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="exercise" id="magicparlabel-3287"><div class="exercise_item"><span class="exercise_label">Exercise A.1.</span>
Prove that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>|</mo><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="exercise_item">Then, prove the general product rule.</div>
</div>
<div class="standard" id="magicparlabel-3289">Basically, we are asked to prove the general product rule by induction.</div>
<div class="standard" id="magicparlabel-3290">For <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>, we have already proven it.</div>
<div class="standard" id="magicparlabel-3291">For <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo>=</mo><mn>3</mn>
</mrow>
</mrow></math>, we hav<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> which is what we wanted.</div>
<div class="standard" id="magicparlabel-3292">Now, assume it is true for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math>. Then, we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo><mn>...</mn><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo><mn>...</mn><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo><mn>...</mn><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo><mn>...</mn><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mover accent="false"><mo>=</mo>
<mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi>
</mrow></mover>
</mtd>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> ∩ </mo><mn>...</mn><mo> ∩ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> </div>
<h4 class="subsubsection" id="magicparlabel-3293"><span class="subsubsection_label">A.1.3</span> Bayes rule</h4>
<div class="standard" id="magicparlabel-3294">Bayes theorem gives an alternative formula for the conditional probability:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="proof" id="magicparlabel-3295"><div class="proof_item"><span class="proof_label">Proof.</span>
Assuming all involved probabilities are non-zero:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mover accent="false"><mo>=</mo>
<mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>d</mi><mspace width="10px"></mspace><mi>r</mi><mi>u</mi><mi>l</mi><mi>e</mi>
</mrow></mover>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="standard" id="magicparlabel-3296">This rule is known to be useful to update the probability of an event happening, when we are able to gather new information of related events. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is usually called the <b>prior probability</b>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the <b>a posteriori probability</b>, which means that we have observed <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math>, and want to update the probability estimate for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math>.</div>
<div class="example" id="magicparlabel-3297"><div class="example_item"><span class="example_label">Example A.2.</span>
Example of the Bayes rule in action</div>
<div class="example_item">An English-speaking tourist visits a city whose language is not English. A local friend tells him that 1 in 10 natives speak English, 1 in 5 people in the streets are tourists and that half of the tourists speak English. Our visitor stops comeone in the street and finds that this person speaks English. What is the probability that this person is a tourist?</div>
<div class="example_item">We have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi><mo>|</mo><mi>T</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="10px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi><mo>|</mo><mi>L</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>10</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="10px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>T</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
</mrow>
</mrow></math></div>
<div class="example_item">We want to update our knowledge about the event of this person being a tourist. The prior probability is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
</mrow></math>, but since we know that this person speaks english, we have new information useful for updating the probability. </div>
<div class="example_item">First, the total probability of someone speaking english is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover accent="false"><mo>=</mo>
<mrow><mi>s</mi><mi>u</mi><mi>m</mi><mspace width="10px"></mspace><mi>r</mi><mi>u</mi><mi>l</mi><mi>e</mi><mo>+</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>t</mi><mspace width="10px"></mspace><mi>r</mi><mi>u</mi><mi>l</mi><mi>e</mi>
</mrow></mover><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi><mo>|</mo><mi>T</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>T</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi><mo>|</mo><mi>L</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>L</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>10</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>4</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>50</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example_item">Now, the a posteriori probability of the person being a tourist, now that we know that he speaks english is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>t</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo>|</mo><mi>E</mi><mi>N</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi><mo>|</mo><mi>T</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>T</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>E</mi><mi>N</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
</mrow>
</mrow>
<mrow>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>50</mn>
</mrow>
</mfrac>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>5</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> As we can see (and as we should expect), knowing that the person speaks english, our confidence that he is a tourist increases.</div>
</div>
<h3 class="subsection" id="magicparlabel-3303"><span class="subsection_label">A.2</span> Bayes rule in the context of learning</h3>
<div class="standard" id="magicparlabel-3304">As have been explained, Bayes rule allows us to reason about hypotheses from data:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>h</mi><mi>y</mi><mi>p</mi><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>s</mi><mo>|</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>|</mo><mi>h</mi><mi>y</mi><mi>p</mi><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>h</mi><mi>y</mi><mi>p</mi><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> In the jargon of parameters and datasets, this is: <em>let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> be a random variable with support <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> Θ </mo>
</mrow></math>, and let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math> be the data that has been observed. Then, it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> </em>Here, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the <b>prior distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math></b>. This means it is the distribution that we assume, before observing <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the <b>likelihood</b> of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>: the probability of observing <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math> if the parameters are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the <b>evidence</b> or expected likelihood. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the <b>posterior distribution of </b><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, our quantity of interest, expressing what we know about <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> after having observed <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-3305">Thus, we can continue this line of thought to tackle a new way of creating a model: given some data <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>, find the best possible values for the unknown parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, so that the posterior or its likelihood is maximized.</div>
<div class="standard" id="magicparlabel-3306">There are, basically, two different approaches:</div>
<ul class="itemize" id="magicparlabel-3307"><li class="itemize_item"><b>Maximum likelihood</b>: in this case, we want to choose <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> in order to maximize its likelihood:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Maximum a posteriori</b>: in this case, we take into account a prior distribution for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> and estimate its value maximizing its posterior distribution:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>A</mi><mi>P</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<h3 class="subsection" id="magicparlabel-3309"><span class="subsection_label">A.3</span> Maximum likelihood estimation</h3>
<div class="standard" id="magicparlabel-3310">Given a sample <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> are independent are identically distributed observations from a random variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, following a distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>;</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> the paremeters of the distribution. Our objective will be to obtain the best values for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, according to our data, assuming some special form for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math>. </div>
<div class="standard" id="magicparlabel-3311">For this, the likelihood can be used: since the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> are independent, the probability of having the sample <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> The <b>likelihood function</b> is thus defined as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Note that this is done with a fixed data <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>, so it is not a probability distribution, but a function of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>. This way, the maximum likelihood estimator for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> There is a numerical issue here, though: as we are multiplying probabilities, which are values between 0 and 1, and we are likely to be multiplying many of them, we expect to obtain values very close to 0, which can lead to underflow in computations. Thus, it is convenient to use the <b>log-likelihood</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> log </mo><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo>-</mo><mo> log </mo><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example" id="magicparlabel-3312"><div class="example_item"><span class="example_label">Example A.3.</span>
Compute the maximum likelihood estimator (MLE) for univariate Gaussian distribution. </div>
<div class="example_item">For this, we assume the data <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, where each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> In this situation, the parameters are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math>. The likelihood function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>;</mo><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Now, the log-likelihood is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>e</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mn>0</mn><mo>-</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> At this point, to obtain the MLE, we need to maximize this function with respect to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> μ </mi>
</mrow>
</mrow>
</mfrac><mi>l</mi><mi>o</mi><mi>g</mi><mi>L</mi><mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo> ∑ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn><mo> ⟺ </mo><mo> ∑ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn><mo> ⟺ </mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>n</mi><mi> μ </mi><mo>=</mo><mn>0</mn><mo> ⟺ </mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mi>l</mi><mi>o</mi><mi>g</mi><mi>L</mi><mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mn>2</mn><mi> π </mi><mo>+</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ⟺ </mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo> ⟺ </mo><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo><mi>n</mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo> ⟺ </mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> Now, we substitute the value obtained for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math>.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="standard" id="magicparlabel-3314"><br/>
</div>
<div class="example" id="magicparlabel-3315"><div class="example_item"><span class="example_label">Example A.4.</span>
Compute the MLE for a Bernoulli distribution. </div>
<div class="example_item">Now the observations are the results of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> coin tosses. We have to compute the parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub>
</mrow></math> of the Bernoulli random variable, whose probability function is given by <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>x</mi>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo><mi>x</mi>
</mrow>
</mrow>
</msup><mo>,</mo><mspace width="10px"></mspace><mi>p</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mspace width="10px"></mspace><mi>x</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mrow></math> Now, we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⊂ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup>
</mrow>
</mrow></math>. The likelihood function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>L</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>;</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> We differentiate:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi>p</mi>
</mrow>
</mrow>
</mfrac><mi>L</mi><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<menclose notation="updiagonalstrike">
<mrow><mi>p</mi><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</menclose><mo>-</mo><mi>p</mi><mi>n</mi><mo>+</mo>
<menclose notation="updiagonalstrike">
<mrow><mi>p</mi><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</menclose>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>p</mi><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> This derivative is zero if and only if<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>p</mi><mi>n</mi><mo>=</mo><mn>0</mn><mo> ⟺ </mo><mi>p</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo>=</mo>
<mover>
<mrow><mi>x</mi>
</mrow><mo stretchy="true">¯</mo>
</mover><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<h3 class="subsection" id="magicparlabel-3317"><span class="subsection_label">A.4</span> Properties of estimators</h3>
<div class="definition" id="magicparlabel-3323"><div class="definition_item"><span class="definition_label">Definition A.1.</span>
If we have a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo><mi>X</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> is a random variable, we call <b>estimator</b> a function <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo>:</mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo> → </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
</mrow>
</mrow></math>. </div>
</div>
<div class="standard" id="magicparlabel-3329">Usually, we focus on estimators that tell us something about the underlying distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>. For example, it is usual to assume that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> belongs to a certain family of random variables <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ∈ </mo><mi>F</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so that we need to estimate the parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> θ </mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi> θ </mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-3330">There are some properties that are considered desirable for an estimator to have:</div>
<ul class="itemize" id="magicparlabel-3331"><li class="itemize_item"><b>Unbiasedness</b>: an estimator <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow></math> is unbiased if in the long run it takes the value of estimated parameter. If we define the <b>bias</b> of an estimator as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi> θ </mi><mo>,</mo>
</mrow>
</mrow></math> then, the estimator is unbiased if<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mn>0.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Low variance</b>: the variance of an estimator tells us how sensitive it is to variations in the input data <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> In the case that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>&lt;</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
</mrow>
</mrow></math> we say that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> is <b>more efficient</b> than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math>.
<div class="standard" id="magicparlabel-3333">The <b>Cramer-Rao bound</b> gives a theoretical lower bound to the variance of an estimator, under some hypotheses that are usually assumed true<div class="foot"><span class="foot_label">13</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-3337">For further information one could read my notes from a course in Statistics (in Spanish), [<a href="#LyXCite-lorencio2021"><span class="bib-label">1</span></a>].</div>
</div></div>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≥ </mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mi> ∂ </mi><mo> ln </mo><mi>L</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi> ∂ </mi><mi> θ </mi>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
</li><li class="itemize_item"><b>Efficiency</b>: an estimator is efficient if:

<ul class="itemize" id="magicparlabel-3339"><li class="itemize_item">It is unbiased.</li>
<li class="itemize_item">There is no other unbiased estimator with lower variance.</li>
</ul>
</li><li class="itemize_item"><b>Consistency</b>: a sequence of estimators <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> ∈ </mo>
<mstyle mathvariant="double-struck"><mi>N</mi>
</mstyle>
</mrow>
</mrow>
</msub>
</mrow></math> is consistent if it converges in probability to the true value of the parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> ∀ </mi><mi> ϵ </mi><mo>&gt;</mo><mn>0</mn><mo>,</mo>
<msub>
<mrow><mo> lim </mo>
</mrow>
<mrow>
<mrow><mi>n</mi><mo> → </mo><mi> ∞ </mi>
</mrow>
</mrow>
</msub><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow><mi> θ </mi><mo>-</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>&lt;</mo><mi> ϵ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1.</mn>
</mrow>
</mrow></math>
<div class="remark" id="magicparlabel-3342"><div class="remark_item"><span class="remark_label">Remark A.1.</span>
If the bias and the variance of an estimator tend to 0 with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math>, then it is consistent.</div>
</div>
</li><li class="itemize_item"><b>Mean squeared error</b>: the mean squared error of an estimator is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo>
</mrow>
</mrow></math> which is a value that we seek to minimize.</li>
</ul>
<div class="example" id="magicparlabel-3344"><div class="example_item"><span class="example_label">Example A.5.</span>
Show that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example_item">Let's start from the definition:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>-</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>2</mn><mi> θ </mi>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>+</mo>
<msup>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mn>2</mn><mi> θ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<msup>
<mrow><mi> θ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mi> θ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi> θ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi> θ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi> θ </mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mo>+</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo><mi> θ </mi><mo> ⋅ </mo><mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>+</mo>
<msup>
<mrow>
</mrow>
<mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math></div>
</div>
<div class="standard" id="magicparlabel-3346"><br/>
</div>
<div class="example" id="magicparlabel-3347"><div class="example_item"><span class="example_label">Example A.6.</span>
Compute the bias and the variance of the ML estimates <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> of an univariate Gaussian. Show that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub>
</mrow></math> is biased and that we can correct its biasedness by using a different estimator<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow>
<mover>
<mrow><mi> σ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>=</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mn>.</mn>
</mrow>
</mrow></math> Compute the bias and the variance of this new estimator.</div>
<div class="example_item">Let's start with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math>:</div>
<div class="example_item"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo> ∑ </mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo> ∑ </mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mn>0</mn><mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow>
</msub><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow>
</msub><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>²</mo>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow>
</msub><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Now <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mn>2</mn><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<menclose notation="updiagonalstrike">
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</menclose><mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<menclose notation="updiagonalstrike">
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</menclose>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow>
</msub><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>n</mi><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msup>
<mrow>
<mover>
<mrow><mi> σ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo> ∑ </mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>-</mo><mn>2</mn>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msubsup>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi><mi>E</mi>
</mrow>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow>
<mrow><mn>2</mn><mi>n</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo>
<mfrac>
<mrow>
<menclose notation="updiagonalstrike"><mi>n</mi>
</menclose>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow>
<menclose notation="updiagonalstrike"><mn>2</mn>
</menclose>
</mrow>
</msup>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo> ≠ </mo><mi>j</mi>
</mrow>
</mrow>
</msub><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mn>2</mn>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>n</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msup>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>E</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>V</mi><mi>a</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mfrac>
<mrow>
<mrow><mo>-</mo><mo>+</mo><mo>-</mo><mo>-</mo><mo>+</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd><mn>0.</mn>
</mtd>
</mtr>
</mtable></math> And we see how this one is, in fact, unbiased.</div>
</div>
<h3 class="subsection" id="magicparlabel-3350"><span class="subsection_label">A.5</span> Maximum a posteriori estimation</h3>
<div class="standard" id="magicparlabel-3351">MAP (maximum a posteriori) estimation is a method of estimating the parameters of a statistical model by finding the parameter values that maximize the posterior probability distribution of the parameters, given the observed data and a prior probability distribution over the parameters. In contexts where the amount of data is limited or noisy, incorporating prior knowledge or beliefs can help to produce more stable and accurate estimates. The prior distribution serves as a regularization term, allowing us to control the degree of influence that the prior has on the estimate:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi> θ </mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>A</mi><mi>P</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo><mo> arg </mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi> θ </mi>
</mrow>
</msub><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> θ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> θ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where the denominator can be ignored because it is constant for all possible <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, so it does not change the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> arg </mo><mo> max </mo>
</mrow>
</mrow></math>.</div>
<div class="example" id="magicparlabel-3352"><div class="example_item"><span class="example_label">Example A.7.</span>
Find the MAP estimate for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> of an univariate Gaussian <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>,</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> with Gaussian prior distribution for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> μ </mi><mo> ∼ </mo>
<mstyle mathvariant="script"><mi>N</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>,</mo>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> σ </mi><mo>,</mo>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow></math> are assumed to be known.</div>
<div class="example_item">Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∼ </mo><mi>X</mi>
</mrow>
</mrow></math>, then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> μ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> μ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mo> ⋅ </mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> so we want to maximize<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> μ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> or, its log function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> μ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> μ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> Thus,<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow>
<mrow><mi>d</mi><mi> μ </mi>
</mrow>
</mrow>
</mfrac><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi> μ </mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<mrow><mn>2</mn><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>-</mo>
<mfrac>
<mrow>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi>n</mi><mi> μ </mi>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>-</mo>
<mfrac>
<mrow>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>-</mo>
<mfrac>
<mrow>
<mrow><mi>n</mi><mi> μ </mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi> μ </mi>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>-</mo><mi> μ </mi>
<mfrac>
<mrow>
<mrow><mi>n</mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mtd>
</mtr>
</mtable></math> and this is zero if and only if<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>A</mi><mi>P</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> A different way to do this is that we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi> π </mi>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
</msup>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</msqrt>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo> ∝ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> and we want <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> such that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∝ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∼ </mo><mi>N</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>,</mo>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so we can solve<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mi> μ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</msup><mo> ⋅ </mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mo>=</mo>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> obtaining<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow></math>and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mi>n</mi>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> </div>
</div>
<div class="standard" id="magicparlabel-3354"><br/>
</div>
<div class="example" id="magicparlabel-3355"><div class="example_item"><span class="example_label">Example A.8.</span>
The maximum likelihood estimate of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> for a Bernoulli r.v. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> is given by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>M</mi><mi>L</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> If we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>K</mi><mo>&gt;</mo><mn>2</mn>
</mrow>
</mrow></math> outcomes, then we have the categorical distribution, also known as multinoulli or generalized Bernoulli, which has support <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. Its parameters are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, representing the probability of observing each of the possible outcomes, with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mi> ∀ </mi><mi>i</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</div>
<div class="example_item">It is convenient to use the <em>one-of-K encoding </em>(also called one-hot encoding) for each outcome. Thus, the pmf of this distribution becomes<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msubsup><mn>.</mn>
</mrow>
</mrow></math> Now, given a sample <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> of possible outcomes for a multinoulli r.v. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, the maximum likelihood estimate for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
</mrow>
</mrow></math> for each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>. We can write this compactely as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mo> ∑ </mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> If some category <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> is not present in our sample, then its corresponding ML estimate is going to be 0. These 0-estimates are problematic in predictive applications, because unseen outcomes in the training data are considered to be impossible to happen, and thus can never be predicted. To avoid this, <b>pseudocounts</b> are used instead. These represent prior knowledge in the form of (imagined) counts <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> for each category <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>. The idea is to assume that the data is augmented with our pseudocounts, and then we estimate using maximum likelihood over the augmented data, namely<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>c</mi><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> so the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-th parameter is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> As an example, imagine that we obtain a sample from a die: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>6</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. If the vector of pseudocounts is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> then the estimates are <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow><mn>1</mn><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
<mrow>
<mrow><mn>6</mn><mo>+</mo><mn>6</mn>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>6</mn>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow>
<mover>
<mrow><mi>p</mi>
</mrow><mo stretchy="true">ˆ</mo>
</mover>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mn>6</mn><mo>+</mo><mn>6</mn>
</mrow>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>12</mn>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> and so on. Notice that although 2 has not been observed in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>, its probability estimate is not 0. This special case where all pseudocounts are 1 is known as <b>Laplace smoothing</b>.</div>
<div class="example_item">Prove that using maximum likelihood with pseudocounts corresponds to a MAP estimate with Dirichlet prior with parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>.</div>
<div class="example_item">A Dirichlet distribution, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>i</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> has the density function:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> Γ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mo> ∏ </mo><mo> Γ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo> ∏ </mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msubsup><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> Γ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mi>K</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mo> ∏ </mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>!</mo>
</mrow>
</mrow>
</mfrac><mo> ∏ </mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msubsup><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mi>K</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>!</mo>
</mrow>
</mrow>
<mrow>
<mrow><mo> ∏ </mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>!</mo>
</mrow>
</mrow>
</mfrac><mo> ∏ </mo>
<msubsup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msubsup><mn>.</mn>
</mrow>
</mrow></math> To compute the MAP estimate, we use<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>D</mi><mo>|</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>p</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mi>p</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>p</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msubsup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow>
</msubsup><mo> ⋅ </mo>
<mfrac>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>+</mo><mi>K</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>!</mo>
</mrow>
</mrow>
<mrow>
<mrow><mo> ∏ </mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>!</mo>
</mrow>
</mrow>
</mfrac>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msubsup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</msubsup><mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Thus, we want to minimize<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>,</mo><mi>k</mi>
</mrow>
</mrow>
</msub>
<msubsup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow>
</msubsup>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msubsup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</msubsup><mo>,</mo>
</mrow>
</mrow></math> or, equivalently, its log<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> We have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mtable>
<mtr>
<mtd><mo> min </mo>
</mtd>
<mtd>
<mrow><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>K</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi>s</mi><mn>.</mn><mi>a</mi><mn>.</mn>
</mrow>
</mtd>
<mtd>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mi> ∀ </mi><mi>i</mi>
</mrow>
</mtd>
</mtr>
</mtable><mn>.</mn>
</mrow>
</mrow></math> The lagrangian is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>L</mi><mo>=</mo><mi>g</mi><mo>-</mo><mi> λ </mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> so that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mi>L</mi><mo>=</mo>
<mfrac>
<mrow><mi> ∂ </mi>
</mrow>
<mrow>
<mrow><mi> ∂ </mi>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mi>g</mi><mo>-</mo><mi> λ </mi><mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mfrac><mo>+</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mfrac><mo>-</mo><mi> λ </mi><mo>=</mo><mn>0</mn><mo> ⟺ </mo><mi> λ </mi><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mfrac><mo> ⟺ </mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> and then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1</mn><mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi> λ </mi>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⟺ </mo><mi> λ </mi><mo>=</mo><mi>n</mi><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> Finally, substituting back, we obtain<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>k</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>+</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> as we wanted!</div>
</div>
<h3 class="subsection" id="magicparlabel-3359"><span class="subsection_label">A.6</span> Bayesian Learning</h3>
<div class="standard" id="magicparlabel-3360">In the Bayesian Learning framework, instead of working with point estimates of our unknown parameter variables <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math>, we work with the whole posterior distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. In this case, learning is the process by which starting with some prior belief about the parameters and when facing some observations in the form of a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>D</mi>
</mrow></math>, we update our belief about the possible values for our parameters in the form of the posterior distribution. This process is iterated over newly received data, so it can be viewed as a sequential process, in which Bayes is invoked each time we need a new posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
<div class="example" id="magicparlabel-3361"><div class="example_item"><span class="example_label">Example A.9.</span>
Bayesian learning in Matlab</div>
<div class="standard" id="magicparlabel-3496" style="text-align: center;"><img alt="image: 61_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_bayesian_learning_images_figure_0.png" src="61_home_runner_work_BDMA_Notes_BDMA_Notes_UPC_M___e_scripts_bayesian_learning_images_figure_0.png" style="width:40%;"/>
</div>
</div>
<h4 class="subsubsection" id="magicparlabel-3515"><span class="subsubsection_label">A.6.1</span> Predictive posterior</h4>
<div class="standard" id="magicparlabel-3516">When doing prediction in this framework, the whole distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is used. We view a prediction as a weighted average of all predictions each value for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> θ </mi>
</mrow></math> can make, weighted by its posterior probability (its expected value):<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>'</mo><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∫ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mo> Θ </mo>
</mrow>
</msubsup>
<mrow><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>x</mi><mo>'</mo><mo>|</mo><mi> θ </mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> θ </mi><mo>|</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow><mo> ⁢ </mo>
<mrow><mo> ⅆ </mo><mi> θ </mi>
</mrow><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="example" id="magicparlabel-3517"><div class="example_item"><span class="example_label">Example A.10.</span>
An insightful example</div>
</div>
<div class="standard" id="magicparlabel-3662"><br/>
</div>
<div class="standard" id="magicparlabel-3663"><h2 class="bibtex">References</h2><div class="bibtex"><div class="bibtexentry" id="LyXCite-lorencio2021"><span class="bibtexlabel">1</span><span class="bibtexinfo"><span class="bib-fullnames:author">Jose A. Lorencio Abril</span>, "<span class="bib-title">Apuntes de Inferencia EstadÃ­stica</span>" (<span class="bib-year">2021</span>).</span></div>
<div class="bibtexentry" id="LyXCite-Arias2022"><span class="bibtexlabel">2</span><span class="bibtexinfo"><span class="bib-fullnames:author">Marta Arias</span>, "<span class="bib-title">Machine Learning</span>".</span></div>
<div class="bibtexentry" id="LyXCite-AriasProbability"><span class="bibtexlabel">3</span><span class="bibtexinfo"><span class="bib-fullnames:author">Marta Arias</span>, "<span class="bib-title">Notes on probability theory, Bayes theorem and Bayesian learning</span>".</span></div>
<div class="bibtexentry" id="LyXCite-Rosenblatt_1958"><span class="bibtexlabel">4</span><span class="bibtexinfo"><span class="bib-fullnames:author">F. Rosenblatt</span>, "<span class="bib-title">The perceptron: A probabilistic model for information storage and organization in the brain.</span>", <i><span class="bib-journal">Psychological Review</span></i> <span class="bib-volume">65</span>, <span class="bib-number">6</span> (<span class="bib-year">1958</span>), pp. <span class="bib-pages">386--408</span>.</span></div>
</div></div>
</body>
</html>
