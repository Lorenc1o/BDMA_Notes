<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="LyX 2.3.6" name="GENERATOR"/>
<meta content="text/html;charset=utf-8" http-equiv="Content-type"/>
<title>INFOH423 - Data Mining</title>
<style type="text/css">
/* LyX Provided Styles */
div.bibtexentry { margin-left: 2em; text-indent: -2em; }
span.bibtexlabel:before{ content: "["; }
span.bibtexlabel:after{ content: "] "; }

/* Layout-provided Styles */
h1.title {
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.date {
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: center;

}
div.author {
font-size: large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.standard {
	margin-bottom: 2ex;
}
div.address {
margin-bottom: 1.5ex;
text-align: left;

}
h1.part {
font-weight: bold;
font-size: x-large;
margin-top: 2ex;
margin-bottom: 1.5ex;
text-align: left;

}
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.definition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.definition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h4.subsubsection {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proof {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proof_label {
font-style: italic;
font-variant: normal;
font-size: medium;

}
h4.subsubsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
div.proposition {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proposition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.lyx_code {
font-family: monospace;
margin-top: 0.5ex;
margin-bottom: 0.5ex;
margin-left: 3ex;
margin-right: 3ex;
text-align: left;

}
div.toc {
  margin: 2em 0em;
  border-style: solid;
  border-width: 2px 0px;
  padding: 1em 0em;
}
h2.tochead { font-size: x-large; font-weight: bold; }
div.lyxtoc-0 {
  margin: 2em 0em 0em 0em;
  font-size: xx-large;
  font-weight: bold;
}
div.lyxtoc-1 {
  margin: 1em 0em 0em 0em;
  font-size: x-large;
  font-weight: bold;
}
div.lyxtoc-2 {
  margin: 0em 0.1em 0em 1em;
  font-size: large;
  font-weight: normal;
}
div.lyxtoc-3 { margin: 0em 0.1em 0em 0.5em; font-size: medium; }
div.lyxtoc-4 { margin: 0em 0.1em 0em 0.5em; }
div.lyxtoc-5 { margin: 0em 0.1em 0em 0.5em; }
div.lyxtoc-6 { margin: 0em 0.1em 0em 0.5em; }
a.tocentry {
  text-decoration: none;
  color: black;
}
a.tocentry:visited { color: black; }
a.lyxtoc-floats { 
  text-decoration: none; 
  color: black;
}
a.lyxtoc-floats:visited { color: black; }
div.lyxtoc-floats { 
  margin: 0em 0em 0.1em 1em;
  font-size: large;
  font-weight: normal;
}
span.foot_label {
	vertical-align: super;
	font-size: smaller;
	font-weight: bold;
	text-decoration: underline;
}
div.foot {
	display: inline;
	font-size: small;
	font-weight: medium;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.foot_inner { display: none; }
div.foot:hover div.foot_inner {
	display: block;
	border: 1px double black;
	margin: 0em 1em;
	padding: 1em;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
table {
	border-collapse: collapse;
	display: inline-block;
}
td {
	border: 1px solid black;
	padding: 0.5ex;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}
div.float-listings {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}
div.listings-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	}


</style>
</head>
<body dir="auto">
<h1 class="title" id="magicparlabel-1">INFOH423 - Data Mining</h1>
<div class="date" id="magicparlabel-2">Fall 2022</div>
<div class="author" id="magicparlabel-3">Jose Antonio Lorencio Abril</div>
<div class="standard" id="magicparlabel-4" style="text-align: center;"><img alt="image: 0_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Da___x-Universit___libre_de_Bruxelles__logo__svg.png" src="0_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Da___x-Universit___libre_de_Bruxelles__logo__svg.png" style="width:10%;"/>
</div>
<div class="standard" id="magicparlabel-5" style="text-align: right;">Professor: Mahmoud Sakr</div>
<div class="standard" id="magicparlabel-6" style="text-align: right;">Student e-mail: jose.lorencio.abril@ulb.be</div>
<div class="standard" id="magicparlabel-7"><br/>
</div>
<div class="address" id="magicparlabel-8">This is a summary of the course <em>Data Mining</em>, taught at the Université Libre de Bruxelles by Professor Mahmoud Sakr in the academic year 22/23. Most of the content of this document is adapted from the course notes by Sakr, [<a href="#LyXCite-Sakr2022"><span class="bib-label">3</span></a>], and the basic bibliographic source of the course, the book of Aggarwal, [<a href="#LyXCite-Aggarwal_2015"><span class="bib-label">1</span></a>], so I won't be citing it all the time. Other references will be provided when used.</div>
<div class="standard" id="magicparlabel-9"><br/>
</div>
<div class="toc"><h2 class="tochead section">Table of Contents</h2></div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-16">Part I Introduction</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-17">1 What is data mining?</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-34">1.1 Why is data mining important today, if it was not yesterday?</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-38">2 The Data Mining Process</a>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-52">3 Data Types</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-59">3.1 Nondependency-oriented data</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-189">3.2 Dependency-oriented data</a>
</div>
</div>
</div>
</div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-203">Part II Classification</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-208">4 Decision Trees</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-239">4.1 Split criteria</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-597">4.2 ID3 Tree Induction Algorithm</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-671">5 Bayesian classification</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-673">5.1 Naive Bayes classifier</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-1010">6 Model evaluation and selection</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1014">6.1 Confusion Matrix</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-1188">7 Ensemble methods: increasing accuracy</a>
</div>
</div>
</div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-1234">Part III Model validation and data preparation</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-1235">8 Data preparation</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1244">8.1 Feature extraction</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1255">8.2 Data Type Portability</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1343">8.3 Data Cleaning</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1362">8.4 Exploratory analysis</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1388">8.5 Similarity and Distance</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-1454">9 Model evaluation</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1458">9.1 Holdout</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1472">9.2 Cross-Validation</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1488">9.3 Bootstrap</a>
</div>
</div>
</div>
</div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-1497">Part IV Clustering</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-1506">10 Representative-Based Algorithms</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1549">10.1 The k-Means algorithm</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-1975">10.2 The k-Medians Algorithm</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2148">10.3 The k-Medoids Algorithm</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2188">10.4 Practical issues</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-2192">11 Grid and Density based Algorithms</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2195">11.1 Grid-based methods</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2231">11.2 DBSCAN</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2305">11.3 DENCLUE</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-2314">12 Probabilistic Model-Based Algorithms</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2316">12.1 Fuzzy sets and clusters</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2322">12.2 Mixture model</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2460">12.3 Evaluating fuzzy clusters</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2464">12.4 Cluster quality measures</a>
</div>
</div>
</div>
</div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-2474">Part V Frequent pattern and association rule mining</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-2475">13 Frequent Itemset Mining</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2480">13.1 The model</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2658">13.2 Association rule generation framework</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-2684">13.3 Frequent itemset mining algorithms</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-3666">13.4 Mining Association Rules</a>
</div>
</div>
<div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-3998">14 Sequential pattern mining</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-4025">14.1 Candidate generation</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-4035">14.2 Generalized Sequential Pattern (GSP) Algorithm</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-4501">14.3 Sequential PAttern Discovery using Equivalence classes (SPADE) Algorithm</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-5871">14.4 PrefixSpan</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-6339">14.5 Some comments</a>
</div>
</div>
</div>
</div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-6414">Part VI Stream Data Mining</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-6415">15 Stream data mining</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-6422">15.1 Bloom filter</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-6679">15.2 Count-Min Sketch</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-7285">15.3 Flajolet-Martin algorithm</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-7313">15.4 Hyperloglog</a>
</div>
</div>
</div>
</div>
<div class="lyxtoc-0"><a class="tocentry" href="#magicparlabel-7324">Part VII Outlier mining</a>
<div class="lyxtoc-1"><div class="lyxtoc-2"><a class="tocentry" href="#magicparlabel-7325">16 Outlier Mining</a>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-7338">16.1 Types of outliers</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-7377">16.2 Challenges of outlier detection</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-7382">16.3 Supervised methods for outlier detection</a>
</div>
<div class="lyxtoc-3"><a class="tocentry" href="#magicparlabel-7399">16.4 Unsupervised methods for outlier detection</a>
</div>
</div>
</div>
</div>
<div class="standard" id="magicparlabel-11"><br/>
</div>
<div class="toc toc-floats"><h2 class="tochead toc-figure fact_">List of Figures</h2><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-1466">Figure 1: Holdout visualization.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-1481">Figure 2: Cross-Validation visualization. m=3.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-7344">Figure 3: A global outlier.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-7360">Figure 4: A context outlier.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-7371">Figure 5: Collective outliers.</a></div><div class="lyxtoc-floats lyxtoc-figure"><a class="lyxtoc-floats" href="#magicparlabel-7392">Figure 6: Basic diagram of a one-class model.</a></div></div>
<div class="toc toc-floats"><h2 class="tochead toc-table fact_">List of Tables</h2><div class="lyxtoc-floats lyxtoc-table"><a class="lyxtoc-floats" href="#magicparlabel-78">Table 1: Records and multidimensional data set example</a></div><div class="lyxtoc-floats lyxtoc-table"><a class="lyxtoc-floats" href="#magicparlabel-280">Table 2: The weather data. Source: [#witten2011].</a></div></div>
<div class="toc toc-floats"><h2 class="tochead toc-algorithm fact_">List of Algorithms</h2><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-220">Algorithm 1: GenericDecisionTree(Dataset: D)</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-603">Algorithm 2: ID3(I, O, T) : Decision Tree</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-1433">Algorithm 3: DP_Edit(s1, s2)</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-1520">Algorithm 4: Generic k-representative approach (Data D, int k, threshold eps) : Set of representatives Y and Clusters C</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-2158">Algorithm 5: k-medoids(Data D, int k, threshold eps) : Set of representatives Y and Clusters C</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-2217">Algorithm 6: GenericGrid(Data D, Ranges p, Density tau) : clusters C</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-2248">Algorithm 7: DBSCAN(Data D, Radius eps, Density tau) : clusters C</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-2719">Algorithm 8: Apriori(Transactions T, Minimum Support minsup)</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-3220">Algorithm 9: Apriori_improved(Transactions T, Minimum support minsup)</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-3290">Algorithm 10: FP-Growth(FP-Tree FPT, Minimum Support minsup, Current Suffix P)</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-6433">Algorithm 11: BloomConstruct(Stream S, Size m, Number of hash w)</a></div><div class="lyxtoc-floats lyxtoc-algorithm"><a class="lyxtoc-floats" href="#magicparlabel-6690">Algorithm 12: CountMinConstruct(Stream S, Width w, Height m)</a></div></div>
<div class="standard" id="magicparlabel-15"><br/>
</div>
<h1 class="part" id="magicparlabel-16"><span class="part_label">Part I</span> Introduction</h1>
<h2 class="section" id="magicparlabel-17"><span class="section_label">1</span> What is data mining?</h2>
<div class="standard" id="magicparlabel-18">Even though there is not a formal-accepted-by-all definition of data mining, most of them are in agreement that data mining is a field of study that focuses on the collection, cleaning, processing, analysis and gaining of useful insights from the data that we have access to.</div>
<div class="standard" id="magicparlabel-19">As wider as these topics are, is also the data mining domain, which is nowadays a really hot topic both in academia and industry.</div>
<div class="standard" id="magicparlabel-20">In academia, there exist many goals to achieve in this field:</div>
<ul class="itemize" id="magicparlabel-21"><li class="itemize_item">Developing new models.</li>
<li class="itemize_item">Developing new ways to deal with real world data.</li>
<li class="itemize_item">Understading what some complex models are actually doing.</li>
<li class="itemize_item">Developing the mathematical tools to be able to better describe the models that are made by computer scientist in a less formalized way (it is not rare that scientific models come before their mathematical formalization<div class="foot"><span class="foot_label">1</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-28">For example, for Newton, differential calculus was just a tool he developed to be able to better understand some physical processes that were kind of obvious to him. Afterwards, it became one of the widest branches of mathematics and led to other mathematical tools, theories and developments in many other fields.</div>
</div></div>.</li>
<li class="itemize_item">Using of data mining to gain a better understanding of medical, biological, chemical, economic,... data than we are able to gain using just traditional statistic techniques.</li>
</ul>
<div class="standard" id="magicparlabel-30">In the industry, the focus is mainly in two fields (disregarding research companies, which would have similar objectives as academia):</div>
<ul class="itemize" id="magicparlabel-31"><li class="itemize_item">Using well known models to understand what happened in the past.</li>
<li class="itemize_item">Using well known models to try to predict what will happen in the future.</li>
</ul>
<div class="standard" id="magicparlabel-33">These usages are made with the aim of improving the business processes and, ultimately, maximize profit.</div>
<h3 class="subsection" id="magicparlabel-34"><span class="subsection_label">1.1</span> Why is data mining important today, if it was not yesterday?</h3>
<div class="standard" id="magicparlabel-35">Because the computing power has increased enormously, so now we are able to run algorithms that enable us to train models in a decent time, and this task was practically undoable a few years ago.</div>
<div class="standard" id="magicparlabel-36">Not only that, but the data technology is rapidly evolving, too. We produce more data and store more data, so... we have more data! This data is potential knowledge and we know many tools to get this knowledge from it. </div>
<div class="standard" id="magicparlabel-37">In fact, the amount of data is so vast, that not only we have to develop techniques to analyze data, but also to manage huge amounts of data.</div>
<h2 class="section" id="magicparlabel-38"><span class="section_label">2</span> The Data Mining Process</h2>
<div class="standard" id="magicparlabel-39">The data mining process is a pipeline constructed around the basic steps:</div>
<ol class="enumerate" id="magicparlabel-40"><li class="enumerate_item"><b>Data collection</b>: obtention of data from real world sources.</li>
<li class="enumerate_item"><b>Feature extraction </b>and <b>data cleaning</b>: among all data retrieved from the real world, we have to select those characteristics or <b>features</b> that are relevant for our purposes (feature extraction) and to decide what to do with mistaken/noisy/lost data (data cleaning). Also, as we might be collecting data from different sources, it is important to decide how to aggregate the data into a unified format for later processing.</li>
<li class="enumerate_item"><b>Analytical processing </b>and <b>algorithms</b>: we now must develop suitable methods for analyzing our data. That is, we should decide what mathematical models to use to describe our data, and what algorithms to use in order to <em>train</em> the desired model<div class="foot"><span class="foot_label">2</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-46">We will see what is specifically the meaning of <em>train</em>, but in the meanwhile we can think of it as how we make a general model adapt to our particular data.</div>
</div></div>.</li>
<li class="enumerate_item">After these steps, we would enter a phase of analyzing the obtained results to obtain knowledge from data, as well as a iterative procedure, in which we could return to any previous step and try to improve different parts of the process<div class="foot"><span class="foot_label">3</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-51">Usually, data is constantly updating, so at least it will necessary to produce checks of correctness and updates.</div>
</div></div>.</li>
</ol>
<h2 class="section" id="magicparlabel-52"><span class="section_label">3</span> Data Types</h2>
<div class="standard" id="magicparlabel-53">Not all data have have the same nature nor characteristic, so it is important to understand the differences between them and what techniques are applicable to what types of data.</div>
<div class="standard" id="magicparlabel-54">We can characterize data in different levels of detail, and the most basic classification would distinguish between <em>nondependency-oriented</em> data and <em>dependency-oriented</em> data:</div>
<ul class="itemize" id="magicparlabel-55"><li class="itemize_item"><b>Nondependency-oriented data</b>: simple data types with no specified dependencies between the data items or the attributes.</li>
<li class="itemize_item"><b>Dependency-oriented data</b>: implicit or explicit relationships may exist between data items. </li>
</ul>
<div class="standard" id="magicparlabel-57">Dependency-oriented data are normally more complex to study because of the need to study not only the data itself, but also the relationships between different data items.</div>
<div class="standard" id="magicparlabel-58">We will now define different subtypes of data that we can find.</div>
<h3 class="subsection" id="magicparlabel-59"><span class="subsection_label">3.1</span> Nondependency-oriented data</h3>
<div class="standard" id="magicparlabel-60">The term nondependency-oriented data is interchangeable with the term <b>multidimensional data:</b></div>
<div class="standard" id="magicparlabel-61"><div class="flex_color_box"><div class="definition" id="magicparlabel-65"><div class="definition_item"><span class="definition_label">Definition 3.1.</span>
We will call <b>source space</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle>
</mrow></math>, to the set of all possible values that our data can take. This set does not have neccessarily to take any particular form. </div>
<div class="definition_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle>
</mrow></math> is a product space, then each component is called a <b>feature</b>.</div>
</div>
</div></div>
<div class="example" id="magicparlabel-67"><div class="example_item"><span class="example_label">Example 3.1.</span>
If we are measuring the name, age, height and gender of the students of a school, then we will have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle><mo>=</mo>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle><mo> × </mo>
<mstyle mathvariant="double-struck"><mi>N</mi>
</mstyle><mo> ∩ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>150</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>M</mi><mo>,</mo><mi>F</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow></math> represents the set of possible names and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>M</mi><mo>,</mo><mi>F</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> are the two possible values of the gender.</div>
</div>
<div class="standard" id="magicparlabel-68"><div class="flex_color_box"><div class="definition" id="magicparlabel-72"><div class="definition_item"><span class="definition_label">Definition 3.2.</span>
A <b>record</b> (<em>data point, instance, tuple</em>) is just a point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msup>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle>
</mrow>
</mrow></math> that we measure and store in some form.</div>
</div>
</div></div>
<div class="example" id="magicparlabel-73"><div class="example_item"><span class="example_label">Example 3.2.</span>
Following the previous example, some records of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle>
</mrow></math> are represented in the following table:</div>
<div class="example_item"><div class="float-table"><div class="plain_layout" id="magicparlabel-78" style="text-align: center;"><a id="table_records_example"></a>
<table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-110"><b>index</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-113"><b>Name</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-116"><b>Age</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-119"><b>Height</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-122"><b>Gender</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-125">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-128">Josh</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-131">23</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-134">1.77</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-137">M</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-140">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-143">Mary</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-146">28</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-149">1.62</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-152">F</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-155">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-158">Larry</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-161">12</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-164">1.58</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-167">M</div>
</td>
</tr></tbody>
</table>
</div>
<div class="plain_layout" id="magicparlabel-168"><span class="float-caption-Standard float-caption float-caption-standard">Table 1:  Records and multidimensional data set example</span></div>
</div>
</div>
<div class="example_item">Note that we added an index column, because it is a common practice.</div>
</div>
<div class="standard" id="magicparlabel-174"><div class="flex_color_box"><div class="definition" id="magicparlabel-178"><div class="definition_item"><span class="definition_label">Definition 3.3.</span>
A <b>multidimensional data set</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math>, is a set of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> records, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
</mrow></math>.</div>
</div>
</div></div>
<div class="example" id="magicparlabel-179"><div class="example_item"><span class="example_label">Example 3.3.</span>
Table <a href="#table_records_example">3.2</a> represents an example of a dataset, too.</div>
</div>
<div class="standard" id="magicparlabel-180">As we can see, Table <a href="#table_records_example">3.2</a> contains attributes of different types (very obvious from the definition of the source space <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle>
</mrow></math>). Thus, we have to take into account also the type of each attributes of our data:</div>
<ul class="itemize" id="magicparlabel-181"><li class="itemize_item"><b>Quantitative multidimensional data</b>: numerical data features, as age or height. If a data set is wholy compound of this kind of features, it is said to be a quantitative multidimensional data. 
<div class="standard" id="magicparlabel-182">This type of data is the easiest to analyze, as mathematical tools are directly applicable and most algorithms are developed assuming this type of data. For this reason, it is common to try to transform all non-quantitative data into quantitative data.</div>
</li><li class="itemize_item"><b>Categorical and Mixed Attribute data</b>: a <b>categorical</b> feature is such that it can only take values among a finite set (unordered) of options, as the gender. 
<div class="standard" id="magicparlabel-184">If we encounter a data set compound of categorial data, we would say it is a categorical multidimensional data.</div>
<div class="standard" id="magicparlabel-185">A dataset with both quantitative and categorical features is called a mixed multidimensional data.</div>
</li><li class="itemize_item"><b>Binary and Set data</b>: binary data take values in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> and it can be considered a special case of both numerical data (obviously) and categorical data (as if have a categorical feature which can only take two values, then it is easy to map these values to the set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>). For example, the gender is an obvious case of binary data.
<div class="standard" id="magicparlabel-187">Moreover, binary data can be seen as setwise data, where 1 indicates that the instance is in the set, while 0 indicates it is not.</div>
</li><li class="itemize_item"><b>Text data</b>: usually a string, such as the name.</li>
</ul>
<h3 class="subsection" id="magicparlabel-189"><span class="subsection_label">3.2</span> Dependency-oriented data</h3>
<div class="standard" id="magicparlabel-190">As outlined before, we can find implicit or explicit dependencies between instances:</div>
<ul class="itemize" id="magicparlabel-191"><li class="itemize_item"><b>Implicit dependencies</b>: the dependencies between instancies are not explicitly specified but are known to exist. For example, if we measure the number of students in the library every 5 minutes, we would find that different instances are related via the temporal dimension, so measures with little time delay between them would be similar.</li>
<li class="itemize_item"><b>Explicit dependencies</b>: this term usually refers to graph or network data, in which edges represents relationships between nodes.</li>
</ul>
<div class="standard" id="magicparlabel-193">As before, let deepen a bit in some types of this kind of data:</div>
<ul class="itemize" id="magicparlabel-194"><li class="itemize_item"><b>Time-Series data</b>: it contains data that are generated by continuous measurement over time. This means that our source space has a temporal component. This dependency is implicit.
<div class="standard" id="magicparlabel-195">Formally, a <b>time series of length <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold"><mi>n</mi></mstyle>
</mrow></math> and dimensionality <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold"><mi>d</mi></mstyle>
</mrow></math> </b>contains <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math> numeric features at each of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> time stamps <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. Each time stamp contains a component for each of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math> series. Therefore, the set of values received at time stamp <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> es <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msubsup><mo>,</mo><mn>...</mn><mo>,</mo>
<msubsup>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
</li><li class="itemize_item"><b>Discrete sequences</b>: these are the categorical analog of time-series data. We will now have categorical or text features along the temporal dimension. This dependency is implicit.</li>
<li class="itemize_item"><b>Spatial data</b>: in this type of data, the dependance of the instances is given by their proximity in space. For example, if we measure the temperature in a room per <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi>
<msup>
<mrow><mi>m</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup>
</mrow>
</mrow></math>, we will find that points that are nearby show more similar temperature than points that are far away from each other. This dependency is implicit.</li>
<li class="itemize_item"><b>Spatiotemporal data</b>: this data captures both spatial and temporal dimension, so we have to deal with both relationships. As before, this dependency is implicit.</li>
<li class="itemize_item"><b>Network and graph data</b>: now, data values may correspond to nodes in the network, and the relationships between them would correspond to the edges between the nodes.
<div class="standard" id="magicparlabel-200">Formally, a <b>network</b> is a pair <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>N</mi><mo>,</mo><mi>E</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math> is a set of nodes and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo> ⊂ </mo><mi>N</mi><mo> × </mo><mi>N</mi>
</mrow>
</mrow></math> is a set of edges, that represent the relationships between the nodes. There can be attributes associated to both nodes or edges.</div>
<div class="standard" id="magicparlabel-201">Edges may be directed or indirected, depending on wether the link is bidirectional or not.</div>
</li></ul>
<div class="standard" id="magicparlabel-202"><br/>
</div>
<h1 class="part" id="magicparlabel-203"><span class="part_label">Part II</span> Classification</h1>
<div class="standard" id="magicparlabel-204">A <b>classification problem</b> consists in learning the structure of a dataset of examples, already partitioned into groups, referred as <b>class</b>. This learning is typically achieved with a <b>model</b>, which is used to estimate the <b>class labels</b> of unseen data examples with unknown labels. Thus, one of the inputs to the classification problem is the example dataset with known labels, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math>, called <b>training data</b>, while the unseen data points to be classified are the <b>test data</b>. The model learnt is referred to as <b>training model</b>. The algorithm used to create the model is the <b>learner</b>. </div>
<div class="standard" id="magicparlabel-205">The output of the classification algorithm can be of two types:</div>
<ul class="itemize" id="magicparlabel-206"><li class="itemize_item"><b>Label prediction</b>: a label is predicted for each test instance.</li>
<li class="itemize_item"><b>Numerical score</b>: the learner assigns a score to each instance-label possible combination. This score measures the propensity of the instance to belong to a particular class.</li>
</ul>
<h2 class="section" id="magicparlabel-208"><span class="section_label">4</span> Decision Trees</h2>
<div class="standard" id="magicparlabel-209"><b>Decision trees</b> are a classification methodology, which uses a tree structure to partition the feature space. Each node of the tree represents a decision to make according to the data, called the <b>split criterion</b>, and is a condition on one or more features variables in the training data.</div>
<div class="standard" id="magicparlabel-210">The goal is to identify a split criterion such that the level of <em>mixing</em> of the class variables in each branch of the tree is reduced as much as possible.</div>
<div class="standard" id="magicparlabel-211">The splits can be <b>univariate</b>, if they use a single attribute in the condition, or <b>multivariate</b>, if more than one attribute are used in the condition.</div>
<div class="standard" id="magicparlabel-212">The nodes can be of two types:</div>
<ul class="itemize" id="magicparlabel-213"><li class="itemize_item"><b>Internal node</b>: each internal node represents a partition of the space according to a certain condition.</li>
<li class="itemize_item"><b>Leaf node</b>: they are labeled with the dominant class of the remaining partition of the training set at that node.</li>
</ul>
<div class="standard" id="magicparlabel-215">The general algorithm for constructing a decision tree is as follows:</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">begin
	Create root node containing D;
	repeat
		Select an eligible node in tree;
		&lt;@\textcolor{red}{Split the selected node into two or more nodes based on the split criterion};&lt;@
	until no more eligible nodes for split;
	&lt;@\textcolor{red}{Prune overfitting nodes from tree};&lt;@
	Label each leaf node with its dominant class;
end</pre></div>
<div class="plain_layout" id="magicparlabel-233"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 1:  GenericDecisionTree(Dataset: D)</span></div>
</div>
<div class="standard" id="magicparlabel-238">The red lines indicate what changes accross the different algorithms to produce a specific decision tree.</div>
<h3 class="subsection" id="magicparlabel-239"><span class="subsection_label">4.1</span> Split criteria</h3>
<div class="standard" id="magicparlabel-240">The split criterion aims to maximize the separation of the different classes among the children nodes. Its design depends on the attributes of the data:</div>
<ul class="itemize" id="magicparlabel-241"><li class="itemize_item">Binary attributes: produce a binary tree.</li>
<li class="itemize_item">Categorical attribute: there several approaches:

<ul class="itemize" id="magicparlabel-243"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math>-way split: we split the branch in as many branches as distinct values of the attribute.</li>
<li class="itemize_item">binary split: testing each of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msup><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> groupings of categorical attributes, and selecting the best one.</li>
</ul>
</li><li class="itemize_item">Numeric attribute: we have, again, several possibilities:

<ul class="itemize" id="magicparlabel-246"><li class="itemize_item">If it contains a small number <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math> of ordered values, we can treat it as a categorial attribute and apply <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math>-way split.</li>
<li class="itemize_item">For continuous numeric attributes, the split is performed using a binary condition, like <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo> ≤ </mo><mi>a</mi>
</mrow>
</mrow></math> for a certain contant <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>a</mi>
</mrow></math>.</li>
</ul>
</li></ul>
<div class="standard" id="magicparlabel-248">These methods require to determine the best split among a set of different splits, so we need a way to measure which one is better than other.</div>
<div class="standard" id="magicparlabel-249">For this end, we are using the <b>entropy</b>.</div>
<h4 class="subsubsection" id="magicparlabel-250"><span class="subsubsection_label">4.1.1</span> Entropy</h4>
<div class="standard" id="magicparlabel-251"><div class="flex_color_box"><div class="definition" id="magicparlabel-255"><div class="definition_item"><span class="definition_label">Definition 4.1.</span>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> be the fraction of data points belonging to the class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>j</mi>
</mrow></math> for the attribute value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>. Then, the <b>class-based entropy</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, <b>for the attribute</b> value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
</div>
</div></div>
<div class="remark" id="magicparlabel-256"><div class="remark_item"><span class="remark_label">Remark 4.1.</span>
When <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>, it is assumed that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>.</div>
</div>
<div class="standard" id="magicparlabel-257"><br/>
</div>
<div class="remark" id="magicparlabel-258"><div class="remark_item"><span class="remark_label">Remark 4.2.</span>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mi>k</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>.</div>
</div>
<div class="standard" id="magicparlabel-259"><br/>
</div>
<div class="remark" id="magicparlabel-260"><div class="remark_item"><span class="remark_label">Remark 4.3.</span>
Higher values of the entropy imply greater <em>mixing</em> of different classes, while a value of 0 implies perfect separation.</div>
</div>
<div class="standard" id="magicparlabel-261"><div class="flex_color_box"><div class="definition" id="magicparlabel-265"><div class="definition_item"><span class="definition_label">Definition 4.2.</span>
The <b>overal entropy</b> <b>of an attribute</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>E</mi>
</mrow></math>, is defined as the weighted average over the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math> different attribute values:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msubsup>
<mfrac>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is the frequency of attribute value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-266">The entropy is used in the ID3 algorithm for constructing decision trees.</div>
<div class="standard" id="magicparlabel-267">The overall entropy for an <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math>-way split of set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> into sets <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow>
</mrow></math> may be computed as the weighted average of the entropy values of each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, being its weigth <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow></math>. This is called the <b>entropy-split</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>-</mo><mi>S</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>v</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-268">In relation to this, the <b>information gain</b> is defined as the reduction of entropy due to the split:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>-</mo><mi>S</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Note that lower values of the entropy-split and higher values of the information gain are more desirable.</div>
<div class="standard" id="magicparlabel-269">Sometimes, there are attributes with lots of distinct values, so using them to split the data reduces the entropy a lot, but are not very useful for prediction<div class="foot"><span class="foot_label">4</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-273">Think, for example, in an ID. See Subsubsection <a href="#subsec_The_problem_of">4.2.1</a>.</div>
</div></div>. To account for this, we can divide the overall information gain with the normalization factor <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>-</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> which helps adjusting for the varying number of categorical values.</div>
<div class="example" id="magicparlabel-274"><div class="example_item"><span class="example_label">Example 4.1.</span>
<b>Entropy of the dataset 'Weather data'</b></div>
<div class="example_item">Consider the following dataset:</div>
<div class="example_item">
<div class="float-table"><div class="plain_layout" id="magicparlabel-280" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-367">outlook</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-370">temperature</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-373">humidity</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-376">windy</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-379">play</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-382">sunny</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-385">hot</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-388">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-391">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-394">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-397">sunny</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-400">hot</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-403">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-406">true</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-409">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-412">overcast</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-415">hot</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-418">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-421">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-424">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-427">rainy</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-430">mild</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-433">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-436">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-439">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-442">rainy</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-445">cool</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-448">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-451">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-454">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-457">rainy</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-460">cool</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-463">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-466">true</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-469">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-472">overcast</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-475">cool</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-478">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-481">true</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-484">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-487">sunny</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-490">mild</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-493">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-496">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-499">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-502">sunny</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-505">cool</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-508">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-511">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-514">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-517">rainy</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-520">mild</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-523">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-526">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-529">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-532">sunny</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-535">mild</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-538">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-541">true</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-544">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-547">overcast</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-550">mild</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-553">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-556">true</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-559">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-562">overcast</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-565">hot</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-568">normal</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-571">false</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-574">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-577">rainy</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-580">mild</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-583">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-586">true</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-589">no</div>
</td>
</tr></tbody>
</table>
</div>
<div class="plain_layout" id="magicparlabel-590"><span class="float-caption-Standard float-caption float-caption-standard">Table 2:  The weather data. Source: [<a href="#LyXCite-witten2011"><span class="bib-label">4</span></a>].</span></div>
</div>
</div>
<div class="example_item">If the class attribute is <em>play</em>, what is the entropy of this source?</div>
<div class="example_item"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo>-</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>o</mi>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>n</mi><mi>o</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>5</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>5</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd><mn>0.94.</mn>
</mtd>
</mtr>
</mtable></math> What if the Entropy-Split of the attribute <em>humidity</em>?<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>E</mi><mi>S</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo>|</mo><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo>|</mo><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow>
<mfrac>
<mrow><mn>7</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>4</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>4</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>+</mo>
<mfrac>
<mrow><mn>7</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>7</mn>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd><mn>0.7885.</mn>
</mtd>
</mtr>
</mtable></math> And the information gain?<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>E</mi><mi>S</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>h</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd>
<mrow><mn>0.94</mn><mo>-</mo><mn>0.79</mn><mo>=</mo><mn>0.15.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math></div>
</div>
<h3 class="subsection" id="magicparlabel-597"><span class="subsection_label">4.2</span> ID3 Tree Induction Algorithm</h3>
<div class="standard" id="magicparlabel-598">ID3 is an algorithm to construct decision trees, in which the split criterion is the maximization of the information gain and the prunning strategy is to stop if all the records in a node are of the same class. The algorithm is more detailed in Algorithm <a href="#alg_ID3">2</a>.</div>
<div class="float-algorithm"><div class="plain_layout" id="magicparlabel-603"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 2:  <a id="alg_ID3"></a>
ID3(I, O, T) : Decision Tree</span></div>
<div class="float-listings"><pre class="listings"># I is the set of input attributes
# O is the output attribute
# T is a set of training data

if (T is empty) then
	return a single node with value “Failure”

if (all records  in T have the same value for O) then
	return a single node with that value

if (I is empty) then
	return a single node with the most frequent value of O in T

# else
compute IG for each attribute in I using data in T

Let X = argmin{IG(attr) for attr in I}
Let {x_j for j=1,...,m} be the values in X
Let {T_j for j=1,...,m} be the subsets of T when partitioned

return a tree with:
	root node labelled X
	arcs labelled x_1,...,x_m
	connected to 
	ID3(I-{X}, O, T_1),...,ID3(I-{X}, O, T_m)</pre></div>
</div>
<div class="example" id="magicparlabel-636"><div class="example_item"><span class="example_label">Example 4.2.</span>
Compute the decision tree of the data in Table <a href="#table_records_example">3.2</a> using ID3 algorithm.</div>
<div class="example_item"><b>Step 1: Root</b></div>
<div class="example_item">We start by computing IG for each attribute. To simplify notation, let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo>=</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo>,</mo><mspace width="10px"></mspace><mi>O</mi><mo>=</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi>l</mi><mi>o</mi><mi>o</mi><mi>k</mi><mo>,</mo><mspace width="10px"></mspace><mi>T</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mo>,</mo><mspace width="10px"></mspace><mi>H</mi><mo>=</mo><mi>h</mi><mi>u</mi><mi>m</mi><mi>i</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>y</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>W</mi><mo>=</mo><mi>w</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>y</mi>
</mrow>
</mrow></math>.</div>
<div class="example_item">We already know that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>P</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.94</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>H</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>H</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.15</mn>
</mrow>
</mrow></math>. Let's compute the rest of the values:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>E</mi><mi>S</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>a</mi><mi>s</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>5</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo> log </mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo> log </mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mn>2</mn><mo>-</mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo>=</mo>
</mtd>
<mtd><mn>0.69.</mn>
</mtd>
</mtr>
</mtable></math> Which implies that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>a</mi><mi>s</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.25</mn>
</mrow>
</mrow></math>.</div>
<div class="example_item">Repeating this process with temerature, we get <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>T</mi><mo>=</mo><mi>h</mi><mi>o</mi><mi>t</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>T</mi><mo>=</mo><mi>m</mi><mi>i</mi><mi>l</mi><mi>d</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>T</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>l</mi><mi>d</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.03</mn>
</mrow>
</mrow></math> and with windy, we get <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>W</mi><mo>=</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>W</mi><mo>=</mo><mi>F</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.05</mn>
</mrow>
</mrow></math>.</div>
<div class="example_item">This means that we label the root node with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo><mi>O</mi>
</mrow>
</mrow></math> and we create three arcs, each of them with one of the values from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>O</mi>
</mrow></math>. So we have the following Tree:</div>
<div class="standard" id="magicparlabel-642" style="text-align: center;"><img alt="image: 1_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado1.png" src="1_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado1.png"/>
</div>
<div class="example_item"><b>Step 2: Outlook=sunny</b></div>
<div class="example_item">Now, we are going to do the same thing, restricting ourselves to the records for which <em>Outlook=sunny</em>. Now, we have to recompute the entropy and the gain for each of the rest of the attributes.</div>
<div class="example_item">Let's start with the entropy:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>P</mi><mo>|</mo><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo>-</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo> log </mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac><mo> log </mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo><mn>0.97.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> Now, the Information Gain:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi><mo>,</mo><mi>H</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi><mo>,</mo><mi>H</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>P</mi><mo> ⋀ </mo><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi><mo>|</mo><mi>H</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>P</mi><mo> ⋀ </mo><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi><mo>|</mo><mi>H</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd><mrow></mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mo>-</mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac><mo> log </mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac><mo>+</mo><mn>0</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>-</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo> log </mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo>+</mo><mn>0</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
</mrow>
</mtd>
<mtd><mn>0.</mn>
</mtd>
</mtr>
</mtable></math> Which means that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi><mo>,</mo><mi>H</mi><mo>=</mo><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>n</mi><mi>n</mi><mi>y</mi><mo>,</mo><mi>H</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.97</mn>
</mrow>
</mrow></math>. As this cannot be improved, we can savely not compute the rest of the values. This way, the Tree will now look as follows:</div>
<div class="standard" id="magicparlabel-646" style="text-align: center;"><img alt="image: 2_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado2.png" src="2_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado2.png"/>
</div>
<div class="example_item"><b>Step 3: Outlook=Sunny, Humidity=Normal</b></div>
<div class="example_item">Note that we are proceeding heightwise, but doing this breadthwise is also possible.</div>
<div class="example_item">This time, all the values for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>P</mi>
</mrow></math> are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>Y</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow></math>, so we enter the third <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>i</mi><mi>f</mi>
</mrow>
</mrow></math> of the algorithm and label the node as <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>Y</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow></math>.</div>
<div class="example_item"><b>Step 4: Outlook=Sunny, Humidity=High</b></div>
<div class="example_item">Same, now <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo>=</mo><mi>N</mi><mi>o</mi>
</mrow>
</mrow></math>.</div>
<div class="example_item"><b>Step 5: Outlook=Overcast</b></div>
<div class="example_item">Same, now <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo>=</mo><mi>Y</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow></math>. </div>
<div class="example_item">So, now we have the following tree:</div>
<div class="standard" id="magicparlabel-655" style="text-align: center;"><img alt="image: 3_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado3.png" src="3_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado3.png"/>
</div>
<div class="example_item"><b>Step 6: Outlook=rainy</b></div>
<div class="example_item"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>P</mi><mo>|</mo><mi>O</mi><mo>=</mo><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.97</mn>
</mrow>
</mrow></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>G</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>y</mi>
</mrow>
</mrow>
</msub><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>y</mi><mo>,</mo><mi>W</mi><mo>=</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow>
<mrow><mi>O</mi><mo>=</mo><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>y</mi><mo>,</mo><mi>W</mi><mo>=</mo><mi>F</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.97</mn><mo>,</mo>
</mrow>
</mrow></math> so, again, it is maximum and we can continue using it as label:</div>
<div class="standard" id="magicparlabel-658" style="text-align: center;"><img alt="image: 4_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado4.png" src="4_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado4.png"/>
</div>
<div class="example_item"><b>Step 7: Outlook=rainy, Windy=False</b></div>
<div class="example_item">All records have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo>=</mo><mi>Y</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow></math>.</div>
<div class="example_item"><b>Step 8: Outlook=rainy, Windy=True</b></div>
<div class="example_item">All record have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo>=</mo><mi>N</mi><mi>o</mi>
</mrow>
</mrow></math>.</div>
<div class="example_item">So, we have the tree</div>
<div class="standard" id="magicparlabel-664" style="text-align: center;"><img alt="image: 5_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado5.png" src="5_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado5.png"/>
</div>
<div class="example_item">And as there are no more nodes to analyze, this is the final decision tree.</div>
</div>
<h4 class="subsubsection" id="magicparlabel-666"><span class="subsubsection_label">4.2.1</span> The problem of UID<a id="subsec_The_problem_of"></a>
</h4>
<div class="standard" id="magicparlabel-667">In general, attributes that have very many values have very high gain, but can lead to useless decision trees. Quinlan suggest choosing the attribute with the highest<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>S</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>S</mi><mo> ⟹ </mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>S</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> is the label attribute.</div>
<div class="standard" id="magicparlabel-668">The GainRatio favores attributes with higher gain, and punishes attributes with high entropy (many values).</div>
<div class="example" id="magicparlabel-669"><div class="example_item"><span class="example_label">Example 4.3.</span>
Repeat the decision tree ID3 algorithm, but use GainRatio instead.</div>
<div class="example_item">The same tree is obtained.</div>
</div>
<h2 class="section" id="magicparlabel-671"><span class="section_label">5</span> Bayesian classification</h2>
<div class="standard" id="magicparlabel-672"><b>Probabilistic classifiers</b> construct a model that quantifies the relationships between the feature variables and the target variable as a probability. We are going to study a well-known kind of probabilistic classifier, namely the <b>Bayesian classifier</b> or <b>Naive Bayes classifier</b>.</div>
<h3 class="subsection" id="magicparlabel-673"><span class="subsection_label">5.1</span> Naive Bayes classifier</h3>
<div class="standard" id="magicparlabel-674">The <b>Bayes classifier</b> is based on the Bayes' theorem for conditional probabilities.</div>
<div class="standard" id="magicparlabel-675"><div class="flex_color_box"><div class="theorem" id="magicparlabel-679"><div class="theorem_item"><span class="theorem_label">Theorem 5.1.</span>
<b>Bayes' Theorem</b></div>
<div class="theorem_item">If A and B are probabilistic events and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≠ </mo><mn>0</mn>
</mrow>
</mrow></math>, then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
</div></div>
<div class="proof" id="magicparlabel-681"><div class="proof_item"><span class="proof_label">Proof.</span>
On one side<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo> ∩ </mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="proof_item">On the other side, if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≠ </mo><mn>0</mn>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∩ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo> ⟹ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo> ∩ </mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Now substituting this value in the previous equation, we get<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>B</mi><mo>|</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> which is the result we wanted to proof.</div>
<div class="proof_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>, then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>A</mi><mo>|</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn><mo>,</mo><mspace width="10px"></mspace><mi> ∀ </mi><mi>B</mi>
</mrow>
</mrow></math>, so the formula also holds.</div>
</div>
<div class="standard" id="magicparlabel-684">This theorem quantifies the conditional probability of a random variable (the class variable), given known observations about another variables (the features). Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> be the class variable and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> an unseen feature tuple. The goal of the method is to estimate<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi><mo>|</mo><mi>X</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math>Let the random variables for the individual dimensions of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> be denoted by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, so we want to estimate<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi><mo>|</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mover accent="false"><mo>=</mo>
<mrow><mi>B</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow></mover>
<mfrac>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> Here, we will be interested in maximizing this value. Since the denominator is the same independently of the class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>c</mi>
</mrow></math>, then we can focus on maximizing the denumerator<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> The value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the <b>prior probability</b> of the class identifier <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>c</mi>
</mrow></math> and can be estimated as the fraction of points in the data whose class is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>c</mi>
</mrow></math>. Thus, we now want to approximate the right factor. In the Naive Bayes approach, it is assumed that the feature values are independent of one another conditional on a fixed value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math>. Then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> And this terms are much easier to estimate: to estimate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> we just need to take the fraction of training values with class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>c</mi>
</mrow></math> and compute which fraction of them verifies <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. This is usually written as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>q</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>,</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>c</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="remark" id="magicparlabel-685"><div class="remark_item"><span class="remark_label">Remark 5.1.</span>
When there are not enough training samples to produce reliable estimates, we can use <b>Laplacian smoothing</b> in which a small value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> α </mi>
</mrow></math> is added to the numerator and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> α </mi><mo> ⋅ </mo>
<msub>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow></math> is added to the denominator, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is the number of distinct values of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>j</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> attribute<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>q</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>,</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi> α </mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>c</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi> α </mi><mo> ⋅ </mo>
<msub>
<mrow><mi>m</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> α </mi>
</mrow></math> is called the <b>Laplacian smoothing parameter</b>.</div>
</div>
<div class="standard" id="magicparlabel-686"><br/>
</div>
<div class="remark" id="magicparlabel-687"><div class="remark_item"><span class="remark_label">Remark 5.2.</span>
If a feature is continuous, then the likelihood is computed using a Gaussian distribution with mean <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> and standard deviation <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> σ </mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>c</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>g</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
</msqrt>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>c</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msubsup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>c</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="standard" id="magicparlabel-688">This model is sometimes refererd to as the <b>Bernoully model for Bayes classification</b> when it is applied to categorical data with only two outcomes of each feature attribute.</div>
<div class="standard" id="magicparlabel-689">In cases where more than two outcomes are possible for a feature variable, the model is referred to as the <b>generalized Bernoulli model</b>.</div>
<div class="example" id="magicparlabel-690"><div class="example_item"><span class="example_label">Example 5.1.</span>
With the following training data:</div>
<div class="standard" id="magicparlabel-691" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-778"><b>Age</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-781"><b>Income</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-784"><b>Student</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-787"><b>Credit_Rating</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-790"><b>Buys</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-793"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ≤ </mo><mn>30</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-796">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-799">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-802">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-805">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-808"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ≤ </mo><mn>30</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-811">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-814">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-817">excellent</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-820">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-823"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mn>31..40</mn>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-826">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-829">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-832">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-835">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-838"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>&gt;</mo><mn>40</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-841">medium</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-844">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-847">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-850">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-853"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>&gt;</mo><mn>40</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-856">low</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-859">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-862">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-865">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-868"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>&gt;</mo><mn>40</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-871">low</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-874">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-877">excellent</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-880">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-883"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mn>31..40</mn>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-886">low</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-889">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-892">excellent</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-895">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-898"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ≤ </mo><mn>30</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-901">medium</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-904">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-907">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-910">no</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-913"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ≤ </mo><mn>30</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-916">low</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-919">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-922">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-925">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-928"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>&gt;</mo><mn>40</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-931">medium</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-934">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-937">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-940">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-943"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ≤ </mo><mn>30</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-946">medium</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-949">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-952">excellent</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-955">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-958"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mn>31..40</mn>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-961">medium</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-964">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-967">excellent</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-970">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-973"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mn>31..40</mn>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-976">high</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-979">yes</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-982">fair</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-985">yes</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-988"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>&gt;</mo><mn>40</mn>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-991">medium</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-994">no</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-997">excellent</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1000">no</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Classify with the Naive Bayes model the unseen record<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ≤ </mo><mn>30</mn><mo>,</mo><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>u</mi><mi>m</mi><mo>,</mo><mi>y</mi><mi>e</mi><mi>s</mi><mo>,</mo><mi>f</mi><mi>a</mi><mi>i</mi><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> In this case, we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>C</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>y</mi><mi>e</mi><mi>s</mi><mo>,</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="40px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>5</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> And for the feature variables, we have to compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>:</div>
<ul class="itemize" id="magicparlabel-1002"><li class="itemize_item">Age <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> ≤ </mo><mn>30</mn>
</mrow>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ≤ </mo><mn>30</mn><mo>|</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="40px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ≤ </mo><mn>30</mn><mo>|</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Income medium:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>u</mi><mi>m</mi><mo>|</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>4</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="40px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>u</mi><mi>m</mi><mo>|</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Student yes:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mi>e</mi><mi>s</mi><mo>|</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="40px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mi>e</mi><mi>s</mi><mo>|</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Credit_rating fair:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>r</mi><mo>|</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac><mo>,</mo><mspace width="40px"></mspace><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>r</mi><mo>|</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<div class="example_item">Then, we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ≤ </mo><mn>30</mn><mo>,</mo><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>u</mi><mi>m</mi><mo>,</mo><mi>y</mi><mi>e</mi><mi>s</mi><mo>,</mo><mi>f</mi><mi>a</mi><mi>i</mi><mi>r</mi><mo>|</mo><mi>C</mi><mo>=</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mo> ∏ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi><mo>=</mo><mi>y</mi><mi>e</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>9</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo> ⋅ </mo>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>4</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>9</mn>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>16</mn>
</mrow>
<mrow><mn>567</mn>
</mrow>
</mfrac><mo> ∼ </mo><mn>0.028</mn><mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mo>=</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> ≤ </mo><mn>30</mn><mo>,</mo><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>u</mi><mi>m</mi><mo>,</mo><mi>y</mi><mi>e</mi><mi>s</mi><mo>,</mo><mi>f</mi><mi>a</mi><mi>i</mi><mi>r</mi><mo>|</mo><mi>C</mi><mo>=</mo><mi>n</mi><mi>o</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>5</mn>
</mrow>
<mrow><mn>14</mn>
</mrow>
</mfrac><mo> ⋅ </mo>
<mfrac>
<mrow><mn>3</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>5</mn>
</mrow>
</mfrac><mo>=</mo>
<mfrac>
<mrow><mn>6</mn>
</mrow>
<mrow><mn>875</mn>
</mrow>
</mfrac><mo> ∼ </mo><mn>0.007.</mn>
</mrow>
</mrow></math> Thus, the model classifies <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> with class 'yes'.</div>
</div>
<h4 class="subsubsection_" id="magicparlabel-1007">Some final comments</h4>
<div class="standard" id="magicparlabel-1008">The <b>advantages</b> of the Bayes Classifier is that it is easy to implement and can lead to fairly good results.</div>
<div class="standard" id="magicparlabel-1009">The <b>drawbacks</b> are that the main assumption of class conditional independence is not very trustable, which may lead to a loss of accuracy, because dependencies axist among variables. To deal with this issue there is a more complex model: <b>Bayesian Belief Networks</b>.</div>
<h2 class="section" id="magicparlabel-1010"><span class="section_label">6</span> Model evaluation and selection</h2>
<div class="standard" id="magicparlabel-1011">With a given dataset, we can train multiple classification models and each of them will behave differently, many times without an intuitive explanation of the differences observed. Thus, it becomes crucial to establish means of comparison between different models, so it is possible to choose between several models trained with the same data.</div>
<div class="standard" id="magicparlabel-1012">The simplest classification measure is the <b>accuracy</b>, which indicates the portion of well classified records. Nonetheless, if we compute the accuracy using the training data, we could be enhance overfitting to the training data, and maybe choose models that do not work well with unseen data. This is why it is usual to use a <b>validation test set</b> to compute comparison measures: the idea is that given a dataset, we can divide it into training data and test data. Then, models will be trained using the training data and evaluated with the test data, which has not been seen before. This makes the measures more reliable and the comparisons more fair.</div>
<div class="standard" id="magicparlabel-1013">There are several ways to extract training and test data from a dataset, which are detailed in <a href="#sec_Model_evaluation">9</a>.</div>
<h3 class="subsection" id="magicparlabel-1014"><span class="subsection_label">6.1</span> Confusion Matrix</h3>
<div class="standard" id="magicparlabel-1015">A confusion matrix is a visual and intuitive way to assess a classification algorithm. In its simplest form it is used to assess a binary classification model and it shows the following metrics:</div>
<ul class="itemize" id="magicparlabel-1016"><li class="itemize_item"><b>True Positives</b>: count of records classified as True that are actually True.</li>
<li class="itemize_item"><b>False Positives</b>: count of records classified as True that were False in reality.</li>
<li class="itemize_item"><b>True Negatives</b>: count of records classified as False that were actually False.</li>
<li class="itemize_item"><b>False Negatives</b>: count of records classified as False that were True in reality.</li>
</ul>
<div class="standard" id="magicparlabel-1020">In this case, the confusion matrix has the form:</div>
<div class="standard" id="magicparlabel-1021" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1043">Predicted True</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1046">Predicted False</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1049">Actual True</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1052">TP</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1055">FN</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1058">Actual False</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1061">FP</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1064">TN</div>
</td>
</tr></tbody>
</table>
</div>
<div class="standard" id="magicparlabel-1065">In the more general case in which we have a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math>-class classifier, each cell <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow></math> would have the count of records classified as class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>j</mi>
</mrow></math> that are of class <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>i</mi>
</mrow></math> in reality:</div>
<div class="standard" id="magicparlabel-1066" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1106">Predicted <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1109">Predicted <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1112">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1115">Predicted <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>N</mi>
</mrow>
</msub>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1118">Actual <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1121"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1124"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow>
<mrow><mn>2</mn><mo>,</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1127">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1130"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow>
<mrow><mi>N</mi><mo>,</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1133">Actual <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1136"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>,</mo><mn>2</mn>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1139"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1142">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1145"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow>
<mrow><mi>N</mi><mo>,</mo><mn>2</mn>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1148"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1151"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1154"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1157"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋱
  </mi>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1160"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mi>⋮
  </mi>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1163">Actual <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>N</mi>
</mrow>
</msub>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1166"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow>
<mrow><mn>1</mn><mo>,</mo><mi>N</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1169"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow>
<mrow><mn>2</mn><mo>,</mo><mi>N</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1172">...</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1175"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>N</mi>
</mrow>
</msub>
</mrow>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="standard" id="magicparlabel-1176">From these confusion matrices, we can derive some interesting measures:</div>
<ul class="itemize" id="magicparlabel-1177"><li class="itemize_item"><b>Accuracy</b>: the accuracy can be computed from the matrix as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mi>c</mi><mi>c</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>A</mi><mi>l</mi><mi>l</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Error rate</b>: the reverse of the accuracy:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mi>R</mi><mo>=</mo><mn>1</mn><mo>-</mo><mi>A</mi><mi>c</mi><mi>c</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>A</mi><mi>l</mi><mi>l</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Class imbalance measures</b>: sometimes, one class appears in a little amount of records (this is specially common in disease detection, for example), and is usually the case to have the focus on being able to correctly detect this rare cases.

<div class="example" id="magicparlabel-1180"><div class="example_item"><span class="example_label">Example 6.1.</span>
As an example, imagine we are trying to detect fraudulent transactions in a banking context. Out of thousands of transactions, only a very few amount would be fraudulent. Say there are 1M records for training and only 100 are known to be fraudulent. If we predict all records as OK, we would get <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mn>999</mn><mspace width="10px"></mspace><mn>900</mn>
</mrow>
</mrow>
<mrow>
<mrow><mn>1</mn>
<msup>
<mrow><mn>0</mn>
</mrow>
<mrow><mn>6</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac><mo>=</mo><mn>99.99</mn>%
  </mrow>
</mrow></math> accuracy, but we will not detect any fraud! So the accuracy is stunning but the model is useless.</div>
</div>
<div class="standard" id="magicparlabel-1181">For example like this the following measures have a motive:</div>
<ul class="itemize" id="magicparlabel-1182"><li class="itemize_item"><b>Sensitivity</b>: focuses on correctly detecting True outcomes<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>e</mi><mi>n</mi><mi>s</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>P</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>A</mi><mi>c</mi><mi>t</mi><mi>u</mi><mi>a</mi><mi>l</mi><mspace width="10px"></mspace><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Specificity</b>: focuses on correctly detecting False outcomes<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>p</mi><mi>e</mi><mi>c</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>N</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>A</mi><mi>c</mi><mi>t</mi><mi>u</mi><mi>a</mi><mi>l</mi><mspace width="10px"></mspace><mi>F</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
</li><li class="itemize_item"><b>Precision</b>: how many records labeled as True are actually True<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>P</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Recall</b>: a synonym of sensitivity.</li>
<li class="itemize_item"><b>F-score</b>: the harmonic mean of the precision and recall<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mn>2</mn><mo> ⋅ </mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo> ⋅ </mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>+</mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold">
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mi> β </mi>
</mrow>
</msub></mstyle>
</mrow></math>: weighted measure of precision and recall. Assigns <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> β </mi>
</mrow></math> times as much weight to recall as to precision<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mi> β </mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>+</mo>
<msup>
<mrow><mi> β </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo> ⋅ </mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi>
</mrow>
</mrow>
<mrow>
<mrow>
<msup>
<mrow><mi> β </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>+</mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
<h2 class="section" id="magicparlabel-1188"><span class="section_label">7</span> Ensemble methods: increasing accuracy</h2>
<div class="standard" id="magicparlabel-1189">An <b>ensemble method</b> for classification is a composite model, made up of a combination of classifiers. The idea is that given an unseen record, it can be classified using several models, and then make a consensus between all of them to decide the final decision of the class of the record. Usually, a voting scheme is used, in which the most voted class is the chosen one for classification. This approach usually improves the accuracy of each component.</div>
<div class="standard" id="magicparlabel-1190">Let's analyze why this works! There are three primary primary components to the error of a classifier:</div>
<ol class="enumerate" id="magicparlabel-1191"><li class="enumerate_item"><b>Bias</b>: every classifier has its own assumptions about the nature of the decision boundary between classes. When a classifier has high bias, it will make consistently incorrect predictions over records that lie near the incorrectly-modeled decision boundary.

<div class="example" id="magicparlabel-1192"><div class="example_item"><span class="example_label">Example 7.1.</span>
Bias is shown below. </div>
<div class="standard" id="magicparlabel-1193" style="text-align: center;"><img alt="image: 6_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado11.png" src="6_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado11.png" style="width:60%;"/>
</div>
<div class="example_item">The real model has been generated using the blue line. The classification model has the assumption that the data can be classified using a straight line. As we can see, points near to the boundary would be missclassified. </div>
</div>
</li><li class="enumerate_item"><b>Variance</b>: random variations in the choices of the traiing data will lead to different models. This is closely related to overfitting. When a classifier has an overfitting tendency, it will make inconsistent predictions for the same test instance oevr different training data sets.

<div class="example" id="magicparlabel-1196"><div class="example_item"><span class="example_label">Example 7.2.</span>
Variance is shown below.</div>
<div class="standard" id="magicparlabel-1197" style="text-align: center;"><img alt="image: 7_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado12.png" src="7_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado12.png" style="width:60%;"/>
</div>
<div class="example_item">In this case, the yellow-ish model happen to have used few red points near the boundary, so it became a perfect blue classifier, but a bad red classifier. The opposite happened to the blue-ish model. Note that this variations are only due to random selection of the training points.</div>
</div>
</li><li class="enumerate_item"><b>Noise</b>: it is the intrinsic errors in the target class labeling. As this is intrinsic, there is not much one can do. Therefore, we will focus in the two latter sources of error.</li>
</ol>
<div class="standard" id="magicparlabel-1200">In addition, bias and variance are often in a trade-off relationship: improving bias worsens variance, and vice-versa. Generally speaking, simplified assumptions about the decision boundary lead to greater bias but lower variance, while complex assumptions reduce bias but are harder to robustly estimate with limited data.</div>
<div class="standard" id="magicparlabel-1201">Ensemble analysis can often be used to reduce both the bias and variance of the classification process, because a combination of different simple models with high bias and little variance will reduce the bias as the assumptions will be combined to model more complex scenarios. On the other hand, a combination of complex models with low bias and high variance, will reduce the variance because decisions made by multiple models tend to be more consistent than those made by individual models.</div>
<h4 class="subsubsection_" id="magicparlabel-1202">Looking at the accuracy</h4>
<div class="standard" id="magicparlabel-1203">Now, let's look at the accuracy of the ensemble model in comparison to its component models in the case of binary classification (for ease). Let's say the ensemble model is composed of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math> models, each of them with an accuracy <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. Then, for the ensemble model to classify a new record as correct, at least half of the models need to classify the tuple correctly. Let's define the random variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> as '<em>number of classifiers that classify the tuple as correct</em>', then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ≥ </mo>
<mfrac>
<mrow><mi>N</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>&lt;</mo>
<mfrac>
<mrow><mi>N</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> and we can decompose<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>&lt;</mo>
<mfrac>
<mrow><mi>N</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>+</mo><mn>...</mn><mo>+</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo>
<mfrac>
<mrow><mi>N</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-1204">Here, assuming independence of the different models, it is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> × </mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo> ≠ </mo><mi>i</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo> ≠ </mo><mi>i</mi>
</mrow>
</mrow>
</msub><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> × </mo><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> × </mo>
<msub>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>k</mi><mo> ≠ </mo><mi>i</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> and so on. This yields to a complex formula, but when the case is the simplest in which <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>=</mo><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mi>a</mi><mi>c</mi>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>,</mo><mi> ∀ </mi><mi>i</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow></math>, we are in a binomial distribution, having<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mi>k</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true">(</mo><mfrac linethickness="0"><mi>N</mi><mi>k</mi></mfrac><mo fence="true" form="postfix" stretchy="true">)</mo>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>N</mi><mo>-</mo><mi>k</mi>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> </div>
<div class="example" id="magicparlabel-1205"><div class="example_item"><span class="example_label">Example 7.3.</span>
Suppose an ensemble model with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>N</mi><mo>=</mo><mn>3</mn>
</mrow>
</mrow></math> and equal accuracy for the three models, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math>. Then, the accuracy for the ensemble model is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mi>c</mi><mi>c</mi><mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo><mn>3</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>,</mo>
</mrow>
</mrow></math> which can be compared with the individual accuracies:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mi>c</mi><mi>c</mi><mo>-</mo><mi>A</mi><mo>=</mo><mn>1</mn><mo>-</mo><mn>3</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mi>A</mi><mo>=</mo><mo>-</mo><mn>3</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>+</mo><mn>1</mn><mo>-</mo><mi>A</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>1</mn><mo>-</mo><mn>3</mn><mi>A</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math> At this point, the accuracy will be increased whenever<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1</mn><mo>-</mo><mn>3</mn><mi>A</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>&gt;</mo><mn>0</mn><mo> ⟺ </mo><mn>3</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>3</mn><mi>A</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mn>0.</mn>
</mrow>
</mrow></math> The discriminant of this polynomial is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>4</mn><mi>a</mi><mi>c</mi><mo>=</mo><mn>9</mn><mo>-</mo><mn>12</mn><mo>=</mo><mo>-</mo><mn>3</mn><mo>&lt;</mo><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> so all its solutions are complex and it does not cut the X axis. As the leading coefficient is positive, this polynomial is always positive and we conclude that the 3-ensemble method always improves the accuracy of the individual models.</div>
</div>
<div class="standard" id="magicparlabel-1206"><br/>
</div>
<div class="example" id="magicparlabel-1207"><div class="example_item"><span class="example_label">Example 7.4.</span>
Suppose an ensemble model with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>N</mi><mo>=</mo><mn>5</mn>
</mrow>
</mrow></math> and equal accuracy for the three models, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math>. Then, the accuracy for the ensemble model is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>A</mi><mi>c</mi><mi>c</mi><mo>=</mo><mn>1</mn><mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>=</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mrow><mo>=</mo><mn>1</mn><mo>-</mo><mn>5</mn><mo> ⋅ </mo><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup><mo>-</mo>
<mfrac>
<mrow>
<mrow><mn>5</mn><mo>!</mo>
</mrow>
</mrow>
<mrow>
<mrow><mn>2</mn><mo>!</mo><mn>3</mn><mo>!</mo>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow><mo>=</mo><mn>1</mn><mo>-</mo><mn>5</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup><mo>-</mo><mn>10</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup><mo>,</mo>
</mrow>
</mtd>
</mtr>
</mtable></math> and when compared to the individual values we obtain<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable>
<mtr>
<mtd>
<mrow><mi>A</mi><mi>c</mi><mi>c</mi><mo>-</mo><mi>A</mi>
</mrow>
</mtd>
<mtd>
<mrow><mo>=</mo><mn>1</mn><mo>-</mo><mn>5</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup><mo>-</mo><mn>10</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup><mo>-</mo><mi>A</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mrow></mrow>
</mtd>
<mtd>
<mrow><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>1</mn><mo>-</mo><mn>5</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup><mo>-</mo><mn>10</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mtd>
</mtr>
</mtable></math> This is an increased accuracy whenever<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1</mn><mo>-</mo><mn>5</mn><mi>A</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup><mo>-</mo><mn>10</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>&gt;</mo><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> which corresponds to the polynomial<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo>-</mo><mn>5</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msup><mo>+</mo><mn>5</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup><mo>+</mo><mn>5</mn>
<msup>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mo>-</mo><mn>5</mn><mi>A</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mn>0.</mn>
</mrow>
</mrow></math> The graph of this polynomial is </div>
<div class="standard" id="magicparlabel-1208" style="text-align: center;"><img alt="image: 8_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado13.png" src="8_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado13.png" style="width:60%;"/>
</div>
<div class="example_item">So for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> it is positive everywhere except the interval <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0.354</mn><mo>,</mo><mn>0.423</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>, in which it is negative. This means that the accuracy is improved in all cases outside this interval.</div>
<div class="example_item">For example, if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>=</mo><mn>0.7</mn>
</mrow>
</mrow></math>, then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mi>c</mi><mi>c</mi><mo>=</mo><mn>0.839</mn>
</mrow>
</mrow></math>, which is indeed an improvement.</div>
</div>
<div class="standard" id="magicparlabel-1211">There are several ways to make ensemble methods:</div>
<ol class="enumerate" id="magicparlabel-1212"><li class="enumerate_item"><b>Bagging</b>: the data is bootstrapped <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math> times, collecting a training data set of approximately the same size of the original data set for each model. Then, each model is trained with a different bootstrap.
<div class="standard" id="magicparlabel-1213">This approach reduces the variance, because the differences owed to the sampling are reduced by performing this sampling <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math> times. However, bagging does not improve the bias, because all the models used have the same assumptions.</div>
</li><li class="enumerate_item"><b>Boosting</b>: a weight is associated with each training instance and the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>N</mi>
</mrow></math> classifiers are trained with the use of these weights. When the classifier <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> has finished its training, those records in which the model missclassify are increased in weight, so the next model <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow></math> will be trained paying more attention to those records.
<div class="standard" id="magicparlabel-1215">With this approach, the overall bias is reduced because each model focuses on those places where the past models tend to fail. </div>
<ol class="enumerate" id="magicparlabel-1216"><li class="enumerate_item"><b>Adaboost</b>: a particular algorithm approach based on the boosting idea. Given a dataset, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math>, of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> records with label <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> :

<ol class="enumerate" id="magicparlabel-1217"><li class="enumerate_item">Set initial weights to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>k</mi>
</mrow>
</mfrac><mo>,</mo><mspace width="10px"></mspace><mi> ∀ </mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">j = 1</li>
<li class="enumerate_item">While j&lt;N

<ol class="enumerate" id="magicparlabel-1220"><li class="enumerate_item">Bootstrap <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math> to get a training set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>, select tuples with probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="enumerate_item">Train model <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="enumerate_item">Compute the error rate of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> using <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math>.</li>
<li class="enumerate_item">Update the weigths
<div class="standard" id="magicparlabel-1224">- If a tuple is misclassified: increase its weight</div>
<div class="standard" id="magicparlabel-1225">- If it is correctly classified: decrease its weight</div>
</li><li class="enumerate_item">j = j+1</li>
</ol>
</li></ol>
<div class="standard" id="magicparlabel-1227">The error rate with weights is computed as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mi>R</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ⋅ </mo><mi>e</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>M</mi><mo>,</mo><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>0</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>M</mi><mspace width="10px"></mspace><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>e</mi><mi>s</mi><mspace width="10px"></mspace><mi>X</mi><mspace width="10px"></mspace><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>l</mi><mi>y</mi>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>M</mi><mspace width="10px"></mspace><mi>m</mi><mi>i</mi><mi>s</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>e</mi><mi>s</mi><mspace width="10px"></mspace><mi>X</mi>
</mrow>
</mtd>
</mtr>
</mtable>
</mrow>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-1228">When the voting is performed, the votes are also weighted, with<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>w</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo>
<mfrac>
<mrow>
<mrow><mn>1</mn><mo>-</mo><mi>E</mi><mi>R</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>E</mi><mi>R</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>M</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
</li></ol>
</li><li class="enumerate_item"><b>Random Forest</b>: bagging does not work very well combined with decision trees, because the ID3 algorithm tends to generate similar/correlated trees. The idea here is to add randomness to the tree induction algorithm itself, as follows:

<ol class="enumerate" id="magicparlabel-1230"><li class="enumerate_item">Before each split, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>L</mi>
</mrow></math> attributes are randomly selected out of the available <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> attributes.</li>
<li class="enumerate_item">The split attribute is selected from this group of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>L</mi>
</mrow></math> attributes.</li>
</ol>
<div class="standard" id="magicparlabel-1232">When <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>L</mi>
</mrow></math> is selected to be much smalles than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math>, the trees in the forest are highly independent, so the method is able to improve the accuracy of the individual trees. Note nonetheless that in this case the individual trees will perform worse than normally trained trees, because they have been worsened on purpose.</div>
</li></ol>
<div class="standard" id="magicparlabel-1233"><br/>
</div>
<h1 class="part" id="magicparlabel-1234"><span class="part_label">Part III</span> Model validation and data preparation</h1>
<h2 class="section" id="magicparlabel-1235"><span class="section_label">8</span> Data preparation</h2>
<div class="standard" id="magicparlabel-1236">The <b>data preparation phase</b> is a multistage process that comprises several individual steps, some or all of which may be used in a given application. These steps are:</div>
<ol class="enumerate" id="magicparlabel-1237"><li class="enumerate_item"><b>Feature extraction and portability</b>: a <b>feature</b> is characteristic of the data or derived from the data. For example, if we have a sensor measuring humidity, the level of humidity will be a feature directly present in the data; the difference between the humidity level at each measure and the average humidity level is a derived feature.
<div class="standard" id="magicparlabel-1238">Features with good semantic interpretability are more desirable because this makes things easier for the analyst to understand results. So, the process of selecting which features to take into account for further analysis is called <b>feature extraction</b>.</div>
<div class="standard" id="magicparlabel-1239"><b>Data type portability</b> refers to the process of transforming data into different formats. This could have several reasons behind: we could do this because we have several sources of data which we want to unify or because we use an internal datatype that will not be compatible with what the training algorithms expect.</div>
</li><li class="enumerate_item"><b>Data cleaning</b>: missing, erroneus and inconsistent entries are treated. We can either remove them or estimate them via the process of <b>imputation</b>.</li>
<li class="enumerate_item"><b>Data reduction, selection and transformation</b>: the size of the data is reduced through data subset selection, feature subset selection, or data transformation. This helps in two ways:

<ol class="enumerate" id="magicparlabel-1242"><li class="enumerate_item">The algorithms perform more efficiently in smaller datasets.</li>
<li class="enumerate_item">The removal of irrelevant features or records improves the quality of the data mining process.</li>
</ol>
</li></ol>
<h3 class="subsection" id="magicparlabel-1244"><span class="subsection_label">8.1</span> Feature extraction</h3>
<div class="example" id="magicparlabel-1245"><div class="example_item"><span class="example_label">Example 8.1.</span>
<b>Image feature extraction</b></div>
<div class="example_item">Image data are represented as pixel. Nonetheless, we know that pixels are related between each others and that combinations of pixels carry information about what we are seeing in the image. This is not straighforward for a computer to understand, as the computer only 'sees' a matrix of triplets.</div>
<div class="example_item">At a higher level, <b>color histograms</b> can be used to represent the features in different segments of an image.</div>
<div class="example_item">Also, <b>visual words</b> are used to extract features from images. A visual word is a semantically rich representation of parts of an image.</div>
</div>
<div class="standard" id="magicparlabel-1249"><br/>
</div>
<div class="example" id="magicparlabel-1250"><div class="example_item"><span class="example_label">Example 8.2.</span>
<b>Document feature extraction</b></div>
<div class="example_item">Document data is often available in raw and unstructured form, and the data may contain rich linguistic relations between different entities. </div>
<div class="example_item">One approach is to remove stop words, stem the data, and use bag-of-words representation.</div>
<div class="example_item">Other methods use entity extraction to determine linguistic relationships. </div>
<div class="example_item"><b>Named-entity</b> <b>recognition</b> is an important subtask of information extraction. It consists in locating and classifying atomic elements in text into predefined expressions of names of persons, organizations,...</div>
</div>
<h3 class="subsection" id="magicparlabel-1255"><span class="subsection_label">8.2</span> Data Type Portability</h3>
<ul class="itemize" id="magicparlabel-1256"><li class="itemize_item"><b>Numerical to categorizal data: discretizacion</b>
<div class="standard" id="magicparlabel-1257">The process of discretization divides the ranges of the numeric attribute into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> ranges. Then, the attribute is assumed to contain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> different categorical labeled values from 1 to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-1258">Variations within a range are not ditinguishable after discretization (some information is lost).</div>
<div class="standard" id="magicparlabel-1259">One challenge is that data may be nonuniformly distributed across the different intervals. Thus, there are several ways to perform the division:</div>
<ul class="itemize" id="magicparlabel-1260"><li class="itemize_item"><b>Equi-width ranges</b>: the interval is divided into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> subintervals of equal length.</li>
<li class="itemize_item"><b>Equi-log ranges</b>: the interval is divided in such a way that the log-length is constant. If we want to divide the interval <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mi>a</mi><mo>,</mo><mi>b</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> equi-log ranges <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msubsup>
</mrow></math>, we have to ensure that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mo> log </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mspace width="10px"></mspace><mi> ∀ </mi><mi>i</mi><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Equi-depth ranges</b>: the ranges are selected so that each range has an equal number of records.</li>
</ul>
</li><li class="itemize_item"><b>Categorical to numeric data: binarization</b>
<div class="standard" id="magicparlabel-1264">Suppose a categorical attribute with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> different values. Then, we can binarize it by creating <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> attributes, and the record will have all of them set to 0, except the one corresponding to the value that it has, which will be set to 1. For example:</div>
<div class="standard" id="magicparlabel-1265" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1278">Name</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1281">Role</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1284">Pedro</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1287">CEO</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1306">Name</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1309">Role:CEO</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1312">Role:Employee</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1315">Role:Director</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1318">Pedro</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1321">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1324">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-1327">0</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="itemize_item"><b>Text to numeric data: Latent Semantic Analysis (LSA)</b>
<div class="standard" id="magicparlabel-1329">LSA transforms the text collection to a nonsparse representation with lower dimensionality. After transformation, each document <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> needs to be scaled to<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msqrt>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>²</mo>
</mrow>
</msqrt>
</mrow>
</mfrac><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> This is necessary to ensure that documents of varying length are treated in uniform way.</div>
</li><li class="itemize_item"><b>Time series to Discrete Sequence Data: Symbolic Aggregate Approximation (SAX)</b>
<div class="standard" id="magicparlabel-1331">Two steps:</div>
<ul class="itemize" id="magicparlabel-1332"><li class="itemize_item"><b>Window-based averaging: </b>the series is divided into windows of length <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>w</mi>
</mrow></math>, and the average time-series value over each window is computed.</li>
<li class="itemize_item"><b>Value-based discretization:</b> the averaged time-series values are discretized into a smaller number of equi-depth intervals. <b>Idea</b>: ensure that each symbol has an approximately equal frequency in the time-series.</li>
</ul>
</li><li class="itemize_item"><b>Time series to Numeric Data: </b>
<ul class="itemize" id="magicparlabel-1335"><li class="itemize_item"><b>Discrete Wavelet Transform (DWT)</b>: converts the time series data to multidimensional data, as a set of coefficients that represent averaged differences between different portions of the series.</li>
<li class="itemize_item"><b>Discrete Fourier Transform (DFT)</b>: similar, using Fourier series' theory.</li>
</ul>
</li><li class="itemize_item"><b>Discrete Sequence to Numeric Data:</b>
<div class="standard" id="magicparlabel-1338">Two steps:</div>
<ul class="itemize" id="magicparlabel-1339"><li class="itemize_item">Convert the discrete sequence to a set of binary time series, with as many time series as the number of values the discrete sequence can take.</li>
<li class="itemize_item">H each of these time series into a multidimensional vector using the DWT. This combines the features from the different series, creating a single multidimensional record.</li>
</ul>
</li><li class="itemize_item"><b>Spatial to Numeric Data:</b>
<div class="standard" id="magicparlabel-1342">The approach is the same as the one used for time-series data, but now there are two contextual attributes instead of one, so the DWT has to be modified to be two-dimensional.</div>
</li></ul>
<h3 class="subsection" id="magicparlabel-1343"><span class="subsection_label">8.3</span> Data Cleaning</h3>
<div class="standard" id="magicparlabel-1344">Data in the real world is</div>
<ul class="itemize" id="magicparlabel-1345"><li class="itemize_item"><b>incomplete</b>: there are values for some attributes that are missing. This can happen because some measures were not always taken of because of human/computer errors.</li>
<li class="itemize_item"><b>noisy</b>: there are errors. This can happen because the instruments used to collect data are not working properly, because errors in the data transmission occur or because of human/computer errors.</li>
<li class="itemize_item"><b>inconsistent</b>: there are discrepancies between different attributes that are related. This can happen when data from different sources needs to be combined or when some calculated values are not updated after changing their source values.</li>
<li class="itemize_item"><b>duplicate</b>: there are duplicate values.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-1349"><span class="subsubsection_label">8.3.1</span> Handling Missing and Inconsistent entries</h4>
<div class="standard" id="magicparlabel-1350">We can:</div>
<ul class="itemize" id="magicparlabel-1351"><li class="itemize_item">Delete the entire record: this is a safe option, because we don't introduce bias, but it usually not practical, because we might delete too many entries.</li>
<li class="itemize_item">Impute/estimate the missing values: we use the rest of the data to estimate the values that are missing or choose some constant based on some assumption. The problem with this approach is that one way or another we are introducing bias in the data.</li>
<li class="itemize_item">Change the mining algorithm: there are some algorithms that are developed to deal with missing values.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-1354"><span class="subsubsection_label">8.3.2</span> Handling Noisy entries</h4>
<div class="standard" id="magicparlabel-1355">We can:</div>
<ul class="itemize" id="magicparlabel-1356"><li class="itemize_item">Perform kernel smoothing: for numerical data, we can use a kernel function to smooth the data values.

<ul class="itemize" id="magicparlabel-1357"><li class="itemize_item">kNN smoother: replaces each value with the average of itself and its k-nearest neighbors.</li>
<li class="itemize_item">kernel average smoother: replace a value with the weighted average of itself and its neighbors in a fixed size window.</li>
</ul>
</li><li class="itemize_item">Binning: it is also possible to sort the data and partition it into equally sized bins. Then, the data can be smoothed by the bin mean, median or boundary values.</li>
<li class="itemize_item">Regression: smooth by fitting the data to a regression function.</li>
<li class="itemize_item">Change the mining algorithm: there are algorithms designed to tolerate noise.</li>
</ul>
<h3 class="subsection" id="magicparlabel-1362"><span class="subsection_label">8.4</span> Exploratory analysis</h3>
<div class="standard" id="magicparlabel-1363">Exploratory analysis is the task to understand the data, from the meaning of the features, to their range of values or even their statistical distributions. There are many actions we can do to explore the data, such as counting nulls, searching for repetition, compute some statistics as the maximum, the minimum, the mean,... of the data, and many more.</div>
<h4 class="subsubsection" id="magicparlabel-1364"><span class="subsubsection_label">8.4.1</span> Central tendency measures</h4>
<div class="standard" id="magicparlabel-1365">Central tendency measures are a 1 number summary that can be helpful:</div>
<ul class="itemize" id="magicparlabel-1366"><li class="itemize_item">Mean:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>X</mi>
</mrow><mo stretchy="true">¯</mo>
</mover><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow>
<msub><mrow></mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mi>N</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Weighted mean:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mover>
<mrow><mi>X</mi>
</mrow><mo stretchy="true">˜</mo>
</mover><mo>=</mo>
<mfrac>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mo> ∑ </mo>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item">Trimmed mean: a mean calculated disregarding extreme values.</li>
<li class="itemize_item">Median: the middle value of the data.</li>
<li class="itemize_item">Mode: value that occurs most frequently in the data.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-1371"><span class="subsubsection_label">8.4.2</span> Symmetric and Skewed data</h4>
<div class="standard" id="magicparlabel-1372">Using the mean, median and mode, we can understand in a soft way the distribution of the data:</div>
<ul class="itemize" id="magicparlabel-1373"><li class="itemize_item">If the three values are very similar, then the distribution is very symmetric, having this values in the center.</li>
<li class="itemize_item">If the order is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>M</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>&lt;</mo><mi>M</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>a</mi><mi>n</mi><mo>&lt;</mo><mi>M</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo>,</mo>
</mrow>
</mrow></math> then the distribution is skewed to the left.</li>
<li class="itemize_item">If the order is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>M</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo>&lt;</mo><mi>M</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>a</mi><mi>n</mi><mo>&lt;</mo><mi>M</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>,</mo>
</mrow>
</mrow></math> then the distribution is skewed to the right.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-1376"><span class="subsubsection_label">8.4.3</span> Measuring the dispersion</h4>
<ul class="itemize" id="magicparlabel-1377"><li class="itemize_item">Quartiles: the Q1 (25th percentile) and Q3 (75th) percentile.</li>
<li class="itemize_item">Inter-quartile range:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>Q</mi><mi>R</mi><mo>=</mo>
<msub>
<mrow><mi>Q</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Q</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mrow></math></li>
<li class="itemize_item">Five number summary: minimum, Q1, median, Q3, maximum.</li>
<li class="itemize_item">Boxplot: the median is marked and there is a box around it which ends in the queartiles. Outliers are plotted individually.</li>
<li class="itemize_item">Outlier: a value that lies outside the range <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1.5</mn><mo> × </mo><mi>I</mi><mi>Q</mi><mi>R</mi>
</mrow>
</mrow></math>.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-1382"><span class="subsubsection_label">8.4.4</span> Comparing with the normal distribution</h4>
<div class="standard" id="magicparlabel-1383">We can compute the mean <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> μ </mi>
</mrow></math> and the standard deviation <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> σ </mi>
</mrow></math> and check if the data behaves as a normal distribution:</div>
<ul class="itemize" id="magicparlabel-1384"><li class="itemize_item">In <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo><mi> σ </mi><mo>,</mo><mi> μ </mi><mo>+</mo><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> there is about 68% of the data.</li>
<li class="itemize_item">In <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo><mn>2</mn><mi> σ </mi><mo>,</mo><mi> μ </mi><mo>+</mo><mn>2</mn><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> there is about 96% of the data.</li>
<li class="itemize_item">In <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi> μ </mi><mo>-</mo><mn>3</mn><mi> σ </mi><mo>,</mo><mi> μ </mi><mo>+</mo><mn>3</mn><mi> σ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> there is about 99.7% of the data.</li>
</ul>
<div class="standard" id="magicparlabel-1387">We can also perform the Kolmogorov-Smirnov test or the Shapiro-Wilk test, which are statistical test that try to assess is a distribution is normal.</div>
<h3 class="subsection" id="magicparlabel-1388"><span class="subsection_label">8.5</span> Similarity and Distance</h3>
<div class="standard" id="magicparlabel-1389">There are many data mining algorithms which uses the notions of similarity or distance between two points. Usually, the selection of the distance function is an important decision before using an algorithm, because it will ultimately influence the results and their implications.</div>
<div class="standard" id="magicparlabel-1390"><div class="flex_color_box"><div class="definition" id="magicparlabel-1394"><div class="definition_item"><span class="definition_label">Definition 8.1.</span>
The <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold">
<msub>
<mrow><mi>L</mi>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msub></mstyle>
</mrow></math><b>-norm</b> is a distance function defined by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>p</mi>
</mrow>
</mfrac>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="definition_item">For <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math> it is the well-known Euclidean distance.</div>
<div class="definition_item">For <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>p</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math> it is called the Manhattan distance, because it is like traversing a grid made of rectangles, similar to the streetmap of Manhattan.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-1397"><div class="flex_color_box"><div class="definition" id="magicparlabel-1401"><div class="definition_item"><span class="definition_label">Definition 8.2.</span>
The <b>generalized Minkowski distance</b> is defined by<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>a</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ⋅ </mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>p</mi>
</mrow>
</mfrac>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> </div>
</div>
</div></div>
<div class="remark" id="magicparlabel-1402"><div class="remark_item"><span class="remark_label">Remark 8.1.</span>
As we can see Minkowski is a weighted <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>L</mi>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msub>
</mrow></math>-norm. This is useful in context where some features are more important than others, so they can have a higher weight in the distance measures.</div>
</div>
<div class="standard" id="magicparlabel-1403"><br/>
</div>
<div class="remark" id="magicparlabel-1404"><div class="remark_item"><span class="remark_label">Remark 8.2.</span>
Generally, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> is set to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math>, the number of dimensions of the data.</div>
</div>
<div class="standard" id="magicparlabel-1405"><br/>
</div>
<div class="remark" id="magicparlabel-1406"><div class="remark_item"><span class="remark_label">Remark 8.3.</span>
Multidimensional data has normally different scales for the different dimensions, resulting in features dominating others in distance computations. To solve this issue we can do <b>normalization</b> and <b>scaling.</b></div>
<ul class="itemize" id="magicparlabel-1407"><li class="itemize_item">Normalization is to replace each value <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> with<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mi>Z</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msubsup><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msubsup><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is the mean of the attribute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>j</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> its standard deviation.</li>
<li class="itemize_item">Scaling maps the values to the range <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msubsup><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msubsup>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msubsup><mo>-</mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
</div>
<div class="standard" id="magicparlabel-1409"><div class="flex_color_box"><div class="definition" id="magicparlabel-1413"><div class="definition_item"><span class="definition_label">Definition 8.3.</span>
The <b>edit distance</b> is a distance defined over strings. </div>
<div class="definition_item">We have the operators:</div>
<ul class="itemize" id="magicparlabel-1415"><li class="itemize_item">r: replace one character by another.</li>
<li class="itemize_item">i: insert one character.</li>
<li class="itemize_item">d: delete one character.</li>
</ul>
<div class="definition_item">The edit distance between two strings <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> is the minimum amount of operations needed to convert <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math>.</div>
<div class="definition_item">The formula is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mn>0</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mn>0</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mn>1</mn><mo>+</mo><mo> min </mo><mo fence="true" form="prefix" lspace="thinmathspace" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd>
<mrow><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd>
<mrow><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mtd>
</mtr>
</mtable><mo fence="true" form="postfix" lspace="thinmathspace" stretchy="true" symmetric="true">}</mo>
</mrow>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>t</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>s</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is the string <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>s</mi>
</mrow></math> minus its first character.</div>
</div>
</div></div>
<div class="remark" id="magicparlabel-1420"><div class="remark_item"><span class="remark_label">Remark 8.4.</span>
If the edit distance is computed recursively, its complexity measures are:</div>
<ul class="itemize" id="magicparlabel-1421"><li class="itemize_item">Time: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Space: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Backtrace (length of the longest backtracking path): <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
</ul>
</div>
<div class="standard" id="magicparlabel-1424"><br/>
</div>
<div class="remark" id="magicparlabel-1425"><div class="remark_item"><span class="remark_label">Remark 8.5.</span>
If we do it with dynamic programming, with the algorithm in Algorithm <a href="#alg_DP_Edit_s1__s2_">3</a>, then its complexity measures are:</div>
<ul class="itemize" id="magicparlabel-1426"><li class="itemize_item">Time: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Space: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Backtrace: 0.</li>
</ul>
</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">for i=1 to |s1| do
	for j=1 to |s2| do
		m[i,j] = min{m[i-1,j-1] + if[(s1[i] = s2[j] then 0 else 1],
					 m[i-1,j] + 1,
					 m[i,j-1] +1
					}
return m[|s1|,|s2|]</pre></div>
<div class="plain_layout" id="magicparlabel-1444"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 3:  <a id="alg_DP_Edit_s1__s2_"></a>
DP_Edit(s1, s2)</span></div>
</div>
<div class="remark" id="magicparlabel-1449"><div class="remark_item"><span class="remark_label">Remark 8.6.</span>
There is a further improvement that can be made. If we perform the dynamic programming only using rows or columns, then we only need to store two of them: the current one and the previous one. The complexity measures in this case are:</div>
<ul class="itemize" id="magicparlabel-1450"><li class="itemize_item">Time: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo> × </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Space: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo> min </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Backtrace: 0.</li>
</ul>
</div>
<div class="standard" id="magicparlabel-1453"><br/>
</div>
<h2 class="section" id="magicparlabel-1454"><span class="section_label">9</span> Model evaluation<a id="sec_Model_evaluation"></a>
</h2>
<div class="standard" id="magicparlabel-1455">Once we have trained a model, we want to assess how well it performs. This way, we can compare different models and discuss, quantitatively, which of them is preferrable for our purposes. Nonetheless, this task is not easy, and there are both methodological and quantification issues to take into account:</div>
<ul class="itemize" id="magicparlabel-1456"><li class="itemize_item"><b>Methodological issues</b>: associated with dividing the labeled data appropriately into training and test segments for evaluation. The choice of methodology has a direct impact on the evaluation process, such as underestimation or overestimation of classifier accuracy. Several approaches are possible: <b>holdout</b>, <b>bootstrap</b> and <b>cross-validation</b>.</li>
<li class="itemize_item"><b>Quantification issues</b>: associated with providing a numercial measure for the quality of the method after a specific methodology for evaluation has been selected.</li>
</ul>
<h3 class="subsection" id="magicparlabel-1458"><span class="subsection_label">9.1</span> Holdout</h3>
<div class="standard" id="magicparlabel-1459">The labeled data is randomly divided into two disjoint sets, corresponding to the training and test data. The training data is used to feed the training algorithm and produce a model, whose performance is assessed using the test data.</div>
<div class="standard" id="magicparlabel-1460">The approach can be repeated several times with multiple samples to provide a final estimate.</div>
<ul class="itemize" id="magicparlabel-1461"><li class="itemize_item"><b>Problem</b>: classes that are overrepresented in the training data are underrepresented in the test data. This can have a significant impact when the original class distribution is imbalanced. The error estimates are pessimistic.</li>
</ul>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-1466" style="text-align: center;"><img alt="image: 9_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado6.png" src="9_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado6.png"/>
</div>
<div class="plain_layout" id="magicparlabel-1467"><span class="float-caption-Standard float-caption float-caption-standard">Figure 1:  Holdout visualization.</span></div>
</div>
<h3 class="subsection" id="magicparlabel-1472"><span class="subsection_label">9.2</span> Cross-Validation</h3>
<div class="standard" id="magicparlabel-1473">The labeled data is divided into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> disjoint subsets of equal size <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</mfrac>
</mrow></math>. A typical choice of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> is around 10. One of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> segments is used for testing, and the other <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>m</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> segments are used for training. This approach is repeated by selecting each of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> different segments in the data as test set.</div>
<div class="standard" id="magicparlabel-1474">The average accuracy over the different test sets is then reported.</div>
<div class="standard" id="magicparlabel-1475">The overall accuracy of the cross.validation procedure tends to be a highly representative, but pessimistic estimate, of model accuracy.</div>
<div class="standard" id="magicparlabel-1476">When <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> is chosen to be <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mo>=</mo><mi>n</mi>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> examples are used for training, and one example is used for testing. This is called <b>leave-one-out cross-validation</b>. This approach is very expensive for large datasets.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-1481" style="text-align: center;"><img alt="image: 10_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado7.png" src="10_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado7.png"/>
</div>
<div class="plain_layout" id="magicparlabel-1482"><span class="float-caption-Standard float-caption float-caption-standard">Figure 2:  Cross-Validation visualization. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mo>=</mo><mn>3</mn>
</mrow>
</mrow></math>.</span></div>
</div>
<div class="standard" id="magicparlabel-1487"><b>Stratified cross-validation</b> uses proportional representation of each class in the different folds and usually provides less pessimistic results.</div>
<h3 class="subsection" id="magicparlabel-1488"><span class="subsection_label">9.3</span> Bootstrap</h3>
<div class="standard" id="magicparlabel-1489">The labeled data is sampled uniformly with replacement, to create a training dataset, which can contain duplicates. The labeled data of size <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> is sampled <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> times with replacement.</div>
<div class="standard" id="magicparlabel-1490">The probability that a particular point is not included in a sample is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> Therefore, the probability that the point is not included in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> samples is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub><mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> For large values of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math>, this approximates <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>e</mi>
</mrow>
</mfrac>
</mrow></math>. Thus, the fraction of the labeled data points included at elast once in the training dataset is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>1</mn><mo>-</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>e</mi>
</mrow>
</mfrac>
</mrow>
</mrow></math>. </div>
<div class="standard" id="magicparlabel-1491">The overall accuracy is computed using the original set of full labeled data as the test examples.</div>
<div class="standard" id="magicparlabel-1492">The estimate is highly optimistic of the true classifier accuracy because of the large overlap between the training and test examples.</div>
<div class="standard" id="magicparlabel-1493">A better strategy is the <b>leave-one-out bootstrap</b>, in which the accuracy of each labeled instance is computed using the classifier performance on only the subset of the bootstraped samples in which the instance is not part of.</div>
<div class="standard" id="magicparlabel-1494">This approach provides a pessimistic accuracy estimate, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>l</mi>
</mrow>
</msub>
</mrow></math>, given by the mean value of the accuracy computed for each labeled instance.</div>
<div class="standard" id="magicparlabel-1495">The <b>0.632-bootstrap</b> improves the accuracy estimate with a compromise approach. The average training-data accuracy <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>t</mi>
</mrow>
</msub>
</mrow></math> over <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>b</mi>
</mrow></math> bootstrapped samples is computed. This is a highly optimistic estimate. The overall accuracy is a weighted average of the leave-one-out accuracy and the training-data accuracy:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>0.632</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>l</mi>
</mrow>
</msub><mo>+</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>0.368</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mi>t</mi>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-1496"><br/>
</div>
<h1 class="part" id="magicparlabel-1497"><span class="part_label">Part IV</span> Clustering</h1>
<div class="standard" id="magicparlabel-1498">Some applications require to divide the data into different groups, that share some characteristics. The problem many of these times is that we don't know which characteristics or at how much extend are useful to characterize the data. The general (unsupervised) approach to tackle this problem is <b>clustering</b>.</div>
<div class="standard" id="magicparlabel-1499"><div class="flex_color_box"><div class="definition" id="magicparlabel-1503"><div class="definition_item"><span class="definition_label">Definition 9.1.</span>
<b>Clustering problem (Informal)</b></div>
<div class="definition_item">Given a set of data points, partition them into groups containing similar data points.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-1505">This definition is informal and general, but gives enough information to understand the problem, as well as enough freedom to tackle it from different perspectives.</div>
<h2 class="section" id="magicparlabel-1506"><span class="section_label">10</span> Representative-Based Algorithms</h2>
<div class="standard" id="magicparlabel-1507">These are the simplest of all clustering algorithms, as they directly use distances or similarities to cluster the data. They not capture hierarchical relationships and use a set of <b>representatives</b> to cluster the data. The main insight is that the discovery of good clusters equates to the discovery of good representatives.</div>
<div class="standard" id="magicparlabel-1508"><div class="flex_color_box"><div class="definition" id="magicparlabel-1512"><div class="definition_item"><span class="definition_label">Definition 10.1.</span>
<b>Representative-Based general clustering problem</b></div>
<div class="definition_item">Given a data set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> data points <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math> in a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math>-dimensional space and a specified number of clusters, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>, the goal of a representative-based algorithm is to determine <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> representatives <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math> such that the objective function<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mspace width="10px"></mspace><mi>D</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> is minimized, i.e., the sum of the distances of the different data points to their closest representative needs to be miminized.</div>
</div>
</div></div>
<div class="remark" id="magicparlabel-1514"><div class="remark_item"><span class="remark_label">Remark 10.1.</span>
The representatives <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and the optimal assigmnent of data points to representatives are unknown a priori, but they depend on each other in a circular way. This fact allows us to develop a iterative approach to solve the problem.</div>
</div>
<div class="standard" id="magicparlabel-1515">The <b>generic <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-representative approach</b> is as in Listing <a href="#alg_Generic_k_representative_approach">4</a>.</div>
<div class="float-algorithm"><div class="plain_layout" id="magicparlabel-1520"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 4:  <a id="alg_Generic_k_representative_approach"></a>
Generic <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-representative approach (Data D, int k, threshold eps) : Set of representatives Y and Clusters C</span></div>
<div class="float-listings"><pre class="listings">Initialize Y = {Y_1,...,Y_k} &lt;@\textcolor{purple}{\#Using heuristics}&lt;@
Initialize clusters C_1 = {},... C_k = {}
do
# Assign step
	for(X in D):
		assign X to Y_j such that &lt;@\textcolor{blue}{$Dist(X,Y_j) = \min_i Dist(X,Y_i)$}&lt;@
		C_j.add(X)
	
# Optimize step
	for all Clusters C_j:
		determine Y_j' such that 
			&lt;@\textcolor{blue}{$\sum_{X_i \in C_j} Dist(X_i,Y_j')$}&lt;@
		is minimized
		Y_j = Y_j'

while &lt;@$O=\sum_{i=1}^{n}\left[\min_{j}\ Dist\left(X_{i},Y_{j}\right)\right]$&lt;@ &gt; eps
return {C_1, Y_1},...,{C_k, Y_k}
	</pre></div>
</div>
<div class="remark" id="magicparlabel-1546"><div class="remark_item"><span class="remark_label">Remark 10.2.</span>
The idea is to improve the objective function over multiple iterations. The increase is usually greater in early iterations, and decreases rapidly.</div>
</div>
<div class="standard" id="magicparlabel-1547"><br/>
</div>
<div class="remark" id="magicparlabel-1548"><div class="remark_item"><span class="remark_label">Remark 10.3.</span>
The main computational bottleneck is the assignment step, where distances need to be computed between all point to the representatives.</div>
</div>
<h3 class="subsection" id="magicparlabel-1549"><span class="subsection_label">10.1</span> The k-Means algorithm</h3>
<div class="standard" id="magicparlabel-1550">The <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>-</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mi>s</mi>
</mrow>
</mrow></math> algorithm is a representative clustering method in which the distance used is the squared Euclidean distance (or squared <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>L</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>-</mo>
</mrow>
</mrow></math>norm):<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mn>.</mn>
</mrow>
</mrow></math> Thus, the objective function minimizes the sum of square errors over the data points, this is called the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>S</mi><mi>E</mi>
</mrow>
</mrow></math> (Sum of Squared Errors).</div>
<div class="standard" id="magicparlabel-1551"><div class="flex_color_box"><div class="proposition" id="magicparlabel-1555"><div class="proposition_item"><span class="proposition_label">Proposition 10.1.</span>
The optimal representative <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> for each of the optimize iterative steps is the mean of the data points in cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>.</div>
</div>
</div></div>
<div class="proof" id="magicparlabel-1556"><div class="proof_item"><span class="proof_label">Proof.</span>
In the current step, we have a fixed clustering asssignment from the last step, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. The overall clustering objective function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<msubsup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msubsup><mo>,</mo>
</mrow>
</mrow></math> so its gradient for each <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>2</mn>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> When imposing the gradient equals to 0 (for optimization purposes), we get <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo><mn>0</mn><mo>,</mo>
</mrow>
</mrow></math> or, equivalently, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> ⟹ </mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mo>=</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="remark" id="magicparlabel-1557"><div class="remark_item"><span class="remark_label">Remark 10.4.</span>
Note that the obtained representatives could be a point which is not a point in the data. This property sometimes is undesirable.</div>
</div>
<div class="standard" id="magicparlabel-1558"><br/>
</div>
<div class="remark" id="magicparlabel-1559"><div class="remark_item"><span class="remark_label">Remark 10.5.</span>
Note also that for the proof, we have suposed a numerical attribute. Computing the mean of different (for example) texts does not seem easy (think for example in the words <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>r</mi><mi>e</mi><mi>g</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi>
</mrow>
</mrow></math>, they could be certainly clustered inside <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mspace width="10px"></mspace><mi>m</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="10px"></mspace><mi>t</mi><mi>e</mi><mi>c</mi><mi>h</mi><mi>n</mi><mi>i</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi>
</mrow>
</mrow></math>, but the latter is hardly the mean of the two former words).</div>
</div>
<div class="standard" id="magicparlabel-1560"><br/>
</div>
<div class="remark" id="magicparlabel-1561"><div class="remark_item"><span class="remark_label">Remark 10.6.</span>
Regarding time complexity:</div>
<ul class="itemize" id="magicparlabel-1562"><li class="itemize_item">The assign step is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo> ⋅ </mo><mi>k</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> as we have to compute for each point, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> distances.</li>
<li class="itemize_item">The optimize step is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>n</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, as we have to compute the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> different means using all <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> points.</li>
<li class="itemize_item">Overall, then, it is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo> ⋅ </mo><mi>k</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> per iteration. But usually few iterations are needed.</li>
</ul>
</div>
<div class="standard" id="magicparlabel-1565"><br/>
</div>
<div class="remark" id="magicparlabel-1566"><div class="remark_item"><span class="remark_label">Remark 10.7.</span>
Disadvantages:</div>
<ul class="itemize" id="magicparlabel-1567"><li class="itemize_item">All points are clustered and taken into account equally for the objective function. This makes <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>-</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mi>s</mi>
</mrow>
</mrow></math> sensitive to outliers, which introduces bias.</li>
<li class="itemize_item">In some situations we cannot compute the mean of the data points (as the previous example).</li>
<li class="itemize_item">We need to know <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> in advance.</li>
<li class="itemize_item">As we are minimizing the Euclidean distance, the algorithm is biased towards finding spherical clusters, because the sphere is the shape whose maximum distance to its center is constant:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>S</mi>
</mstyle>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>y</mi><mo>,</mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>x</mi><mo> ∈ </mo>
<msup>
<mrow>
<mstyle mathvariant="double-struck"><mi>R</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msup><mo>:</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow>
<mrow><mi>n</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>y</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo> ≤ </mo>
<msup>
<mrow><mi>r</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
</ul>
</div>
<div class="example" id="magicparlabel-1571"><div class="example_item"><span class="example_label">Example 10.1.</span>
Apply the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>-</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mi>s</mi>
</mrow>
</mrow></math> algorithm with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>3</mn>
</mrow>
</mrow></math> to the dataset<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mo>,</mo><mn>10</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>8</mn><mo>,</mo><mn>4</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>4</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>5</mn><mo>,</mo><mn>8</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>5</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>7</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>6</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>6</mn><mo>,</mo><mn>4</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>7</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>1</mn><mo>,</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>8</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>4</mn><mo>,</mo><mn>9</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> and using the seed <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>5</mn>
</mrow>
</msub><mo>,</mo><mspace width="10px"></mspace>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>6</mn>
</mrow>
</msub>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>A</mi>
</mrow>
<mrow><mn>8</mn>
</mrow>
</msub>
</mrow>
</mrow></math>.</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1679" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_1_images/figure_0.eps"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1765" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_1_images/figure_1.eps"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1846" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_1_images/figure_2.eps"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-1928" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_1_images/figure_3.eps"/>
</div>
<div class="example_item"></div>
</div>
<h3 class="subsection" id="magicparlabel-1975"><span class="subsection_label">10.2</span> The k-Medians Algorithm</h3>
<div class="standard" id="magicparlabel-1976">In this case the Manhattan distance (<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>L</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math>-norm) is used:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-1977"><div class="flex_color_box"><div class="proposition" id="magicparlabel-1981"><div class="proposition_item"><span class="proposition_label">Proposition 10.2.</span>
The optimal representative <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> for each of the optimize iterative steps is the median of the data points along each dimension in cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>.</div>
</div>
</div></div>
<div class="proof" id="magicparlabel-1982"><div class="proof_item"><span class="proof_label">Proof.</span>
In this case, the objective function is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mn>.</mn>
</mrow>
</mrow></math> Now, the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>L</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math>-norm is obtained by summing the absolute value in each dimension. The problem is that this function is not differentiable. Nonetheless, it is differentiable almost everywhere. We can obtain the sub-gradient of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>O</mi>
</mrow></math> with respect to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow><mi>d</mi>
</mrow>
<mrow>
<mrow><mi>d</mi>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</mfrac><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>Y</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> For this to equal 0, we need as many negative signs as positive signs: the median in each direction achieves exactly this, as it has as many values to its left as to its right.</div>
</div>
<div class="example" id="magicparlabel-1983"><div class="example_item"><span class="example_label">Example 10.2.</span>
Repeat the example using the k-Medians algorithm.</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2058" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_2_images/figure_0.eps"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2082" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_2_images/figure_1.eps"/>
</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2105" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example7_2_images/figure_2.eps"/>
</div>
<div class="example_item"></div>
</div>
<h3 class="subsection" id="magicparlabel-2148"><span class="subsection_label">10.3</span> The k-Medoids Algorithm</h3>
<div class="standard" id="magicparlabel-2149">In this algorithm the representatives are always selected from the database <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math>, and this makes the structure of the algorithm different from the one we have seen before.</div>
<div class="standard" id="magicparlabel-2150">Reasons:</div>
<ul class="itemize" id="magicparlabel-2151"><li class="itemize_item">This approach makes outlier handling easier than with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-means.</li>
<li class="itemize_item">It is sometimes difficult to compute the central representative of a complex data type (text or categorical data). The <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-medoids algorithm can be defined in any datatype in which we are able to define a proper distance function.</li>
</ul>
<div class="standard" id="magicparlabel-2153">The algorithm is as in Algorithm <a href="#alg_k_medoids">5</a>.</div>
<div class="float-algorithm"><div class="plain_layout" id="magicparlabel-2158"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 5:  <a id="alg_k_medoids"></a>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-medoids(Data D, int k, threshold eps) : Set of representatives Y and Clusters C</span></div>
<div class="float-listings"><pre class="listings">Initialize Y = {Y_1,...,Y_k} &lt;@\textcolor{purple}{\#Using heuristics}&lt;@
Initialize clusters C_1 = {},... C_k = {}
do
# Assign step
	for(X in D):
		assign X to Y_j such that &lt;@\textcolor{blue}{$Dist(X,Y_j) = \min_i Dist(X,Y_i)$}&lt;@
		C_j.add(X)
	
# Optimize step
	Determine a pair X_i in D and Y_j in Y such that 
		replacing Y_j with X_i leads to the 
		greatest possible improvement in the objective function

	Perform the exchange between X_i and Y_j only if improvement is positive.

while &lt;@$O=\sum_{i=1}^{n}\left[\min_{j}\ Dist\left(X_{i},Y_{j}\right)\right]$&lt;@ &gt; eps 
		or no improvement in current iteration
return {C_1, Y_1},...,{C_k, Y_k}
	</pre></div>
</div>
<div class="remark" id="magicparlabel-2185"><div class="remark_item"><span class="remark_label">Remark 10.8.</span>
In this algorithm we use a hill climbing strategy to obtain the best representatives.</div>
</div>
<div class="standard" id="magicparlabel-2186"><br/>
</div>
<div class="remark" id="magicparlabel-2187"><div class="remark_item"><span class="remark_label">Remark 10.9.</span>
We can try all possible changes or sample points from the database to try with. The latter approach is often more desirable for time issues.</div>
</div>
<h3 class="subsection" id="magicparlabel-2188"><span class="subsection_label">10.4</span> Practical issues</h3>
<ul class="itemize" id="magicparlabel-2189"><li class="itemize_item">The initialization of the initial representative is not a trivial task. Normally they are selected randomly among the points of the datasets and most times the initialization step does not change the outcome of the algorithm: the representative based algorithm are very robust to this selection. Nonetheless, sometimes suboptimal clusters arise because of a bad choice of initial representatives.</li>
<li class="itemize_item">Outliers can make a detrimental impact on the algorithms. If one outlier is selected as initial representative it is possible to obtain a singleton cluster with no meaning for the application.</li>
<li class="itemize_item">The number of clusters, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>, is difficult to determine using automated methods. As it is not known a priori, a common approach is to start with larger values for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> than the one we think should be correct. Some natural clusters may split, but we can merge some of them as a postprocessing step.</li>
</ul>
<h2 class="section" id="magicparlabel-2192"><span class="section_label">11</span> Grid and Density based Algorithms</h2>
<div class="standard" id="magicparlabel-2193">One of the major problems with distance-based algorithms is that the shape of the clusters is implicitly enforced by the distance function. Thus, it can be hard to detect natural cluster of arbitrary form.</div>
<div class="standard" id="magicparlabel-2194"><b>Density-based algorithms</b> are useful for this. The idea is to identify dense regions in the data, and use the positions of the different regions to determine the clusters.</div>
<h3 class="subsection" id="magicparlabel-2195"><span class="subsection_label">11.1</span> Grid-based methods</h3>
<div class="standard" id="magicparlabel-2196">The data is discretized into <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> intervals, typically equi-width. If the data has <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>d</mi>
</mrow></math> dimensions, we will obtain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
</mrow></math> hyper-cubes. These are the building blocks for the clusters.</div>
<div class="standard" id="magicparlabel-2197">A <b>density threshold <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> </b>is used to determine the dense hyper-cubes. In most real data-sets, an arbitrarily shaped cluster will result in multiple dense regions connected together by a side or a corner.</div>
<div class="standard" id="magicparlabel-2198">Two hyper-cubes are said to be <b>adjacently connected</b> if they share a side (sometimes corners are also considered).</div>
<div class="standard" id="magicparlabel-2199">Two hyper-cubes are said to be <b>density connected</b> if a path can be found from one to another containing only a sequence of adjacently connected grid regions.</div>
<div class="standard" id="magicparlabel-2200">The <b>goal</b> is to determine the density connected regions. Using a graph representation, the problem is equivalent to finding the connected components of the graph, being the hyper-cubes the nodes and an edge is defined between every pair of adjacent cubes.</div>
<div class="standard" id="magicparlabel-2201"><div class="flex_color_box"><div class="plain_layout" id="magicparlabel-2205"><b>Advantages</b></div>
<div class="plain_layout" id="magicparlabel-2206">The number of clusters is not pre-defined, so we don't need to bother with the estimation of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>.</div>
<div class="plain_layout" id="magicparlabel-2207"><b>Disadvantages</b></div>
<div class="plain_layout" id="magicparlabel-2208">We have to define <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math>, which is not easy. </div>
<ul class="itemize" id="magicparlabel-2209"><li class="itemize_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> (number of ranges) is too small, the data points from multiple clusters will be present in the same hyper-cube. We will obtain undesired merged clusters.</li>
<li class="itemize_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> is too large, there will be many empty grid cells, so we may split a natural cluster. It also will be computationally expensive.</li>
<li class="itemize_item">The choice of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> has similar consecuences.</li>
</ul>
<div class="plain_layout" id="magicparlabel-2212">Also, if the clusters present different densities, it is even more difficult to determine <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>p</mi>
</mrow></math> because each cluster is 'asking' for different values.</div>
</div></div>
<div class="standard" id="magicparlabel-2213">The generic algorithm is as follows:</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">Discretize each dimension into p ranges
Determine grid cells at density level tau
Create graph in which dense grids are connected if they are adjacent
Determine connected components of the graph
return points in each connected component as a cluster</pre></div>
<div class="plain_layout" id="magicparlabel-2226"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 6:  GenericGrid(Data D, Ranges p, Density tau) : clusters C</span></div>
</div>
<h3 class="subsection" id="magicparlabel-2231"><span class="subsection_label">11.2</span> DBSCAN</h3>
<div class="standard" id="magicparlabel-2232">The idea behind DBSCAN is similar to the one we have seen, but density is considered at a pointwise level:</div>
<div class="standard" id="magicparlabel-2233">The <b>density of a data point</b> is defined as the number of points that lie within a radius <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>p</mi><mi>s</mi>
</mrow>
</mrow></math> from it, i.e. their neighbourhood of radius <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math>. The densities are used to classify the points:</div>
<ul class="itemize" id="magicparlabel-2234"><li class="itemize_item"><b>Core point</b>: its neighbourhood contains at least <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> points.</li>
<li class="itemize_item"><b>Border point</b>: its neighbourhood contains less than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> points, but it contains one or more core points.</li>
<li class="itemize_item"><b>Noise points</b>: any other case.</li>
</ul>
<div class="standard" id="magicparlabel-2237">And we define some relations between points:</div>
<ul class="itemize" id="magicparlabel-2238"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> are <b>directly density reachable</b> if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is a core point, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is in the neighbourhood of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> are <b>density reachable</b> is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is a core point, and there exists a chain of core points <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow>
<mrow><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> are directly density reachable for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mi>i</mi><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is in the neighbourhood of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> are <b>density connected</b> if both <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> are density reachable from some point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math></li>
</ul>
<div class="standard" id="magicparlabel-2241">After the points have been classified, a connectivity graph is constructed as a maximal set of points that are all reachable from one another under any of these definitions.</div>
<div class="standard" id="magicparlabel-2242">Now, we identify the connected components of the graph, which are the clusters.</div>
<div class="standard" id="magicparlabel-2243">The detailed algorithm is as follows:</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">Clusters = {}
for each unvisited point P in D
	Neihbourhood = regionQuery(P, eps)
	if sizeof(Neihbourhood) &lt; tau
		mark P as visited
	else
		C = next cluster
		expandCluster(P, Neighbourhood, C, eps, tau)
		if C not in Clusters
			Clusters.add(C)
return Clusters

function expandCluster(P, Neighbourhood, C, eps, tau)
	mark P as visited
	C.add(P)
	for Q in Neighbourhood
		if Q not visited
			mark Q as visited
			Neighbourhood_Q = regionQuery(Q, eps)
			if sizeof(Neighbourhood_Q &gt;= tau)
				Neighbourhood.addAll(Neighbourhood_Q)
			if Q is not in any cluster
				C.add(Q)</pre></div>
<div class="plain_layout" id="magicparlabel-2275"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 7:  DBSCAN(Data D, Radius eps, Density tau) : clusters C</span></div>
</div>
<div class="standard" id="magicparlabel-2280"><div class="flex_color_box"><div class="plain_layout" id="magicparlabel-2284"><b>Advantages</b></div>
<div class="plain_layout" id="magicparlabel-2285">This method is not very different from the graph method, and it can also discover clusters of any shape, without the need of knowing the number of clusters in advance.</div>
<div class="plain_layout" id="magicparlabel-2286"><b>Disadvantages</b></div>
<div class="plain_layout" id="magicparlabel-2287">Again, determining the correct values for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>p</mi><mi>s</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> is a complex task. Also, the existence of clusters with different densities makes it even harder.</div>
</div></div>
<div class="standard" id="magicparlabel-2288"><div class="flex_color_box"><div class="plain_layout" id="magicparlabel-2297">The major time complexity is finding the neighbours: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msup>
<mrow><mi>n</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
<div class="plain_layout" id="magicparlabel-2298">In some special cases, an spatial index can reduce it to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>n</mi><mo> ⋅ </mo><mo> log </mo><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</div>
</div></div>
<div class="remark" id="magicparlabel-2299"><div class="remark_item"><span class="remark_label">Remark 11.1.</span>
Usually, grid based methods are more efficient because they partition the space, which makes the procedure less computationally expensive.</div>
</div>
<h4 class="subsubsection" id="magicparlabel-2300"><span class="subsubsection_label">11.2.1</span> Progressive DBSCAN</h4>
<div class="standard" id="magicparlabel-2301">The idea is using the same value for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math>, apply DBSCAN in a progressive way, increasing the value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>p</mi><mi>s</mi>
</mrow>
</mrow></math>.</div>
<ol class="enumerate" id="magicparlabel-2302"><li class="enumerate_item">Start with a small <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>p</mi><mi>s</mi>
</mrow>
</mrow></math> to find dense clusters.</li>
<li class="enumerate_item">Iteratively relax the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>p</mi><mi>s</mi>
</mrow>
</mrow></math> value to find less dense clusters.</li>
<li class="enumerate_item">After every iteration, the points that already belong to a cluster are removed from the dataset.</li>
</ol>
<h3 class="subsection" id="magicparlabel-2305"><span class="subsection_label">11.3</span> DENCLUE</h3>
<div class="standard" id="magicparlabel-2306">The DENCLUE algorithm is based on kernel-density estimation, which can be used to create a smooth profile of the density distribution, by defining the density <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> at coordinate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mi>n</mi>
</mrow>
</mfrac>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>K</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>-</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>K</mi>
</mrow></math> is the kernel function <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> different data points. A commonly used kernel function is the <b>Gaussian Kernel</b>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>K</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>-</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow><mi>h</mi>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
</msqrt>
</mrow>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mi>d</mi>
</mrow>
</msup>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">∥</mo>
<mrow><mi>X</mi><mo>-</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">∥</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> The effect of this operation is to replace each discrete data point with a smooth bump, and the density at each points is the sum of all these bumps.</div>
<div class="example" id="magicparlabel-2307"><div class="example_item"><span class="example_label">Example 11.1.</span>
A visual example of a kernel smoothing:</div>
<div class="standard" id="magicparlabel-2308" style="text-align: center;"><img alt="image: 18_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado8.png" src="18_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado8.png" style="width:60%;"/>
</div>
</div>
<div class="standard" id="magicparlabel-2309">Once the density has been smoothed, the goal is to determine clusters by using a density threshold <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> that intersects the density profile. Two examples showing how the choice of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math> affects the result are shown in Example <a href="#ex8_2">11.2</a>.</div>
<div class="example" id="magicparlabel-2310"><div class="example_item"><span class="example_label">Example 11.2.</span>
<a id="ex8_2"></a>
In the previous example, if we select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> τ </mi><mo>=</mo><mn>0.1</mn>
</mrow>
</mrow></math>, we obtain the following:</div>
<div class="standard" id="magicparlabel-2311" style="text-align: center;"><img alt="image: 19_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado9.png" src="19_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado9.png" style="width:60%;"/>
</div>
<div class="example_item">In this case, only one cluster is obtained. In contrast, if we choose <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> τ </mi><mo>=</mo><mn>0.13</mn>
</mrow>
</mrow></math>, two clusters are obtained:</div>
<div class="standard" id="magicparlabel-2313" style="text-align: center;"><img alt="image: 20_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado10.png" src="20_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_pegado10.png" style="width:60%;"/>
</div>
</div>
<h2 class="section" id="magicparlabel-2314"><span class="section_label">12</span> Probabilistic Model-Based Algorithms</h2>
<div class="standard" id="magicparlabel-2315">Until now, all models described are <b>hard clustering algorithm</b>, meaning each data point is assigned to a particular cluster. Probabilistic model-based algorithms are <b>soft algorithms</b>, in which each data point may have a nonzero assignment probability to more than one cluster.</div>
<h3 class="subsection" id="magicparlabel-2316"><span class="subsection_label">12.1</span> Fuzzy sets and clusters</h3>
<div class="standard" id="magicparlabel-2317">A <b>fuzzy cluster</b> is a fuzzy set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mi>S</mi>
</mrow>
</msub><mo>:</mo><mi>X</mi><mo> → </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>. For each data point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo><mi>X</mi>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mi>S</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> represents the probability that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is in cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mi>S</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> can be called <b>degree of membership</b> of object <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> to cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-2318">Formally, given a set of objects <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math>, a <b>fuzzy clustering</b> of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> fuzzy clusters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> can be represented using a <b>partition matrix</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>M</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, where<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>M</mi>
</mrow></math> should satisfy three conditions:</div>
<ol class="enumerate" id="magicparlabel-2319"><li class="enumerate_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mspace width="10px"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>j</mi>
</mrow>
</mrow></math>. From the definition of a fuzzy cluster.</li>
<li class="enumerate_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn><mo>,</mo><mspace width="10px"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
</mrow>
</mrow></math>. The sum of all probabilities is 1.</li>
<li class="enumerate_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn>0</mn><mo>&lt;</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
</msub><mo>&lt;</mo><mi>n</mi><mo>,</mo><mspace width="10px"></mspace><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
</mrow>
</mrow></math>. There is no empty cluster.</li>
</ol>
<h3 class="subsection" id="magicparlabel-2322"><span class="subsection_label">12.2</span> Mixture model</h3>
<div class="standard" id="magicparlabel-2323">The underlying assumption of a <b>mixture-based generative model</b> is to assume that the data was generated from a mixture of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> distributions with probability distributions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. Each of them represents a cluster and is called <b>mixture component</b>. The data points, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>, are generated by this model as follows:</div>
<ol class="enumerate" id="magicparlabel-2324"><li class="enumerate_item">Select a mixture component with prior probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi> α </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. Say <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow></math> is selected.</li>
<li class="enumerate_item">Generate a data point from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mi>r</mi>
</mrow>
</msub>
</mrow></math>.</li>
</ol>
<div class="standard" id="magicparlabel-2326">This generative model is denoted by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>M</mi>
</mstyle>
</mrow></math>. We don't know <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> nor <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> α </mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> in advance. The <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>G</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> distributions are often assumed to be Gaussian<div class="foot"><span class="foot_label">5</span><div class="foot_inner"><div class="plain_layout" id="magicparlabel-2330">Note that any other distribution might be assumed.</div>
</div></div>, so we need to estimate the parameters of the distribution in such a way that the overall data has a maximum likelihood of being generated by the model. </div>
<div class="standard" id="magicparlabel-2331">Consider a set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> probabilistic clusters <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> with probability density functions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>f</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>f</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math>, respectively, and probabilities <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. The probability of an object <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> being generated by the cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>|</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> ⋅ </mo>
<msub>
<mrow><mi>f</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> and the probability of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> being generated by the set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo>|</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> ⋅ </mo>
<msub>
<mrow><mi>f</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> As objects are assumed to be independently generated, for a data set <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, the probability that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math> is generated by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle><mo>|</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo> ⋅ </mo>
<msub>
<mrow><mi>f</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mn>.</mn>
</mrow>
</mrow></math> Now, we want to estimate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math> trying to maximize <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle><mo>|</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> is maximized.</div>
<div class="standard" id="magicparlabel-2332">If we use the assumption that the underlying distributions are Gaussian <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>G</mi>
</mstyle><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, then the probability density function of each cluster are centered at <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> with standard deviation <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> is:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo>
<msub>
<mrow><mo> Θ </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
</msqrt>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> And if we assume all clusters have the same probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>p</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>, then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>|</mo><mo> Θ </mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
</msqrt>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math> Thus, our objective is to maximize<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>P</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle><mo>|</mo><mo> Θ </mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∏ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<mrow>
<msub>
<mrow><mi> σ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<msqrt>
<mrow><mn>2</mn><mi> π </mi>
</mrow>
</msqrt>
</mrow>
</mrow>
</mfrac>
<msup>
<mrow><mi>e</mi>
</mrow>
<mrow>
<mrow><mo>-</mo>
<mfrac>
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi> μ </mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mrow><mn>2</mn>
<msup>
<mrow><mi> σ </mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2333">This is achieved with the <b>expection-maximization (EM) algorithm</b>. The EM algorithm is a framework to approach maximum likelihood estimates of parameters in statistical models. It consists of two steps:</div>
<ol class="enumerate" id="magicparlabel-2334"><li class="enumerate_item"><b>E-step</b>: assigns objects to clusters according to the current fuzzy clustering or parameters of probabilistic clusters.</li>
<li class="enumerate_item"><b>M-step</b>: finds the new clustering or parameters that maximize the SSE or the expected likelihood.</li>
</ol>
<div class="example" id="magicparlabel-2336"><div class="example_item"><span class="example_label">Example 12.1.</span>
EM algorithm example.</div>
<div class="example_item"></div>
<div class="standard" id="magicparlabel-2410" style="text-align: center;"><img alt="image: " src="/home/runner/work/BDMA_Notes/BDMA_Notes/ULB/Data_Mining/LectureNotes/source/scripts/example9_1_images/figure_0.eps"/>
</div>
<div class="example_item"></div>
</div>
<h3 class="subsection" id="magicparlabel-2460"><span class="subsection_label">12.3</span> Evaluating fuzzy clusters</h3>
<div class="standard" id="magicparlabel-2461">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> are the centers of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> clusters, we define the sum of squared error (SSE) for a point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msubsup><mo> ⋅ </mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2462">For a cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math>, we have its SSE as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msubsup><mo> ⋅ </mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2463">Finally, the SSE of the whole clustering is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>S</mi><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mstyle mathvariant="script"><mi>C</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mi>w</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>j</mi>
</mrow>
</mrow>
<mrow><mi>p</mi>
</mrow>
</msubsup><mo> ⋅ </mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></div>
<h3 class="subsection" id="magicparlabel-2464"><span class="subsection_label">12.4</span> Cluster quality measures</h3>
<div class="standard" id="magicparlabel-2465">A good clustering methods will produce high quality clusters, i.e. clusters with the following characteristics:</div>
<ul class="itemize" id="magicparlabel-2466"><li class="itemize_item"><b>High intra-class similarity</b>: cohesive within clusters. This means that the objects inside the clusters are similar to each other.</li>
<li class="itemize_item"><b>Low inter-class similarity</b>: distinctive between clusters. This means that the objects from different clusters are different.</li>
</ul>
<div class="standard" id="magicparlabel-2468">The quality of the clustering method depends on the similarity measure used by the method, its implementation and its ability to discover the hidden patterns in the data.</div>
<div class="standard" id="magicparlabel-2469">Some examples of <b>quality measures</b> are:</div>
<ul class="itemize" id="magicparlabel-2470"><li class="itemize_item"><b>Sum of square distance to centroids</b>: the squared distance between the representative of each cluster to every other point in the cluster, and then summed. This measure is suitable for representative-based methods, but it favors clusters that suit the underlying distance function used:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mi>S</mi><mi>D</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mstyle mathvariant="script"><mi>C</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup>
<msubsup>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
</msubsup><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>c</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msup><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Intracluster to intercluster distance ratio</b>: we sample pairs of points from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>D</mi>
</mstyle>
</mrow></math>. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>P</mi>
</mrow></math> be the pairs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow></math> are in the same cluster, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Q</mi>
</mrow></math> the pairs whose points are in different clusters. Then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>I</mi><mi>D</mi><mi>R</mi><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>a</mi>
</mrow>
</mrow>
<mrow>
<mrow><mi>I</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi>
</mrow>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>a</mi><mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo><mi>P</mi>
</mrow>
</mrow>
</msub>
<mfrac>
<mrow>
<mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>P</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>=</mo>
<msub>
<mrow><mo> ∑ </mo>
</mrow>
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ∈ </mo><mi>Q</mi>
</mrow>
</mrow>
</msub>
<mfrac>
<mrow>
<mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>X</mi>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>Q</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></li>
<li class="itemize_item"><b>Silhouette coefficient</b>: let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>a</mi><mi>v</mi><mi>g</mi><mo>-</mo><mi>i</mi>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
</mrow></math> denote the average distance between a point in the cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>i</mi>
</mrow></math> and the rest of the points in the same cluster. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>a</mi><mi>v</mi><mi>g</mi><mo>-</mo><mi>o</mi><mi>u</mi>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
</mrow></math> denote the average distance between a point in the cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>i</mi>
</mrow></math> and every other point in the cluster <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>j</mi>
</mrow></math>. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo>-</mo><mi>o</mi><mi>u</mi>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mo> min </mo>
</mrow>
<mrow><mi>j</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>a</mi><mi>v</mi><mi>g</mi><mo>-</mo><mi>o</mi><mi>u</mi>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>,</mo><mi>j</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. Then:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>=</mo>
<mfrac>
<mrow>
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo>-</mo><mi>o</mi><mi>u</mi>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mo>-</mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>a</mi><mi>v</mi><mi>g</mi><mo>-</mo><mi>i</mi>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
</mrow>
</mrow>
<mrow>
<mrow><mo> max </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo>-</mo><mi>o</mi><mi>u</mi>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow>
<mrow><mi>a</mi><mi>v</mi><mi>g</mi><mo>-</mo><mi>i</mi>
<msub>
<mrow><mi>n</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> It follows that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, where large positive values indicate highly separated clusters (the distance to other clusters is high) and negative values are indicative of some level of mixing of data points from different clusters.</li>
</ul>
<div class="standard" id="magicparlabel-2473"><br/>
</div>
<h1 class="part" id="magicparlabel-2474"><span class="part_label">Part V</span> Frequent pattern and association rule mining</h1>
<h2 class="section" id="magicparlabel-2475"><span class="section_label">13</span> Frequent Itemset Mining</h2>
<div class="standard" id="magicparlabel-2476">Association pattern mining is usually defined in the context of supermarket data coontaining sets of items bought by cutomers, which are referred to as <b>transactions</b>. The goal is to determine associations between groups of items bought by customers. The discovered sets of items are reffered to as <b>frequent itemsets</b>.</div>
<div class="standard" id="magicparlabel-2477">This frequent itemset can then be used to generate <b>association rules</b> of the form <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ⟹ </mo><mi>Y</mi><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> are sets of items. The meaning of this is that we discovered that when some customer buys <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>, it is likely that the same customer is going to/would like to by <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-2478">We have to be careful, nonetheless, because the raw frequency of a pattern is not the same as the statistical significance of the underlying correlations. This is why numerous models for frequent pattern mining have been proposed that are based on statistical significance.</div>
<div class="example" id="magicparlabel-2479"><div class="example_item"><span class="example_label">Example 13.1.</span>
An intuitive example is that when someone buys bread, cheese and yogurt, it is probably the case that he will buy also milk and eggs:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo>,</mo><mi>C</mi><mi>h</mi><mi>e</mi><mi>e</mi><mi>s</mi><mi>e</mi><mo>,</mo><mi>Y</mi><mi>o</mi><mi>g</mi><mi>u</mi><mi>r</mi><mi>t</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⟹ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>M</mi><mi>i</mi><mi>l</mi><mi>k</mi><mo>,</mo><mi>E</mi><mi>g</mi><mi>g</mi><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mrow></math></div>
</div>
<h3 class="subsection" id="magicparlabel-2480"><span class="subsection_label">13.1</span> The model</h3>
<div class="standard" id="magicparlabel-2481">The <b>problem of association pattern mining</b> is defined on <em>unordered set-wise data</em>.</div>
<div class="standard" id="magicparlabel-2482">The <b>database</b> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow></math> contains <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> transactions, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-2483">Each <b>transaction</b> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is a subset of the set of all items <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ⊂ </mo>
<msub>
<mrow>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow>
<mrow>
<mrow><mi>i</mi><mi>t</mi><mi>e</mi><mi>m</mi><mi>s</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow>
</mrow></math>. The transactions can be represented as a multidimensional record of dimensionality <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>d</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mrow></math>, where the values are binary: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>i</mi><mi>t</mi><mi>e</mi><mi>m</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mtable>
<mtr>
<mtd><mn>1</mn>
</mtd>
<mtd>
<mrow><mi>i</mi><mi>f</mi><mspace width="10px"></mspace><mi>i</mi><mi>t</mi><mi>e</mi><mi>m</mi><mo> ∈ </mo>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mtd>
</mtr>
<mtr>
<mtd><mn>0</mn>
</mtd>
<mtd>
<mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi>
</mrow>
</mtd>
</mtr>
</mtable><mn>.</mn>
</mrow>
</mrow></math></div>
<div class="standard" id="magicparlabel-2484">The universe of items is very large compared to the typical number of items in each transaction.</div>
<div class="standard" id="magicparlabel-2485"><div class="flex_color_box"><div class="definition" id="magicparlabel-2489"><div class="definition_item"><span class="definition_label">Definition 13.1.</span>
An <b>itemset</b> is a set of items, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mo> ⊂ </mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow>
</mrow></math>.</div>
<div class="definition_item">A <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold"><mi>k</mi></mstyle>
</mrow></math><b>-itemset</b> is an itemset with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> items, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>I</mi><mo> ⊂ </mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle><mo> ⋀ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mi>I</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo>=</mo><mi>k</mi>
</mrow>
</mrow></math>.</div>
<div class="definition_item">The <b>support </b>of an itemset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>I</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, is the fraction of the transactions in the database <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow></math> that contain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math> as a subset.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-2492"><div class="flex_color_box"><div class="definition" id="magicparlabel-2496"><div class="definition_item"><span class="definition_label">Definition 13.2.</span>
The <b>frequent itemset mining problem</b> is defined as follows:</div>
<div class="definition_item">Given a set of transactions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>n</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>, where each transaction <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math> is a subset of items from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow></math>, determine all itemsets <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math> that occur as a subset of at least a predefined fraction <b>minsup</b> of the transactions in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow></math>.</div>
<div class="definition_item">The predefined fraction minsup is called <b>minimum support</b>.</div>
<div class="definition_item">The unique identifier of a transaction is referred to as <b>transaction identifier </b>(tid).</div>
</div>
</div></div>
<div class="remark" id="magicparlabel-2500"><div class="remark_item"><span class="remark_label">Remark 13.1.</span>
The number of frequent itemset is generally very sensitive to the minimum suppor level: </div>
<ul class="itemize" id="magicparlabel-2501"><li class="itemize_item">The use of a lower minimum support level, yields a larger number of frequent patterns.</li>
<li class="itemize_item">If the support level is too high, no frequent patterns will be found.</li>
</ul>
<div class="remark_item">Therefore, an appropriate choice of the support level is crucial for discovering a set of frequent patterns with meaningful size.</div>
</div>
<div class="example" id="magicparlabel-2504"><div class="example_item"><span class="example_label">Example 13.2.</span>
A very simple example:</div>
<div class="standard" id="magicparlabel-2505" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2527">Tid</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2530">Transaction</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2533">Binary Representation</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2536">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2539">{Shirt, Trousers}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2542">110</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2545">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2548">{Shirt, Jacket} </div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2551">101</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2554">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2557">{Shirt, Trousers, Jacket}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2560">111</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">In this case, the possible itemsets and their respective support is:</div>
<div class="standard" id="magicparlabel-2562" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2587">Itemset</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2590">Support</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2593">{Shirt}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2596">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2599">{Trousers}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2602"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2605">{Jacket}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2608"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2611">{Shirt, Trousers}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2614"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2617">{Shirt, Jacket}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2620"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2623">{Trousers, Jacket}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2626"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2629">{Shirt, Trousers, Jacket}</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2632"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">If we select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi><mo>=</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac>
</mrow>
</mrow></math>, all possible itemsets would be selected.</div>
<div class="example_item">If we select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, only {Shirt} would be selected.</div>
</div>
<div class="standard" id="magicparlabel-2635">Now, let's think about how many possible itemsets there are: if an itemset if a subset of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow></math>, then there are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow>
<mrow><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</msup>
</mrow></math> possible itemsets. This means that computing all their supports as in the previous example would take an exponential amount of time to the cardinality of the number of items. Not only this, but the database needs also to be accessed for counting, comparing,... So it is easy to see how this problem becomes rapidly innaccessible. Then, it is compulsory to find better ways to perform this counting and comparing, or to be able to discard itemsets even before counting. For this, there are some very convenient properties of itemsets:</div>
<div class="standard" id="magicparlabel-2636"><div class="flex_color_box"><div class="plain_layout" id="magicparlabel-2640"><b>Property 1: Support Monotonicity Property</b></div>
<div class="plain_layout" id="magicparlabel-2641">The support of every subset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>J</mi><mo> ⊂ </mo><mi>I</mi>
</mrow>
</mrow></math> is at greater than or equal to the support of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>J</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≥ </mo><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>I</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mspace width="10px"></mspace><mi> ∀ </mi><mi>J</mi><mo> ⊂ </mo><mi>I</mi><mn>.</mn>
</mrow>
</mrow></math> </div>
</div></div>
<div class="standard" id="magicparlabel-2642">This is because all subsets of the itemset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math> are also itemsets. As the itemset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math> appears in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>I</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> fraction of the total transactions, all its subsets also appears at least in the same transactions.</div>
<div class="standard" id="magicparlabel-2643"><div class="flex_color_box"><div class="plain_layout" id="magicparlabel-2647"><b>Property 2: Downward Closure Property</b></div>
<div class="plain_layout" id="magicparlabel-2648">Every subset of a frequent itemset is also frequent.</div>
</div></div>
<div class="standard" id="magicparlabel-2649">This is a natural implication of the previous property, and it is very useful: when we discover a frequent itemset, we don't need to check its subsets because it is already assured that they are frequent, too.</div>
<div class="standard" id="magicparlabel-2650"><div class="flex_color_box"><div class="definition" id="magicparlabel-2654"><div class="definition_item"><span class="definition_label">Definition 13.3.</span>
A frequent itemset is <b>maximal</b> at a given minimum support level <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math> if it is frequent, and no superset of it is also frequent.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-2655">The possible itemsets given a set of items can be conceptually arranged in the form of a <b>lattice</b> <b>of itemsets</b>, which contains one node for each of the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</msup>
</mrow></math> sets drawn from the universe of items. An edge exists between a pair of nodes if the corresponding sets differ by exactly one item. The lattice represents the search space of frequent patterns and it is separated into frequent and infrequent itemsets by a <b>border</b>.</div>
<div class="example" id="magicparlabel-2656"><div class="example_item"><span class="example_label">Example 13.3.</span>
A lattice of itemset with 4 elements.</div>
<div class="standard" id="magicparlabel-2657" style="text-align: center;"><img alt="image: 22_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_lattice_itemset.png" src="22_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_lattice_itemset.png" style="width:60%;"/>
</div>
</div>
<h3 class="subsection" id="magicparlabel-2658"><span class="subsection_label">13.2</span> Association rule generation framework</h3>
<div class="standard" id="magicparlabel-2659"><div class="flex_color_box"><div class="definition" id="magicparlabel-2663"><div class="definition_item"><span class="definition_label">Definition 13.4.</span>
<a id="def_confidence"></a>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
</mrow></math> be two itemsets. The <b>confidence</b> <b>of the rule</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ⟹ </mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, is the conditional probability of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ∪ </mo><mi>Y</mi>
</mrow>
</mrow></math> ocurring in a transaction, given that the transaction contains <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ⟹ </mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>P</mi><mi>r</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ∪ </mo><mi>Y</mi><mo>|</mo><mi>X</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ∪ </mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> is called the <b>antecedent </b>of the rule and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> is the <b>consequent</b>. </div>
</div>
</div></div>
<div class="standard" id="magicparlabel-2664"><div class="flex_color_box"><div class="definition" id="magicparlabel-2668"><div class="definition_item"><span class="definition_label">Definition 13.5.</span>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo>,</mo><mi>Y</mi>
</mrow>
</mrow></math> be two itemsets. The rule <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ⟹ </mo><mi>Y</mi>
</mrow>
</mrow></math> is said to be an <b>association rule at a minimum support of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold">
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow></mstyle>
</mrow></math> and minimum confidence of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mstyle mathvariant="bold">
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi>
</mrow></mstyle>
</mrow></math> </b>if it satisfies:</div>
</div>
<ol class="enumerate" id="magicparlabel-2669"><li class="enumerate_item">The support of the itemset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ∪ </mo><mi>Y</mi>
</mrow>
</mrow></math> is at least <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">The confidence of the rule <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>X</mi><mo> ⟹ </mo><mi>Y</mi>
</mrow>
</mrow></math> is at least <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi>
</mrow>
</mrow></math>.</li>
</ol>
</div></div>
<div class="standard" id="magicparlabel-2671">Here, the first criterion ensures that there are enough transactions to believe that the rule has statistical relevance. The second criterion ensures that the rule is strength enough in terms of conditional probabilities.</div>
<div class="standard" id="magicparlabel-2672">The overall procedure for association rule generation uses two phases:</div>
<ol class="enumerate" id="magicparlabel-2673"><li class="enumerate_item"> The frequent itemsets are generated at the minimum support of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item"> The association rules are generated from the frequent itemsets at the minimum confidence level of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi>
</mrow>
</mrow></math>.</li>
</ol>
<div class="standard" id="magicparlabel-2683">The first phase is more computationally intensive, so we are focusing on it from now on.</div>
<h3 class="subsection" id="magicparlabel-2684"><span class="subsection_label">13.3</span> Frequent itemset mining algorithms</h3>
<h4 class="subsubsection" id="magicparlabel-2685"><span class="subsubsection_label">13.3.1</span> Brute Force Algorithms</h4>
<div class="standard" id="magicparlabel-2686">For a universe of items <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow></math>, there are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</msup><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> distinct subsets, excluding the empty set. A naïve idea would be to generate all these candidate itemsets and count their suppor against the transaction database <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-2687"><div class="flex_color_box"><div class="definition" id="magicparlabel-2691"><div class="definition_item"><span class="definition_label">Definition 13.6.</span>
A <b>candidate itemset</b> is an itemset that can be frequent, so it is needed to be checked.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-2692">Now, we can verified the candidates against the transaction database by support counting, checking whether a given itemset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math> is subset of each transaction <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>T</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ∈ </mo>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-2693">This approach is likely to be impractical when the universe of items is large.</div>
<h4 class="subsubsection_" id="magicparlabel-2694">A little tweak</h4>
<div class="standard" id="magicparlabel-2695">The brute-force approach can be made faster by observing that no <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-patterns are frequent if no <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-patterns are frequent (this follows from the downward closure property). Thus, we can enumerate and count in increasing length for the patterns.</div>
<div class="standard" id="magicparlabel-2696">For sparse transaction databases, the value of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>l</mi>
</mrow></math> (the largest frequent itemset) is usually small compared to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow></math>. At this point, one can terminate. This approach is orders of magnitude faster, but its computational complexity is still not satisfactory for large values of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow></math>.</div>
<h4 class="subsubsection_" id="magicparlabel-2697">Ideas to apply</h4>
<div class="standard" id="magicparlabel-2698">Better algorithms can be developed by using one or more of the following approaches:</div>
<ol class="enumerate" id="magicparlabel-2699"><li class="enumerate_item">Reduce the size of the explored search space by prunning cadidate itemsets using tricks.</li>
<li class="enumerate_item">Counting the support of each candidate more efficiently by prunning transactions that are know to be irrelevant.</li>
<li class="enumerate_item">Using compact data structures to represent either candidates of transaction databases that suppor efficient counting.</li>
</ol>
<h4 class="subsubsection" id="magicparlabel-2702"><span class="subsubsection_label">13.3.2</span> The Apriori Algorithm</h4>
<div class="standard" id="magicparlabel-2703">The Apriori algorithm uses the downward closure property to prune candidates. If an itemset is infrequent, then all its supersets are also infrequent, so we don't need to count them.</div>
<div class="standard" id="magicparlabel-2704">The Apriori algorithm works as follows:</div>
<ol class="enumerate" id="magicparlabel-2705"><li class="enumerate_item">Count the support of the individual items to generate frequent 1-itemsets.</li>
<li class="enumerate_item">Combine the frequent 1-itemsets to generate candidate 2-itemsets. </li>
<li class="enumerate_item">Count the support of the candidate 2-itemsets to generate frequent 2-itemsets.</li>
<li class="enumerate_item">...</li>
</ol>
<div class="standard" id="magicparlabel-2709">In general:</div>
<ol class="enumerate" id="magicparlabel-2710"><li class="enumerate_item">Combine the frequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-itemsets to generate candidate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-itemsets.</li>
<li class="enumerate_item">Prune candidate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-itemsets which has some subset which is not frequent.</li>
<li class="enumerate_item">Count the support of the candidate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-itemsets to generate frequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-itemsets.</li>
<li class="enumerate_item">Repeat until there are no bigger frequent itemsets.</li>
</ol>
<div class="standard" id="magicparlabel-2714">The algorithm is detailed in Algorithm <a href="#alg_Apriori_Transactions_T__Minimum">8</a>.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">k = 1
F1 = {Frequent 1-itemsets}

while Fk is not empty do
	Generate C(k+1) by joining itemset-pairs of Fk
	Prune itemsets from C(k+1) that violate the downward closure property
	Determine F(k+1) by support counting (C(k+1),T)
	k = k+1
end

return Union(F(i) for all i=1..k)</pre></div>
<div class="plain_layout" id="magicparlabel-2734"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 8:  <a id="alg_Apriori_Transactions_T__Minimum"></a>
Apriori(Transactions T, Minimum Support minsup)</span></div>
</div>
<div class="remark" id="magicparlabel-2739"><div class="remark_item"><span class="remark_label">Remark 13.2.</span>
The downward closure property ensures that the candidate set generated does not miss any itemset that is frequent. This non-repetitive and exhaustive way of generating candidates can be interpreted in the context of a conceptual hierarchy of the patterns known as <b>enumeration tree</b>.</div>
</div>
<div class="standard" id="magicparlabel-2740"><br/>
</div>
<div class="remark" id="magicparlabel-2741"><div class="remark_item"><span class="remark_label">Remark 13.3.</span>
To do the pruning, we check generated elements against non-frequent itemsets already generated.</div>
</div>
<div class="standard" id="magicparlabel-2742"><br/>
</div>
<div class="remark" id="magicparlabel-2743"><div class="remark_item"><span class="remark_label">Remark 13.4.</span>
The support counting process is the most expensive part because it depends on the size of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
</mrow></math>. The level-wise approach ensures that the algorithm is relatively efficient from a disk-access perspective: each set of candidates in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>C</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow></math> can be counted in a single pass over the data without the need for random disk accesses. </div>
<div class="remark_item">Nonetheless, the counting procedure is still expensive.ç</div>
</div>
<div class="example" id="magicparlabel-2745"><div class="example_item"><span class="example_label">Example 13.4.</span>
We are going to manually run an Apriori algorithm for a simple database using <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math> (the minsup can be also indicated as a count, instead of as a frequency). The database is</div>
<div class="standard" id="magicparlabel-2746" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-2777"><b>Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2783"><b>TID</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2786"><b>Transaction</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2789">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2792">A,B,E</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2795">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2798">B,D</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2801">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2804">B,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2807">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2810">A,B,D</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2813">5</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2816">A,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2819">6</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2822">B,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2825">7</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2828">A,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2831">8</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2834">A,B,C,E</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2837">9</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2840">A,B,C</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Let's compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>F</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> directly:</div>
<div class="standard" id="magicparlabel-2842" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-2865"><b>F1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2871"><b>Itemset</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2874"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2877">A</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2880">6</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2883">B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2886">7</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2889">C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2892">6</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2895">D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2898">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2901">E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2904">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">From this, we see that all 1-itemsets are frequent, so we are generating all possible 2-itemsets as C2, and counting them:</div>
<div class="standard" id="magicparlabel-2906" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-2939"><b>C2</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2945"><b>Itemsets</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2948"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2951">A,B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2954">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2957">A,C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2960">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2963">A,D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2966">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2969">A,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2972">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2975">B,C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2978">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2981">B,D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2984">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2987">B,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2990">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2993">C,D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2996">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-2999">C,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3002">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3005">D,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3008">0</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3033"><b>F2</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3039"><b>Itemsets</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3042"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3045">A,B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3048">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3051">A,C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3054">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3057">A,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3060">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3063">B,C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3066">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3069">B,D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3072">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3075">B,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3078">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">We have coloured in red the infrequent itemset and generated F2. Now we can generate C3 by combining itemsets from F2. For this, we need to search for itemsets that share all values but one. For example: {A,B} and {A,C} are combinated to obtain {A,B,C}. After getting all possibilities, we find C3 and count:</div>
<div class="standard" id="magicparlabel-3080" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3109"><b>C3</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3115"><b>Itemset</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3118"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3121">A,B,C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3124">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3127">A,B,D</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3133">A,B,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3136">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3139">A,C,D</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3145">A,C,E</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3151">B,C,D</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3157">B,C,E</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3163">B,D,E</div>
</td>
<td align="center" valign="top">
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3183"><b>F3</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3189"><b>Itemset</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3192"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3195">A,B,C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3198">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3201">A,B,E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3204">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">The purple coloured itemsets are pruned because they contain some of the infrequent itemsets of C2. The rest are still frequent, so we continue with the process. We combine the only two itemsets left to get {A,B,C,E} as C4. Note, nonetheless that {C,E} is an infrequent itemset of C2, so we will prune it and we are in fact done.</div>
<div class="example_item">The frequent itemsets with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math> are F1, F2 and F3.</div>
</div>
<h4 class="subsubsection_" id="magicparlabel-3207">Limits of Apriori</h4>
<ul class="itemize" id="magicparlabel-3208"><li class="itemize_item">Apriori makes use of the downward closure property (sometimes called apriori property), which is nice.</li>
<li class="itemize_item">The lattice is traversed in a general-to-specific way, it is possible to a bi-directional traversal.</li>
<li class="itemize_item">It is done in a breadth-first manner, it might be done in a depth-first way.</li>
<li class="itemize_item">The generate-and test strategy:

<ul class="itemize" id="magicparlabel-3212"><li class="itemize_item">Generate is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mfrac>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
<mrow><mi>k</mi>
</mrow>
</mfrac>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-candidates.</li>
<li class="itemize_item">Test is the counting, in which we are traversing the whole database, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>O</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mstyle mathvariant="script"><mi>T</mi>
</mstyle>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
</ul>
</li></ul>
<h4 class="subsubsection_" id="magicparlabel-3214">Apriori improved with tricks</h4>
<div class="standard" id="magicparlabel-3215">In Algorithm <a href="#alg_Apriori_improved_Transactions_T_">9</a> it is detailed an improved version of the Apriori algorithm.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">	k = 1
	F1 = {Frequent 1-itemsets}
	
	while Fk is not empty do
		C(k+1) = generate(Lk)
		for tran in T do
			C(tran) = subset(C(k+1),tran)
			for cand in C(tran)
				cand.count++
			end
		end
		L(k+1)={cand in C(k+1) | cand.count &gt;= minsup}
	end
	return Union(F(i) for i=1..k)

procedure generate(Lk)
	foreach itemset1 in Lk
		foreach itemset2 in Lk
			if itemset1[1]=itemset2[1] and ... and itemset1[k-1] = itemset2[k-1] and itemset1[k] &lt; itemset2[k]
				c = itemset1 join itemset2
				if has_infreq_subsets(c,Lk)
					continue
				else
					add c to C(k+1)
				end
			end
		end
	end
	return C(k+1)

procedure has_infreq_subsets(c,Lk)
	foreach k-subset s of c
		if s not in Lk
			return TRUE
		end
	end
	return FALSE</pre></div>
<div class="plain_layout" id="magicparlabel-3261"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 9:  Apriori_improved(Transactions T, Minimum support minsup)<a id="alg_Apriori_improved_Transactions_T_"></a>
</span></div>
</div>
<h4 class="subsubsection_" id="magicparlabel-3266">More Apriori Tricks</h4>
<ul class="itemize" id="magicparlabel-3267"><li class="itemize_item">Transaction reduction: a transaction that does not contain any frequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-itemsets, cannot contain any frequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>+</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-itemset either, so it can be removed to make counting faster.</li>
<li class="itemize_item">Partitioning: divide the database into a set of disjoint partitions. Find all frequent itemsets in every partition. A local frequent itemset may not be frequent for the whole database, but a frequent itemset must be frequent in at least one partition. The best about this approach is that it allows for parallel processing and the partition size can be selected for it to fit in memory.</li>
<li class="itemize_item">Sampling: perform Apriori on a random sample of the data. Rule accuracy is harmed, but efficiency is improved.</li>
</ul>
<h4 class="subsubsection" id="magicparlabel-3270"><span class="subsubsection_label">13.3.3</span> FP-Growth</h4>
<div class="standard" id="magicparlabel-3271">Even though Apriori greatly improves the efficiency of the solution of the association pattern mining in comparison to the brute force approach, we have seen that it can still suffer from inefficiencies when the database is big. Particularly, counting is very costly and when there are lots of items we will need to count many times. There is an improved solution for the problem: <b>Frequent Pattern Growth (FP-Growth)</b> which:</div>
<ol class="enumerate" id="magicparlabel-3272"><li class="enumerate_item">Transforms the database into a compressed data structur called <b>FP-Tree</b>, which retains frequent itemsets information.</li>
<li class="enumerate_item">Mines the FP-tree for frequent itemsets by:

<ol class="enumerate" id="magicparlabel-3274"><li class="enumerate_item">Divide it into a set of conditional databases, the <b>conditional pattern bases</b>, each associated eith one frequent item.</li>
<li class="enumerate_item">Mines each of these patterns separately to generate association rules, without the need to re-count the original database.</li>
</ol>
</li></ol>
<div class="standard" id="magicparlabel-3276"><div class="flex_color_box"><div class="definition" id="magicparlabel-3280"><div class="definition_item"><span class="definition_label">Definition 13.7.</span>
A <b>FP-Tree</b> is a trie (prefix tree) data structure, which acts as a compressed representaiton of a conditional database.</div>
</div>
<ul class="itemize" id="magicparlabel-3281"><li class="itemize_item">The path from the root to a leaf represents a repeated sub-transaction (frequent pattern) in the database.</li>
<li class="itemize_item">The path from the root to an internal node represents either a frequent pattern or a prefix.</li>
<li class="itemize_item">Each node is associated with a count, which is the number of transactions in the database containing the path to this node.</li>
<li class="itemize_item">The prefixes are sorted in the order from the most frequent to the least frequent to leverage the prefix-based comrpession.</li>
</ul>
</div></div>
<div class="standard" id="magicparlabel-3285">The algorithm for FP-Growth is detailed in Algorithm <a href="#alg_FP_Growth_FP_Tree_FPT__Minimum">10</a>.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">if FPT is a single path
	determine all combinations C of nodes on the path, report Union(C,P) as frequent
else
	foreach item i in FPT do
		report Pi = Union(i,P) as frequent
		
		use pointers to extract conditional prefix paths from FPT containing i
	
		readjust counts of prefix paths
		remove i
		
		remove infrequent items from prefix paths
		
		reconstruct FPTi
		
		if FPTi not empty
			FP-Growth(FPTi, minsup, Pi)
	end
end</pre></div>
<div class="plain_layout" id="magicparlabel-3313"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 10:  <a id="alg_FP_Growth_FP_Tree_FPT__Minimum"></a>
FP-Growth(FP-Tree FPT, Minimum Support minsup, Current Suffix P)</span></div>
</div>
<div class="standard" id="magicparlabel-3318">Basically, what FP-Growth does is recursively find all frequent itemsets ending with a particular suffix by splitting the probelm into smaller subproblems.</div>
<div class="example" id="magicparlabel-3319"><div class="example_item"><span class="example_label">Example 13.5.</span>
Let's use FP-Growth on the previous example database:</div>
<div class="lyx_code" id="magicparlabel-3320"><div class="lyx_code" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3351"><b>Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3357"><b>TID</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3360"><b>Transaction</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3363">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3366">A,B,E</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3369">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3372">B,D</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3375">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3378">B,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3381">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3384">A,B,D</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3387">5</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3390">A,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3393">6</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3396">B,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3399">7</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3402">A,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3405">8</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3408">A,B,C,E</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3411">9</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3414">A,B,C</div>
</td>
</tr></tbody>
</table>
</div>
</div>
<div class="example_item">First, we need to construct the FP-Tree. For this purpose, we compute the frequent 1-itemsets and reorder them in the count order:</div>
<div class="standard" id="magicparlabel-3416" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3439"><b>F1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3445"><b>Itemset</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3448"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3451">A</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3454">6</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3457">B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3460">7</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3463">C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3466">6</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3469">D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3472">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3475">E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3478">2</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover accent="false"><mo> ⟹ </mo>
<mrow><mi>I</mi><mi>n</mi><mspace width="10px"></mspace><mi>d</mi><mi>e</mi><mi>s</mi><mi>c</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="10px"></mspace><mi>o</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>r</mi>
</mrow></mover>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3501"><b>F1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3507"><b>Itemset</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3510"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3513">B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3516">7</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3519">A</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3522">6</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3525">C</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3528">6</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3531">D</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3534">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3537">E</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3540">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now we reorder the transactions in the database following this same ordering:</div>
<div class="lyx_code" id="magicparlabel-3542"><div class="lyx_code" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-3573"><b>Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3579"><b>TID</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3582"><b>Transaction</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3585">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3588">B,A,E</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3591">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3594">B,D</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3597">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3600">B,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3603">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3606">B,A,D</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3609">5</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3612">A,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3615">6</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3618">B,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3621">7</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3624">A,C</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3627">8</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3630">B,A,C,E</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3633">9</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3636">B,A,C</div>
</td>
</tr></tbody>
</table>
</div>
</div>
<div class="example_item">And now we construct the FP-Tree. We start with the root labeled as NULL, and then add the transactions one by one, reusing the prefixes when we can, and keeping a counter for each node. Every time we traverse a node, we increase the counter. The first transaction would be entered as:</div>
<div class="standard" id="magicparlabel-3638" style="text-align: center;"><img alt="image: 23_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_0.png" src="23_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_0.png" style="width:50%;"/>
</div>
<div class="example_item">The second one:</div>
<div class="standard" id="magicparlabel-3640" style="text-align: center;"><img alt="image: 24_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_1.png" src="24_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_1.png" style="width:50%;"/>
</div>
<div class="example_item">The third one:</div>
<div class="standard" id="magicparlabel-3642" style="text-align: center;"><img alt="image: 25_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_2.png" src="25_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_2.png" style="width:50%;"/>
</div>
<div class="example_item">And so on... Until all transactions are entered in the tree:</div>
<div class="standard" id="magicparlabel-3644" style="text-align: center;"><img alt="image: 26_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_3.png" src="26_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_3.png" style="width:50%;"/>
</div>
<div class="example_item">Now, we connect each item in the ordered F1 to one node in the database corresponding to the same item, and all nodes that are equal are connected, too. Like this:</div>
<div class="standard" id="magicparlabel-3646" style="text-align: center;"><img alt="image: 27_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_4.png" src="27_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_fpgrowth_4.png" style="width:50%;"/>
</div>
<div class="example_item">And now we proceed with the algorithm. We start with the least frequent item, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>E</mi>
</mrow></math>. </div>
<ul class="itemize" id="magicparlabel-3648"><li class="itemize_item">For item <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>E</mi>
</mrow></math>, the conditional pattern base contains two itemsets: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. Thus, it follows that we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>, so the conditional FP-Tree is
<div class="standard" id="magicparlabel-3649" style="text-align: center;"><img alt="image: 28_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_0.png" src="28_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_0.png" style="width:50%;"/>
</div>
<div class="standard" id="magicparlabel-3650">Thus, the generated frequent patterns are: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>E</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>E</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>E</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>.</div>
</li><li class="itemize_item">For item <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mo>,</mo>
</mrow>
</mrow></math> the conditional pattern base also contains two itemsets: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. So now we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> and the conditional FP-Tree is
<div class="standard" id="magicparlabel-3652" style="text-align: center;"><img alt="image: 29_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_1.png" src="29_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_1.png" style="width:50%;"/>
</div>
<div class="standard" id="magicparlabel-3653">And the generated frequent patterns are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>.</div>
</li><li class="itemize_item">For item <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>C</mi><mo>,</mo>
</mrow>
</mrow></math> the conditional pattern base contains one itemset: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>4</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. The conditional FP-Tree ends up being
<div class="standard" id="magicparlabel-3655" style="text-align: center;"><img alt="image: 30_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_2.png" src="30_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_2.png" style="width:50%;"/>
</div>
<div class="standard" id="magicparlabel-3656">And the generated frequent patterns are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>.</div>
</li><li class="itemize_item">For item <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo>,</mo>
</mrow>
</mrow></math> the conditional pattern base contains three itemsets: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>. So now we have the three of them and no combination. The conditional FP-Tree ends up being
<div class="standard" id="magicparlabel-3658" style="text-align: center;"><img alt="image: 31_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_3.png" src="31_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_cond_fptree_3.png" style="width:50%;"/>
</div>
<div class="standard" id="magicparlabel-3659">And the generated frequent patterns are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>:</mo><mn>4</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>.</div>
</li></ul>
<div class="example_item">And that's it!</div>
</div>
<h4 class="subsubsection_" id="magicparlabel-3661">Why FP-Growth outperforms Apriori?</h4>
<ul class="itemize" id="magicparlabel-3662"><li class="itemize_item">FP-Growth counts the database only once. This fact by itself is already a huge improvement, because Apriori needs to count one time per candidate.</li>
<li class="itemize_item">Also, Apriori needs indeed to create the candidates, which can also be expensive. FP-Growth, on the other hand, does not do a generation step, because the frequent itemsets are naturally obtained.</li>
<li class="itemize_item">In relation to the last point, Apriori creates candidates which end up being infrequent, while this does not happen with FP-Growth.</li>
<li class="itemize_item">Space complexity of FP-Growth is smaller because we don't need to store the candidates, only the FP-Tree, which is not much bigger than the number of items in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mstyle mathvariant="script"><mi>U</mi>
</mstyle>
</mrow></math>. Also, the database is not needed after the FP-Tree is computed, so we have more memory to use for the tree itself.</li>
</ul>
<h3 class="subsection" id="magicparlabel-3666"><span class="subsection_label">13.4</span> Mining Association Rules</h3>
<div class="standard" id="magicparlabel-3667">Once the frequent itemsets have been found, it is time to obtain the association rules, which are the goal we were aiming at since the beggining. To do this, a common approach is to follow:</div>
<ol class="enumerate" id="magicparlabel-3668"><li class="enumerate_item">For each frequent itemset <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-3669"><li class="enumerate_item">Generate subsets of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>I</mi>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> ∅ </mi><mo> ≠ </mo><mi>S</mi><mo> ⊂ </mo><mi>I</mi>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">For every <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> ∅ </mi><mo> ≠ </mo><mi>S</mi><mo> ⊂ </mo><mi>I</mi>
</mrow>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-3671"><li class="enumerate_item">Output rule <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mo> ⟹ </mo><mi>I</mi><mo> ∖ </mo><mi>S</mi>
</mrow>
</mrow></math> if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>S</mi><mo> ⟹ </mo><mi>I</mi><mo> ∖ </mo><mi>S</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≥ </mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi>
</mrow>
</mrow></math>.</li>
</ol>
</li></ol>
</li></ol>
<h4 class="subsubsection" id="magicparlabel-3672"><span class="subsubsection_label">13.4.1</span> Evaluating association rules</h4>
<div class="standard" id="magicparlabel-3673">In Definition <a href="#def_confidence">13.4</a> we saw the concept of confidence, but there are more measures to assess how 'good' a rule is, as the lift or the correlation analysis.</div>
<div class="standard" id="magicparlabel-3674"><div class="flex_color_box"><div class="definition" id="magicparlabel-3678"><div class="definition_item"><span class="definition_label">Definition 13.8.</span>
The <b>lift</b> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ⟹ </mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>X</mi><mo> ∪ </mo><mi>Y</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>X</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>Y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math></div>
</div>
</div></div>
<div class="remark" id="magicparlabel-3679"><div class="remark_item"><span class="remark_label">Remark 13.5.</span>
If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>, then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> are independent.</div>
<div class="remark_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo>&gt;</mo><mn>1</mn>
</mrow>
</mrow></math>, then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> have some dependency that is proportional to the lift value.</div>
<div class="remark_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo>&lt;</mo><mn>1</mn>
</mrow>
</mrow></math> then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> are contradicting, i.e., the existence of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi>
</mrow></math> discourages <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>Y</mi>
</mrow></math> and vice versa.</div>
</div>
<div class="standard" id="magicparlabel-3682"><div class="flex_color_box"><div class="definition" id="magicparlabel-3686"><div class="definition_item"><span class="definition_label">Definition 13.9.</span>
The <b>correlation coefficient</b> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Φ </mo><mo>=</mo>
<mfrac>
<mrow>
<mrow><mi>T</mi><mi>T</mi><mo> ⋅ </mo><mi>F</mi><mi>F</mi><mo>-</mo><mi>T</mi><mi>F</mi><mo> ⋅ </mo><mi>F</mi><mi>T</mi>
</mrow>
</mrow>
<mrow>
<msqrt>
<mrow>_<mi>T</mi><mo> ⋅ </mo>_<mi>F</mi><mo> ⋅ </mo><mi>T</mi>_<mo> ⋅ </mo><mi>F</mi>_
      </mrow>
</msqrt>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where we are assuming a rule <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>A</mi><mo> ⟹ </mo><mi>B</mi>
</mrow>
</mrow></math> and:</div>
<ul class="itemize" id="magicparlabel-3687"><li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi><mi>T</mi>
</mrow>
</mrow></math> is how many times <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> is True and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> is True</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mi>F</mi>
</mrow>
</mrow></math> is how many times <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> is False and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> is False</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi><mi>F</mi>
</mrow>
</mrow></math> is how many times <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> is True and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> is False</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>F</mi><mi>T</mi>
</mrow>
</mrow></math> is how many times <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> is False and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> is True</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi>_<mo>/</mo><mi>F</mi>_
  </mrow>
</mrow></math> is how many times <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> is True/False</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>_<mi>T</mi><mo>/</mo>_<mi>F</mi>
</mrow>
</mrow></math> is how many times <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>B</mi>
</mrow></math> is True/False</li>
</ul>
</div>
</div></div>
<div class="remark" id="magicparlabel-3693"><div class="remark_item"><span class="remark_label">Remark 13.6.</span>
In this case, if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Φ </mo><mo>=</mo><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> there is a perfect negative correlation.</div>
<div class="remark_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Φ </mo><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math> there is a perfect positive correlation.</div>
<div class="remark_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo> Φ </mo><mo>=</mo><mn>0</mn>
</mrow>
</mrow></math> the two itemsets are statistically independent.</div>
</div>
<div class="standard" id="magicparlabel-3696"><br/>
</div>
<div class="remark" id="magicparlabel-3697"><div class="remark_item"><span class="remark_label">Remark 13.7.</span>
The definitions of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>T</mi><mi>T</mi><mo>,</mo><mi>F</mi><mi>T</mi>
</mrow>
</mrow></math>,... can be summarized as in the following table:</div>
<div class="standard" id="magicparlabel-3698" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3728">B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3731"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>B</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3734">Total</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3737">A</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3740">TT</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3743">TF</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3746">T_</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3749"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>A</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3752">FT</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3755">FF</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3758">F_</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3761">Total</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3764">_T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3767">_F</div>
</td>
<td align="center" valign="top">
</td>
</tr></tbody>
</table>
</div>
</div>
<div class="example" id="magicparlabel-3771"><div class="example_item"><span class="example_label">Example 13.6.</span>
Imagine we have the rule <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>T</mi><mi>e</mi><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⟹ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>C</mi><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>e</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> with the following data:</div>
<div class="standard" id="magicparlabel-3772" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3802">Coffee</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3805"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>Coffee</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3808">Total</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3811">Tea</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3814">150</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3817">50</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3820">200</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3823"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>Tea</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3826">650</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3829">150</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3832">800</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3835">Total</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3838">800</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3841">200</div>
</td>
<td align="center" valign="top">
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">In this case, the confidence is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>T</mi><mi>e</mi><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⟹ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>C</mi><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>e</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>150</mn>
</mrow>
<mrow><mn>200</mn>
</mrow>
</mfrac><mo>=</mo><mn>0.75</mn><mo>,</mo>
</mrow>
</mrow></math> which is a high confidence... but <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mi>u</mi><mi>p</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>C</mi><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>e</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0.8</mn>
</mrow>
</mrow></math>, which means that drinking coffee in fact decreases the probability of drinking coffee!</div>
<div class="example_item">Now, the lift is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>T</mi><mi>e</mi><mi>a</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⟹ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>C</mi><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>e</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mn>0.15</mn>
</mrow>
<mrow>
<mrow><mn>0.2</mn><mo> ⋅ </mo><mn>0.8</mn>
</mrow>
</mrow>
</mfrac><mo>=</mo><mn>0.9375</mn><mo>&lt;</mo><mn>1</mn><mo>,</mo>
</mrow>
</mrow></math> which means that Tea and Coffee are negatively correlated. This insight is better than the one obtained by only looking at the value of the confidence.</div>
</div>
<div class="standard" id="magicparlabel-3847"><br/>
</div>
<div class="example" id="magicparlabel-3848"><div class="example_item"><span class="example_label">Example 13.7.</span>
But let's now look at this example:</div>
<div class="standard" id="magicparlabel-3849" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3879">p</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3882"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>p</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3885">Total</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3888">q</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3891">880</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3894">50</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3897">930</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3900"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>q</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3903">50</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3906">20</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3909">70</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3912">Total</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3915">930</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3918">70</div>
</td>
<td align="center" valign="top">
</td>
</tr></tbody>
</table>
<table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3951">r</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3954"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>r</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3957">Total</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3960">s</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3963">20</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3966">50</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3969">70</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3972"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> ¬ </mi>
</mrow></math>s</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3975">50</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3978">880</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3981">930</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3984">Total</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3987">70</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-3990">930</div>
</td>
<td align="center" valign="top">
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">In this case<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>p</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⟹ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>q</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1.02</mn>
</mrow>
</mrow></math> and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>l</mi><mi>i</mi><mi>f</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>r</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo> ⟹ </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>s</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>4.08</mn><mo>,</mo>
</mrow>
</mrow></math> but <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>p</mi><mo>,</mo><mi>q</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> appear together 88% of the time, while <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>r</mi><mo>,</mo><mi>s</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> appear together only 2% of the time. Confidence is a better indicator in this case. The problem here is that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>r</mi><mo>,</mo><mi>s</mi>
</mrow>
</mrow></math> appears in a small portion of records in the data.</div>
</div>
<h4 class="subsubsection" id="magicparlabel-3995"><span class="subsubsection_label">13.4.2</span> How to choose a measure?</h4>
<div class="standard" id="magicparlabel-3996">We have seen that we can obtain different conclusions by looking at different measures, so the choice of the measure is important because it will affect the results. A good choice must be based on a clear understanding of the measure and its properties, so we are aware of the flaws it entails and can leverage them for good.</div>
<div class="standard" id="magicparlabel-3997">We can also asses rules using interactive visualizations, subjective measures based on domain experience,...</div>
<h2 class="section" id="magicparlabel-3998"><span class="section_label">14</span> Sequential pattern mining</h2>
<div class="standard" id="magicparlabel-3999">In the last section, we were looking for patterns in a set-wise approach, but there exist also situations in which the order in which elements are encountered is important. For example, it is a well known fact that seeing something can make people wanting to buy it. This fact is used by supermarkets to strategically place the products in order for the customers to have as many temptations as possible. From the side of the supermarket, it is interesting to know which zones of the supermarket are related in such a way that customers tend to go from one to another in a particular order. Imagine we detect that it is usual that people that go to the desserts hall, usually go to the fruit hall afterwards. Then, the supermarket is interested in placing the fruits as far from the desserts as possible, to maximize the time spent by the customer at looking products that they did not want before, but might want now. It can be used also to detect sequences like:</div>
<ul class="itemize" id="magicparlabel-4000"><li class="itemize_item">Shopping sequences: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo> → </mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo> → </mo><mi>i</mi><mi>n</mi><mi>k</mi>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Website sessions: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo> → </mo><mi>e</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo> → </mo><mi>b</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mi>l</mi><mi>o</mi><mi>r</mi>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">Tourist routes: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>G</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>P</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo> → </mo><mi>M</mi><mi>a</mi><mi>n</mi><mi>n</mi><mi>e</mi><mi>k</mi><mi>e</mi><mi>n</mi><mi>P</mi><mi>i</mi><mi>s</mi><mo> → </mo><mi>C</mi><mi>o</mi><mi>m</mi><mi>i</mi><mi>c</mi><mi>s</mi><mi>M</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>u</mi><mi>m</mi>
</mrow>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-4003">With this objective in mind, <b>sequential pattern mining</b> was developed.</div>
<div class="standard" id="magicparlabel-4004"><div class="flex_color_box"><div class="definition" id="magicparlabel-4008"><div class="definition_item"><span class="definition_label">Definition 14.1.</span>
A <b>sequence</b> is an ordered list of elements. Each <b>element</b> is an unordered set of items.</div>
<div class="definition_item">A <b>subsequence</b> <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>s</mi>
</mrow></math> of a sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> is a sequence such that:</div>
<ul class="itemize" id="magicparlabel-4010"><li class="itemize_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mo> ∈ </mo><mi>s</mi>
</mrow>
</mrow></math> then there exists <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo> ∈ </mo><mi>S</mi>
</mrow>
</mrow></math> such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mo> ⊂ </mo><mi>E</mi>
</mrow>
</mrow></math>.</li>
<li class="itemize_item">If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo> → </mo>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo> → </mo><mn>...</mn><mo> → </mo>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math> is the full sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>s</mi>
</mrow></math>, then there exist <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> different elements <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo> ∈ </mo><mi>S</mi>
</mrow>
</mrow></math> such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ⊂ </mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> goes before <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> (maybe not directly), <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> goes before <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub>
</mrow></math>,...</li>
</ul>
<div class="definition_item">In other words, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> is a subsequence of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>S</mi><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow><mi>m</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> if there are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> elements <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</msub><mo> ∈ </mo><mi>S</mi>
</mrow>
</mrow></math> such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>e</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo> ⊂ </mo>
<msub>
<mrow><mi>E</mi>
</mrow>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</msub><mo>,</mo><mi> ∀ </mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>&lt;</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>&lt;</mo><mn>...</mn><mo>&lt;</mo>
<msub>
<mrow><mi>s</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mrow></math>. </div>
</div>
</div></div>
<div class="standard" id="magicparlabel-4013"><div class="flex_color_box"><div class="definition" id="magicparlabel-4017"><div class="definition_item"><span class="definition_label">Definition 14.2.</span>
A <b>sequence database</b> is a database of sequences.</div>
<div class="definition_item">The <b>support</b> of a sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>s</mi>
</mrow></math> is the fraction of sequences in the database <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mstyle mathvariant="script"><mi>S</mi>
</mstyle><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>S</mi>
</mrow>
<mrow><mi>N</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> that contain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>s</mi>
</mrow></math> as a subsequence.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-4019"><div class="flex_color_box"><div class="definition" id="magicparlabel-4023"><div class="definition_item"><span class="definition_label">Definition 14.3.</span>
The <b>sequential pattern mining problem</b> consists in, given a sequence database, find all subsequences whose support is at least the specified <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math>.</div>
</div>
</div></div>
<div class="standard" id="magicparlabel-4024">This problem is obviously similar and related to that of frequent patterns mining, but this is more comples. A naive algorithm that generates all possible paterns and count them in the database would be highly inneficient, even more than in the set-wise case. There are several methods that work much better. First, let's see how to generate candidates.</div>
<h3 class="subsection" id="magicparlabel-4025"><span class="subsection_label">14.1</span> Candidate generation</h3>
<div class="standard" id="magicparlabel-4026">The candidate generation follows the steps:</div>
<ol class="enumerate" id="magicparlabel-4027"><li class="enumerate_item"><b>Base case</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>: merging two frequent 1-sequences <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> will produce two candidate 2-sequences:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow>
<msub>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mspace width="10px"></mspace><mi>a</mi><mi>n</mi><mi>d</mi><mspace width="10px"></mspace><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>i</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mn>.</mn>
</mrow>
</mrow></math></li>
<li class="enumerate_item"><b>General case</b>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>&gt;</mo><mn>2</mn>
</mrow>
</mrow></math>: two frequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-sequences <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math> are merged if the subsequence obtained by removing the first event in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> is the same as the subsequence obtained by removing the last event in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math>.

<ol class="enumerate" id="magicparlabel-4029"><li class="enumerate_item">The resulting candidate after merging is given by the sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> extended with the last event of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-4030"><li class="enumerate_item">If the last two events in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> belong to the same element, then the las event in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> becomes part of the last element in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math>.</li>
<li class="enumerate_item">Otherwise, the last event in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> becomes a separate element appended to the end of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math>.ç</li>
<li class="enumerate_item">If both <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> consist in only one set, we generate the two variants.</li>
</ol>
</li></ol>
</li></ol>
<div class="example" id="magicparlabel-4033"><div class="example_item"><span class="example_label">Example 14.1.</span>
If we merge <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>2</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>4</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>2</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>4</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> we will get the sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>2</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>4</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>, because the last two events in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow></math> belong to the same element.</div>
<div class="example_item">If we merge <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>2</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>4</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>2</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>4</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> we will get the sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>w</mi>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msub><mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>1</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mn>2</mn><mo>,</mo><mn>3</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>4</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math>. </div>
</div>
<h3 class="subsection" id="magicparlabel-4035"><span class="subsection_label">14.2</span> Generalized Sequential Pattern (GSP) Algorithm</h3>
<ol class="enumerate" id="magicparlabel-4036"><li class="enumerate_item">Make the first pass over the database to obtain all the 1-element frequent sequences.</li>
<li class="enumerate_item">Repeat until no new frequent sequences are found:

<ol class="enumerate" id="magicparlabel-4038"><li class="enumerate_item"><b>Candidate generation</b>: merge pairs of frequent subsequences found in the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> pass to generate candidate sequences that contain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> items.</li>
<li class="enumerate_item"><b>Candidate pruning</b>: prune candidate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-sequences that contain infrequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-subsequences.</li>
<li class="enumerate_item"><b>Support counting</b>: make a new pass over the sequence database to find the support for these candidate sequences.</li>
<li class="enumerate_item"><b>Candidate elimination</b>: eliminate candidate <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-sequences whose actual support is less than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math>.</li>
</ol>
</li></ol>
<div class="example" id="magicparlabel-4042"><div class="example_item"><span class="example_label">Example 14.2.</span>
Let's perform GSP with the following database with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi><mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>.</div>
<div class="standard" id="magicparlabel-4043" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4064"><b>Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4070"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4073"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4076">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4079"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4082">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4085"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4088">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4091"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4094">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4097"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">First, we compute C1 and F1:</div>
<div class="standard" id="magicparlabel-4099" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4120"><b>C1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4126"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4129"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4132"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4135">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4138"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4141">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4144"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4147">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4150"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4153">1</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4172"><b>F1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4178"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4181"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4184"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4187">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4190"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4193">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4196"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4199">4</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now, we generate C2 by combining these subsequences. For example, merging <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> gives <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, but we also need to combine in the other possible order, obtaining <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> in addition to these. Thus, we obtain:</div>
<div class="standard" id="magicparlabel-4201" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4238"><b>C2</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4244"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4247"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4250"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4253">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4256"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4259">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4262"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4265">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4268"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4271">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4274"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4277">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4280"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4283">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4286"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4289">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4292"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4295">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4298"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4301">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4304"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4307">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4310"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4313">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4316"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4319">0</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4342"><b>F2</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4348"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4351"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4354"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4357">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4360"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4363">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4366"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4369">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4372"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4375">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4378"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4381">4</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now, from F2 we can combine <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>,</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> with none and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math> with none. Thus:</div>
<div class="standard" id="magicparlabel-4383" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4410"><b>C3</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4416"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4419"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4422"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4425">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4428"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4431">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4434"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4437">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4440"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4443">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4446"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4449">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4452"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4455">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4458"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4461">2</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4478"><b>F3</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4484"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4487"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4490"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4493">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4496"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4499">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">And that's it because we cannot combine anything else. Thus, the result is F1, F2 and F3.</div>
</div>
<h3 class="subsection" id="magicparlabel-4501"><span class="subsection_label">14.3</span> Sequential PAttern Discovery using Equivalence classes (SPADE) Algorithm</h3>
<ol class="enumerate" id="magicparlabel-4502"><li class="enumerate_item">Transform de database into its vertical format, i.e., with SeqID, elemID inside sequence, and the element itself.</li>
<li class="enumerate_item">Construct the <b>ID-list </b>of 1-sequences, i.e., construct a table in which the elements are in the columns and in the cells we write all pairs <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>s</mi><mi>e</mi><mi>q</mi><mi>I</mi><mi>d</mi><mo>:</mo><mi>e</mi><mi>l</mi><mi>e</mi><mi>m</mi><mi>I</mi><mi>D</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> in which the element in the column appears.</li>
<li class="enumerate_item">We count distinct seqID for each element. Those having more than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math> are kept and the rest are discarded.</li>
<li class="enumerate_item">For <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn>
</mrow>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-4506"><li class="enumerate_item">Contruct new <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-candidates using the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math>-frequent subsequences (as in GSP). Prune when possible.</li>
<li class="enumerate_item">Construct the ID-list of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-sequences as <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>s</mi><mi>e</mi><mi>q</mi><mi>I</mi><mi>D</mi><mo>:</mo><mi>e</mi><mi>l</mi><mi>e</mi><mi>m</mi><mi>I</mi>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo><mi>e</mi><mi>l</mi><mi>e</mi><mi>m</mi><mi>I</mi>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>e</mi><mi>l</mi><mi>e</mi><mi>m</mi><mi>I</mi>
<msub>
<mrow><mi>D</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow>
</mrow></math> is the element in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>s</mi><mi>e</mi><mi>q</mi><mi>I</mi><mi>D</mi>
</mrow>
</mrow></math> in which the event <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>i</mi>
</mrow></math> in the current subsequence appear.</li>
<li class="enumerate_item">Count distinct seqID for each element. Those having more than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>u</mi><mi>p</mi>
</mrow>
</mrow></math> are kept and the rest are discarded.</li>
</ol>
</li></ol>
<div class="example" id="magicparlabel-4509"><div class="example_item"><span class="example_label">Example 14.3.</span>
Let's repeat the example with SPADE. First, we transform the database to its vertical form:</div>
<div class="standard" id="magicparlabel-4510" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4531"><b>Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4537"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4540"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4543">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4546"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4549">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4552"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4555">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4558"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4561">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4564"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="3" valign="top">
<div class="plain_layout" id="magicparlabel-4616"><b>Vertical Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4625"><b>SeqID</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4628"><b>ElemID</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4631"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4634">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4637">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4640"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4643">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4646">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4649"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4652">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4655">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4658"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4661">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4664">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4667"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4670">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4673">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4676"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4679">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4682">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4685"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4688">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4691">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4694"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4697">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4700">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4703"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4706">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4709">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4712"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4715">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4718">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4721"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4724">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4727">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4730"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4733">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4736">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4739"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now, we construct the ID-list of 1-sequences:</div>
<div class="standard" id="magicparlabel-4741" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" colspan="4" valign="top">
<div class="plain_layout" id="magicparlabel-4801"><b>1-ID-List</b></div>
</td>
</tr><tr><td align="center" rowspan="5" valign="middle">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4816"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4819"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4822"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4825"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4831">1:1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4834">1:1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4837">1:2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4840">3:3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4846">1:3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4849">2:1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4852">2:3</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4861">2:1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4864">2:2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4867">3:2</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4876">4:2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4879">3:1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4882">4:3</div>
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4894">4:1</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4909">4:2</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4918"><b>Count</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4921">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4924">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4927">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4930">1</div>
</td>
</tr></tbody>
</table>
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo> ⟹ </mo>
</mrow></math>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-4949"><b>F1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4955"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4958"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4961"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4964">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4967"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4970">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4973"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-4976">4</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now the ID-list of 2-sequences, combining the 1-sequences:</div>
<div class="standard" id="magicparlabel-4978" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" colspan="12" valign="top">
<div class="plain_layout" id="magicparlabel-5118"><b>2-ID-List</b></div>
</td>
</tr><tr><td align="center" rowspan="5" valign="middle">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5157"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5160"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5163"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5166"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5169"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5172"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5175"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5178"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5181"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5184"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5187"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>B</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5190"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5196">1:1,3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5199">2:1,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5202">1:1,1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5205">1:1,3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5208">2:1,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5211">1:1,2</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5217">1:2,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5223">1:1,2</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5241">2:1,1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5244">4:1,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5247">4:1,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5250">2:1,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5262">2:1,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5280">4:2,2</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5289">4:2,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5301">2:2,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5340">3:1,2</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5379">4:1,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5418">4:2,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5427"><b>Count</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5430">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5433">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5436">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5439">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5442">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5445">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5448">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5451">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5454">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5457">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5460">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5463">0</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">So</div>
<div class="standard" id="magicparlabel-5465" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-5488"><b>F2</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5494"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5497"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5500"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5503">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5506"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5509">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5512"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5515">2</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5518"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5521">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5524"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5527">4</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">And now we do the 3-ID-List combining these:</div>
<div class="standard" id="magicparlabel-5529" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
</td>
<td align="center" colspan="4" valign="top">
<div class="plain_layout" id="magicparlabel-5619"><b>3-ID-List</b></div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" rowspan="5" valign="middle">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5643"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5646"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5649"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5652"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5655"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5658"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5661"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5667">1:1,1,3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5670">2:1,1,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5673">1:1,1,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5676">4:1,2,2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5679">4:1,2,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5685">2:1,2,3</div>
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5697">2:1,1,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5709">4:1,2,3</div>
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5721">4:2,2,3</div>
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
<td align="center" valign="top">
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5808"><b>Count</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5811">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5814">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5817">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5820">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5823">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5826">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5829">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">So</div>
<div class="standard" id="magicparlabel-5831" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-5848"><b>F3</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5854"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5857"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5860"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5863">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5866"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5869">2</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">And the result is (obviously) the same we got with GSP.</div>
</div>
<h3 class="subsection" id="magicparlabel-5871"><span class="subsection_label">14.4</span> PrefixSpan</h3>
<ol class="enumerate" id="magicparlabel-5872"><li class="enumerate_item">Start by counting frequent 1-sequences, as in GSP.</li>
<li class="enumerate_item">PrefixSpan extends each frequent itemset recursively.</li>
<li class="enumerate_item">For each frequent 1-sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math>:

<ol class="enumerate" id="magicparlabel-5875"><li class="enumerate_item">Project the database with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> as a prefix, i.e., for each sequence, remove everything until the first occurence of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> is found.</li>
<li class="enumerate_item">Count the possible expansions of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math> with one additional event at the end.</li>
<li class="enumerate_item">For frequent 2-sequences, repeat the same procedure. Until no new frequent <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-sequences are discovered.</li>
</ol>
</li></ol>
<div class="example" id="magicparlabel-5878"><div class="example_item"><span class="example_label">Example 14.4.</span>
We are going to do the same example again. The database is </div>
<div class="standard" id="magicparlabel-5879" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-5900"><b>Database</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5906"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5909"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5912">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5915"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5918">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5921"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5924">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5927"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5930">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5933"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">with frequent 1-itemsets</div>
<div class="standard" id="magicparlabel-5935" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-5954"><b>F1</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5960"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5963"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5966"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5969">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5972"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5975">4</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5978"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-5981">4</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">So we can start with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>A</mi>
</mrow></math> as a prefix. We project the database:</div>
<div class="standard" id="magicparlabel-5983" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6004"><b>Database projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6010"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6013"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6016">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6019"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6022">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6025"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6028">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6031"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6034">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6037"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">And we count possible 2-sequences starting with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>:</div>
<div class="standard" id="magicparlabel-6039" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6062"><b>C2 projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6068"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6071"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6074"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6077">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6080"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6083">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6086"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6089">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6092"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6095">3</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6098"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>C</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6101">0</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now we select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> as prefix and count its possible extensions:</div>
<div class="standard" id="magicparlabel-6103" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6122"><b>Database projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6128"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6131"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6134">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6137"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6140">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6143"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6146">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6149"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6168"><b>C3 projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6174"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6177"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6180"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6183">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6186"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6189">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6192"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6195">3</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">Now we select <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math> as prefix and again count its possible extensions (in this case the projected database only ahs one record, so there is no need to count):</div>
<div class="standard" id="magicparlabel-6197" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6212"><b>Database projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6218"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6221"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6224">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6227"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">And with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math>:</div>
<div class="standard" id="magicparlabel-6229" style="text-align: center;"><table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6248"><b>Database projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6254"><b>Id</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6257"><b>Sequence</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6260">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6263"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6266">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6269"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6272">4</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6275"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>A</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math></div>
</td>
</tr></tbody>
</table>
<table><tbody><tr><td align="center" colspan="2" valign="top">
<div class="plain_layout" id="magicparlabel-6298"><b>C3 projected to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6304"><b>Subsequence</b></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6307"><b>Count</b></div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6310"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>C</mi><mo>,</mo><mi>A</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6313">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6316"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6319">1</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6322"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>C</mi><mo>,</mo><mi>B</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6325">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6328"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6331">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6334"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>A</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow></math></div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6337">0</div>
</td>
</tr></tbody>
</table>
</div>
<div class="example_item">We would repeat the same with prefixes <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>B</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow></math>, and the result has to be the same as with the two previous algorithms.</div>
</div>
<h3 class="subsection" id="magicparlabel-6339"><span class="subsection_label">14.5</span> Some comments</h3>
<div class="standard" id="magicparlabel-6340" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6367">Algorithm</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6370">How</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6373">Time</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6376">Space</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6379">GSP</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6382">Candidate Generation</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6385">Counting against DB</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6388">Space alloc for candidate generation</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6391">SPADE</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6394">Candidate Generation</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6397">Counting against ID-Lists</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6400">Space alloc for the ID-Lists</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6403">PrefixSpan</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6406">No Candidate Generation (prefix-based generation)</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6409">Counting the projected DB</div>
</td>
<td align="center" style="width: 5cm;" valign="top">
<div class="plain_layout" id="magicparlabel-6412">Space alloc for the projected DB, but there is one possible optimization using pointers</div>
</td>
</tr></tbody>
</table>
</div>
<div class="standard" id="magicparlabel-6413"><br/>
</div>
<h1 class="part" id="magicparlabel-6414"><span class="part_label">Part VI</span> Stream Data Mining</h1>
<h2 class="section" id="magicparlabel-6415"><span class="section_label">15</span> Stream data mining</h2>
<div class="standard" id="magicparlabel-6416">A <b>data streaming</b> is a constant flow of data, which usually carries to much information for it to be feasible to be stored. Somehow, we need to be able to apply data mining algorithms in datasets whose records we are only able to see once. This might seem esoteric, but there are plenty of applications in which we find this kind of needs. For instance, in credit card transactions, in wearable sensors information, connected vehicles, Internet of Things,...</div>
<div class="standard" id="magicparlabel-6417">More precisely, the challenges that data streams possess are:</div>
<ul class="itemize" id="magicparlabel-6418"><li class="itemize_item"><b>One pass constraint</b>: data size is assumed to be infinite. We cannot store everything to perform second passes through it. Say we want to cluster this type of data, we cannot apply an iterative approach like that of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-means.</li>
<li class="itemize_item"><b>Drift</b>: data evolves over time, as well as its statistical properties. This means that a model that works well today, could work poorly tomorrow. We need to be able to adapt to these changes.</li>
<li class="itemize_item"><b>Resource constraints</b>: we are constrained to the arrival rate of the data, which can be variable and sometimes it can has huge peaks where data is coming faster than expected. This implies that the algorithms need to be fast enough to not lose valuable data because of processing.</li>
<li class="itemize_item"><b>Massive domain</b>: some data attributes might have a large values of distinct values.</li>
</ul>
<h3 class="subsection" id="magicparlabel-6422"><span class="subsection_label">15.1</span> Bloom filter</h3>
<div class="standard" id="magicparlabel-6423">The bloom filter is an idea thought to answer the question:</div>
<div class="standard" id="magicparlabel-6424" style="text-align: center;"><em>'Has this incoming element ever ocurred in the data stream before?'</em></div>
<div class="standard" id="magicparlabel-6425">The idea is to be able to summarize the past of the data stream to be able to answer this question with a reasonable level of confidence. A <b>bloom filter</b> is a data structure that consists of:</div>
<ul class="itemize" id="magicparlabel-6426"><li class="itemize_item">A binary array of length <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>w</mi>
</mrow></math> independent hash functions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>w</mi>
</mrow>
</msub>
</mrow>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-6428">And the algorithm developed to initialize this data structure is the one described in Algorithm <a href="#alg_BloomConstruct_Stream_S__Size">11</a>. Basically, each element is hashed using all the hash functions, then the correspondent elements in the array are set to True.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings Python">B = array(length=m, type=bool, default=False)
repeat
	receive next element x in S
	for i = 1..w 
		idx = hi(x) 
		B[idx] = True
until S ends
return B</pre></div>
<div class="plain_layout" id="magicparlabel-6445"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 11:  <a id="alg_BloomConstruct_Stream_S__Size"></a>
BloomConstruct(Stream S, Size m, Number of hash w)</span></div>
</div>
<div class="standard" id="magicparlabel-6450">Now, when a new element comes from the stream, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo> ∈ </mo><mi>S</mi>
</mrow>
</mrow></math>, we would compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>w</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. If all the correspondent elements in the bloom filter are True, then we are confident (if the hash functions are well done) that the element has already been seen before. If some of them is False, we know for sure that the element has not been seen before, and we update the filter.</div>
<div class="example" id="magicparlabel-6451"><div class="example_item"><span class="example_label">Example 15.1.</span>
Suppose we have the stream <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>3</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>15</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mo>=</mo><mn>10</mn>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>k</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>k</mi><mo> mod </mo><mn>10</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>k</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>k</mi><mo>+</mo><mn>7</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> mod </mo><mn>10</mn>
</mrow>
</mrow></math>. The procedure would be:</div>
<ol class="enumerate" id="magicparlabel-6452"><li class="enumerate_item">Start with all-False bloom filter:


<div class="standard" id="magicparlabel-6453" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6480">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6483">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6486">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6489">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6492">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6495">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6498">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6501">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6504">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6507">F</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">3 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>3</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>. Both F, so 3 has never been seen before. Update B:


<div class="standard" id="magicparlabel-6509" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6536">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6539">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6542">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6545">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6548">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6551">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6554">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6557">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6560">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6563">F</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">8 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>8</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>8</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>8</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>5</mn>
</mrow>
</mrow></math>. Both F, so 8 has never been seen before. Update B:


<div class="standard" id="magicparlabel-6565" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6592">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6595">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6598">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6601">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6604">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6607">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6610">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6613">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6616">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6619">F</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">15 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>15</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>5</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>15</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>. The first is T, but the second is F, so 15 has never been seen before. Update B:


<div class="standard" id="magicparlabel-6621" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6648">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6651">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6654">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6657">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6660">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6663">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6666">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6669">F</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6672">T</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6675">F</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">3 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>3</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>. Both T, so we assume 3 has indeed been seen before. In this case we are right! B is not updated.</li>
<li class="enumerate_item">5 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>5</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>2</mn>
</mrow>
</mrow></math>. Both T, so we assume 5 has indeed been seen before. In this case we are wrong... it is a false positive.</li>
</ol>
</div>
<div class="remark" id="magicparlabel-6678"><div class="remark_item"><span class="remark_label">Remark 15.1.</span>
Note how little by little the array gets populated by True values, making false positives increasingly likely.</div>
</div>
<h3 class="subsection" id="magicparlabel-6679"><span class="subsection_label">15.2</span> Count-Min Sketch</h3>
<div class="standard" id="magicparlabel-6680">In this case, we are interested in answering the question:</div>
<div class="standard" id="magicparlabel-6681" style="text-align: center;"><em>'How many times has this incoming element appeared in the data stream before?' </em></div>
<div class="standard" id="magicparlabel-6682">Again, the idea is to be able to make a summary of the past data that enables us to answer the question. A <b>count-min sketch</b> is a data structure which consists of:</div>
<ul class="itemize" id="magicparlabel-6683"><li class="itemize_item">A set of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>w</mi>
</mrow></math> different numeric arrays, each of length <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math>.</li>
<li class="itemize_item"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>w</mi>
</mrow></math> independent hash functions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>w</mi>
</mrow>
</msub>
</mrow>
</mrow></math>.</li>
</ul>
<div class="standard" id="magicparlabel-6685">And the algorithm developed to initialize this data structure is the one described in Algorithm . Basically, each element is hashed using all the hash functions, then the correspondent elements in the array are augmented by 1 unit. There are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>w</mi>
</mrow></math> rows to make the values harder to collide (two elements <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>x</mi><mo>,</mo><mi>y</mi>
</mrow>
</mrow></math> collide only if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>y</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>, for the same <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
</mrow></math>). To get the number of times an element has come, we get the minimum of the cells accessed, because the minimum is an upper bound for the number of times the element has been seen.</div>
<div class="float-algorithm"><div class="float-listings"><pre class="listings">CM = Matrix(nrows=w, ncols=m, type=int, default=0)
repeat
	receive next element x in S
	for i=1..w
		idx = hi(x)
		CM[i,idx] += 1
until S ends
return CM</pre></div>
<div class="plain_layout" id="magicparlabel-6702"><span class="float-caption-Standard float-caption float-caption-standard">Algorithm 12:  CountMinConstruct(Stream S, Width w, Height m)</span></div>
</div>
<div class="example" id="magicparlabel-6707"><div class="example_item"><span class="example_label">Example 15.2.</span>
Suppose we have the stream <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>3</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>15</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>m</mi><mo>=</mo><mn>10</mn>
</mrow>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>k</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mi>k</mi><mo> mod </mo><mn>10</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>k</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>2</mn><mi>k</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> mod </mo><mn>10</mn>
</mrow>
</mrow></math>. The procedure would be:</div>
<ol class="enumerate" id="magicparlabel-6708"><li class="enumerate_item">Start with all-0 count-min sketch:


<div class="standard" id="magicparlabel-6709" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6746">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6749">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6752">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6755">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6758">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6761">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6764">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6767">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6770">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6773">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6776">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6779">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6782">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6785">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6788">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6791">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6794">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6797">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6800">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6803">0</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">3 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>3</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>6</mn>
</mrow>
</mrow></math>. Both 0, so 3 has been seen 0 times before. Update CM:


<div class="standard" id="magicparlabel-6805" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6842">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6845">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6848">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6851">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6854">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6857">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6860">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6863">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6866">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6869">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6872">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6875">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6878">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6881">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6884">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6887">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6890">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6893">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6896">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6899">0</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">8 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>8</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>8</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>8</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>6</mn>
</mrow>
</mrow></math>. One cell is 1 and the other is 0, so 8 has never been seen before. Update CM:


<div class="standard" id="magicparlabel-6901" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6938">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6941">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6944">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6947">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6950">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6953">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6956">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6959">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6962">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6965">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6968">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6971">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6974">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6977">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6980">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6983">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6986">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6989">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6992">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-6995">0</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">15 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>15</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>5</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>15</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>. Both 0, so 15 has never been seen before. Update CM:


<div class="standard" id="magicparlabel-6997" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7034">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7037">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7040">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7043">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7046">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7049">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7052">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7055">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7058">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7061">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7064">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7067">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7070">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7073">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7076">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7079">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7082">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7085">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7088">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7091">0</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">3 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>3</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>6</mn>
</mrow>
</mrow></math>. One is 2 and other is 1, so it has been seen once before. Update CM:


<div class="standard" id="magicparlabel-7093" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7130">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7133">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7136">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7139">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7142">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7145">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7148">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7151">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7154">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7157">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7160">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7163">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7166">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7169">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7172">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7175">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7178">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7181">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7184">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7187">0</div>
</td>
</tr></tbody>
</table>
</div>
</li><li class="enumerate_item">5 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>5</mn>
</mrow>
</mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>0</mn>
</mrow>
</mrow></math>. Both 1, so we assume 5 has indeed been seen before once. In this case we are wrong... it is a false positive. The table would be updated again:


<div class="standard" id="magicparlabel-7189" style="text-align: center;"><table><tbody><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7226">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7229">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7232">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7235">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7238">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7241">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7244">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7247">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7250">1</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7253">0</div>
</td>
</tr><tr><td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7256">2</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7259">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7262">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7265">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7268">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7271">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7274">3</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7277">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7280">0</div>
</td>
<td align="center" valign="top">
<div class="plain_layout" id="magicparlabel-7283">0</div>
</td>
</tr></tbody>
</table>
</div>
</li></ol>
</div>
<div class="remark" id="magicparlabel-7284"><div class="remark_item"><span class="remark_label">Remark 15.2.</span>
Note that if 15 went in again, we would fail again, and in fact from this point on we will always fail with the count of 15s and 5s seen.</div>
</div>
<h3 class="subsection" id="magicparlabel-7285"><span class="subsection_label">15.3</span> Flajolet-Martin algorithm</h3>
<div class="standard" id="magicparlabel-7286">The Flajolet-Martin algorithm aims at answering the question</div>
<div class="standard" id="magicparlabel-7287" style="text-align: center;"><em>'How many distinct elements appeared in the data stream before?' </em></div>
<div class="standard" id="magicparlabel-7288">The intuitive idea is as follows: if the hash function distribute evenly the numbers in the range of the function, then we can assume that the probability of getting a particular value after hashing is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">|</mo>
<mrow><mi>r</mi><mi>a</mi><mi>n</mi><mi>g</mi><mi>e</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">|</mo>
</mrow>
</mfrac>
</mrow></math>. Thus, if we take the binary representation of the output, we can assume that the last digit is 0 with probability <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow></math> because it has the same chance of being 0 or 1. Now, the output having the last two digits as 0 would occur approximately 1 out of 4 times, and so on... The probability that the last <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> digits are 0 is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
</mrow>
</mfrac>
</mrow></math>, so if we see a value with <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> trailing 0, the expected amount of seen records is <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
</mrow></math>. </div>
<div class="standard" id="magicparlabel-7289">The algorithm works as follows:</div>
<ol class="enumerate" id="magicparlabel-7290"><li class="enumerate_item">Given a data stream <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>S</mi>
</mrow></math>, use a hash function <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo>:</mo><mi>S</mi><mo> → </mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>0</mn><mo>,</mo>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>L</mi>
</mrow>
</msup><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo> ∩ </mo>
<mstyle mathvariant="double-struck"><mi>Z</mi>
</mstyle>
</mrow>
</mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>L</mi>
</mrow></math> is such that <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>L</mi>
</mrow>
</msup><mo>&gt;</mo>#<mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>c</mi><mi>t</mi><mspace width="10px"></mspace><mi>e</mi><mi>l</mi><mi>e</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>L</mi>
</mrow></math> is usually chosen to be 64.</li>
<li class="enumerate_item">For each incoming record <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>, take the binary representation of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Count the number of trailing zeros in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">Keep a variable <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub>
</mrow></math> with the maximum number of zeros found until now.</li>
<li class="enumerate_item">The expected maximum number of trailing zeros over all stream elements is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>E</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
<mo>=</mo>
<msub>
<mrow><mo> log </mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>0.77351</mn><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>n</mi>
</mrow></math> is the amount of distinct values. So, if we want to know how many distinct values we have seen until now, we would estimate<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo> ∼ </mo>
<mfrac>
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub>
</mrow>
</msup>
</mrow>
<mrow><mn>0.77351</mn>
</mrow>
</mfrac><mn>.</mn>
</mrow>
</mrow></math> </li>
</ol>
<div class="example" id="magicparlabel-7295"><div class="example_item"><span class="example_label">Example 15.3.</span>
Suppose we have the stream <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>3</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>15</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>7</mn><mi>x</mi><mo>+</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> mod </mo><mn>32</mn>
</mrow>
</mrow></math>.</div>
<ol class="enumerate" id="magicparlabel-7296"><li class="enumerate_item">3 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>26</mn><mo>=</mo><mn>11010</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">8 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>8</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>19</mn><mo>=</mo><mn>10011</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">15 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>15</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>14</mn><mo>=</mo><mn>01110</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">3 enters. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">5 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>8</mn><mo>=</mo><mn>01000</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub><mo>=</mo><mn>3</mn>
</mrow>
</mrow></math>.</li>
</ol>
<div class="example_item">Thus, the estimation is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo> ∼ </mo>
<mfrac>
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</msup>
</mrow>
<mrow><mn>0.77351</mn>
</mrow>
</mfrac><mo>=</mo><mn>10.3</mn><mo>,</mo>
</mrow>
</mrow></math> and the real value is 4. Note, nonetheless, that as we are working with probabilities, the results are not expected to be accurate when there are very few values.</div>
</div>
<h4 class="subsubsection_" id="magicparlabel-7302">Improvements to Flajolet-Martin</h4>
<ol class="enumerate" id="magicparlabel-7303"><li class="enumerate_item"> It can happen that one of the first values has lots of trailing zeros, ruining the algorithm. A solution to avoid this is using several hash functions <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>h</mi>
</mrow>
<mrow><mi>w</mi>
</mrow>
</msub>
</mrow>
</mrow></math> and keep the maximum number of trailing zeros for each of them <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mn>1</mn>
</mrow>
</mrow>
</msub><mo>,</mo><mn>...</mn><mo>,</mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mi>w</mi>
</mrow>
</mrow>
</msub>
</mrow>
</mrow></math>. At the end, we would obtain <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub>
</mrow></math> as the average of all these.</li>
<li class="enumerate_item"> It is also possible to have several points in which the records are taken, and thus we would like to synchronize the results from every of them. The solution is to treat all these points as if they were only one. Let's explain this a little bit. Imagine we have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> measure points, where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> streams are measured, one stream per measure point. Then, we would have <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> values <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mi>i</mi>
</mrow>
</mrow>
</msub>
</mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi>
</mrow>
</mrow></math> and we want to obtain the combined <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub>
</mrow></math>. The idea is that, if we think of all the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>m</mi>
</mrow></math> streams as a single stream which has been divided, then we would just take <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub>
</mrow></math> as the maximum number of trailing zeros observed in the stream. Thus, when it is divided, if we know the maximum number of trailing zeros in each of the substreams, we also know the maximum number of trailing zeros in the whole stream: the maximum among the substreams! Thus, we would take<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi>
</mrow>
</mrow>
</msub><mo>=</mo>
<msub>
<mrow><mo> max </mo>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi>
</mrow>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mrow></math> Each of the substreams would work exactly as explained before (maybe with the Improvement 1 implemented).</li>
</ol>
<h3 class="subsection" id="magicparlabel-7313"><span class="subsection_label">15.4</span> Hyperloglog</h3>
<div class="standard" id="magicparlabel-7314">Hyperloglog is a generalization of Flajolet-Martin, which tries to improve the predictions to answer the same question of how many different values have been seen in the stream before.</div>
<div class="standard" id="magicparlabel-7315">The idea is that we use <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msup>
</mrow></math> buckets to count the trailing zeros observed in the records observed. For an incoming record, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>x</mi>
</mrow></math>, we compute <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math> and translate it to binary form. Then, the bucket in which it will count is the bucket numbered with the first <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> bits of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi>
<msub>
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub>
</mrow>
</mrow></math>. In each bucket, we would count the maximum number of trailing zeros in records classified into that bucket. At the end, as explained by Flajolet et al. in [<a href="#LyXCite-flajolet2007hyperloglog"><span class="bib-label">2</span></a>], the estimation is computed as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo> ∼ </mo><mi>k</mi>
<mfrac>
<mrow>
<mrow><mi>H</mi>
<msubsup>
<mrow><mi>M</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msup>
<mrow><mn>2</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow>
<mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mi>i</mi>
</mrow>
</mrow>
</msub>
</mrow>
</msup>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
<mrow><mn>0.77351</mn>
</mrow>
</mfrac><mo>,</mo>
</mrow>
</mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> is the number of buckets, and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>H</mi>
<msubsup>
<mrow><mi>M</mi>
</mrow>
<mrow>
<mrow><mi>i</mi><mo>=</mo><mn>1</mn>
</mrow>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msubsup><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>i</mi>
</mrow>
</msub>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
<mfrac>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub>
</mrow>
</mfrac><mo>+</mo><mn>...</mn><mo>+</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow>
<msub>
<mrow><mi>x</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub>
</mrow>
</mfrac>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow></math> is the harmonic mean.</div>
<div class="example" id="magicparlabel-7316"><div class="example_item"><span class="example_label">Example 15.4.</span>
Suppose we have the stream <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">[</mo>
<mrow><mn>3</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>15</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">]</mo>
</mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>x</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mn>7</mn><mi>x</mi><mo>+</mo><mn>5</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> mod </mo><mn>32</mn>
</mrow>
</mrow></math> and there are two buckets.</div>
<ol class="enumerate" id="magicparlabel-7317"><li class="enumerate_item">3 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>3</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>26</mn><mo>=</mo><mn>11010</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>u</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>t</mi><mo>=</mo><mn>1</mn><mo> → </mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">8 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>8</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>19</mn><mo>=</mo><mn>10011</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>u</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>t</mi><mo>=</mo><mn>1</mn><mo> → </mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">15 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>15</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>14</mn><mo>=</mo><mn>01110</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>u</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>t</mi><mo>=</mo><mn>0</mn><mo> → </mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">3 enters. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>u</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>t</mi><mo>=</mo><mn>1</mn><mo> → </mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mn>1</mn>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item">5 enters: <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>h</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mn>5</mn>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>8</mn><mo>=</mo><mn>01000</mn>
</mrow>
</mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>B</mi><mi>u</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>t</mi><mo>=</mo><mn>0</mn><mo> → </mo>
<msub>
<mrow><mi>R</mi>
</mrow>
<mrow><mn>0</mn>
</mrow>
</msub><mo>=</mo><mn>3</mn>
</mrow>
</mrow></math>.</li>
</ol>
<div class="example_item">Thus, the estimation is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>n</mi><mo> ∼ </mo><mn>2</mn>
<mfrac>
<mrow>
<mfrac>
<mrow><mn>2</mn>
</mrow>
<mrow>
<mrow>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>3</mn>
</mrow>
</mfrac><mo>+</mo>
<mfrac>
<mrow><mn>1</mn>
</mrow>
<mrow><mn>1</mn>
</mrow>
</mfrac>
</mrow>
</mrow>
</mfrac>
</mrow>
<mrow><mn>0.77351</mn>
</mrow>
</mfrac><mo>=</mo><mn>3.88.</mn>
</mrow>
</mrow></math></div>
</div>
<div class="standard" id="magicparlabel-7323"><br/>
</div>
<h1 class="part" id="magicparlabel-7324"><span class="part_label">Part VII</span> Outlier mining</h1>
<h2 class="section" id="magicparlabel-7325"><span class="section_label">16</span> Outlier Mining</h2>
<div class="standard" id="magicparlabel-7326"><div class="flex_color_box"><div class="definition" id="magicparlabel-7330"><div class="definition_item"><span class="definition_label">Definition 16.1.</span>
An <b>outlier</b> is a data object that deviates significantly from the normal objects as if it were generated by a different underlying mechanism.</div>
</div>
</div></div>
<div class="remark" id="magicparlabel-7331"><div class="remark_item"><span class="remark_label">Remark 16.1.</span>
Note that an outlier is not the same as noise in the data. Noise is due to random errors or the variance in a measured variable and for a good outlier analysis, it is required that noisy records are removed first.</div>
<div class="remark_item">Outlier are far more interesting than noise, because they are generated differently from the usual data.</div>
<div class="remark_item">As we saw in stream data mining, data can vary over time, and in the early stages of a change process, the new records would be seen as outliers from the past ones. But little by little we would notice that they are not outliers, they are the result of a change in the underlying process. Thus, outlier detection is also a part of the novelty detection process.</div>
</div>
<div class="standard" id="magicparlabel-7334"><br/>
</div>
<div class="remark" id="magicparlabel-7335"><div class="remark_item"><span class="remark_label">Remark 16.2.</span>
Some use cases are:</div>
<ul class="itemize" id="magicparlabel-7336"><li class="itemize_item">Credit card fraud detection: the normal records are not fraudulent, and they add up to a great majority of the records. Thus, the frauds are outliers which are generated differently.</li>
<li class="itemize_item">Medical analysis: the outliers are the few people that suffer an illness.</li>
</ul>
</div>
<h3 class="subsection" id="magicparlabel-7338"><span class="subsection_label">16.1</span> Types of outliers</h3>
<ul class="itemize" id="magicparlabel-7339"><li class="itemize_item"><b>Global outlier</b>: is a record that significantly deviates from the rest of the data set. It can be found clustering the data and defining an appropriate measurement of deviation.

<div class="float-figure"><div class="plain_layout" id="magicparlabel-7344" style="text-align: center;"><img alt="image: 32_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_0.png" src="32_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_0.png" style="width:50%;"/>
</div>
<div class="plain_layout" id="magicparlabel-7345"><span class="float-caption-Standard float-caption float-caption-standard">Figure 3:  A global outlier.</span></div>
</div>
</li><li class="itemize_item"><b>Contextual outlier</b>: is a record that deviates significantly based on a selected context, i.e., a subset of the data. Usually, attributes can be categorized into:

<ul class="itemize" id="magicparlabel-7352"><li class="itemize_item">Contextual attributes: which defines the context of the record, e.g. the time and location.</li>
<li class="itemize_item">Behavioral attributes: these are the proper measures of the records, which are used in outlier evaluation, e.g. temperature.</li>
</ul>
<div class="standard" id="magicparlabel-7354">This way, if the context is Brussels in December, a temperature of 0 degrees would probably not be an outlier. But the same temperature in Dominican Republic in June would be an outlier. </div>
<div class="standard" id="magicparlabel-7355">The main problem in this case is how to define meaningful context.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-7360" style="text-align: center;"><img alt="image: 33_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_1.png" src="33_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_1.png" style="width:50%;"/>
</div>
<div class="plain_layout" id="magicparlabel-7361"><span class="float-caption-Standard float-caption float-caption-standard">Figure 4:  A context outlier.</span></div>
</div>
</li><li class="itemize_item"><b>Collective outliers</b>: a subset of the data records collectively deviates significantly from the whole data set, but the individual data records might not be outliers themselves. For example, in the lottery, someone has to win, so when we look at individuals winning a lottery prize we would not see anything strange. But if the same person wins several editions of the lottery, then it would be an outlier.

<div class="float-figure"><div class="plain_layout" id="magicparlabel-7371" style="text-align: center;"><img alt="image: 34_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_2.png" src="34_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_2.png" style="width:50%;"/>
</div>
<div class="plain_layout" id="magicparlabel-7372"><span class="float-caption-Standard float-caption float-caption-standard">Figure 5:  Collective outliers.</span></div>
</div>
</li></ul>
<h3 class="subsection" id="magicparlabel-7377"><span class="subsection_label">16.2</span> Challenges of outlier detection</h3>
<ul class="itemize" id="magicparlabel-7378"><li class="itemize_item">It is hard to enumerate all possible normal behaviors in an application and the boundary that separates normal data from outlier data is often in a gray area which is hard to identify.</li>
<li class="itemize_item">The choice of distance measures among objects and the relationship between objects is application-dependent, so there is no one-fits-all solution.</li>
<li class="itemize_item">As mentioned before, noice can blur the distinction between normal objects and outliers because the algorithms can sometimes confuse noise with outliers.</li>
<li class="itemize_item">The understandability of the outliers is also hard to provide. It is not easy to understand how the detected outliers are produced in contrast to normal records. Usually, one thing we can do is estimate the unlikelihood of the record being generated by a normal mechanism (hypotheses testing).</li>
</ul>
<h3 class="subsection" id="magicparlabel-7382"><span class="subsection_label">16.3</span> Supervised methods for outlier detection</h3>
<div class="standard" id="magicparlabel-7383">We can try to model outlier detection as a classification problem, in which the samples are examined and classified by domain experts and are later used for training and testing models.</div>
<h4 class="subsubsection" id="magicparlabel-7384"><span class="subsubsection_label">16.3.1</span> One-Class model</h4>
<div class="standard" id="magicparlabel-7385">The idea of the one-class model is to train a classification model that can distinguish normal data from outliers. For this, it requires many abnormal samples, as many as possible. The functioning is to learn the decision boundary of the normal class. Then, all samples that lie outside this boundary are labeled as outliers.</div>
<div class="standard" id="magicparlabel-7386">It poses the <b>advantage</b> that can detect new outliers that are different from past outliers.</div>
<div class="standard" id="magicparlabel-7387">It is possible to extend the model to a <b>multi-class model</b>, in which the normal objects might be also classified into multiple classes.</div>
<div class="float-figure"><div class="plain_layout" id="magicparlabel-7392" style="text-align: center;"><img alt="image: 35_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_3.png" src="35_home_runner_work_BDMA_Notes_BDMA_Notes_ULB_Data_Mining_LectureNotes_source_outliers_3.png" style="width:50%;"/>
</div>
<div class="plain_layout" id="magicparlabel-7393"><span class="float-caption-Standard float-caption float-caption-standard">Figure 6:  Basic diagram of a one-class model.</span></div>
</div>
<h3 class="subsection" id="magicparlabel-7399"><span class="subsection_label">16.4</span> Unsupervised methods for outlier detection</h3>
<div class="standard" id="magicparlabel-7400">If we assume that the normal objects are somehow clusered into multiple groups, each of them having some distinctive features, we can expect outliers to be far away from any group of normal records.</div>
<div class="standard" id="magicparlabel-7401">This approach posses the <b>drawback</b> that it is very hard to detect collective outliers effectively.</div>
<h4 class="subsubsection" id="magicparlabel-7402"><span class="subsubsection_label">16.4.1</span> Proximity-based methods</h4>
<div class="standard" id="magicparlabel-7403">In this case, a record is considered an outlier if the nearest neighbors of the objects are far away. The effectiveness of these methods relies on the proximity measure used and it is often hard to find groups of outliers that are close to each other.</div>
<h4 class="subsubsection_" id="magicparlabel-7404">Distance-based outlier detection</h4>
<div class="standard" id="magicparlabel-7405">Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>r</mi><mo>&gt;</mo><mn>0</mn>
</mrow>
</mrow></math> be a distance threshold and <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi> τ </mi><mo> ∈ </mo><mo>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>]</mo>
</mrow>
</mrow></math> be a fraction threshold. An object <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> is a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>B</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>r</mi><mo>,</mo><mi> τ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>-</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>r</mi>
</mrow>
</mrow></math> if<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<mfrac>
<mrow>
<mrow><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>o</mi><mo>'</mo><mo>|</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mo>,</mo><mi>o</mi><mo>'</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≤ </mo><mi>r</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
</mrow>
</mrow>
<mrow>
<mrow><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>D</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac><mo> ≤ </mo><mi> τ </mi><mn>.</mn>
</mrow>
</mrow></math> So we count how many objects are within a distance of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math> and if these account to less than the predefined fraction <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi> τ </mi>
</mrow></math>, then <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> is considered an outlier.</div>
<div class="standard" id="magicparlabel-7406">If we do it just like this, we would test each object against the whole data set one by one. This can be very costly for big datasets, and can be improved with the <b>CELL method</b>, which is a grid-based method. In this case, the data space is partitioned into a multidimensional grid, in which is cell is a hyper cube with diagonal length <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mi>r</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
</mrow></math>. This allows us to improve the efficiency of the method by using two pruning rules:</div>
<ol class="enumerate" id="magicparlabel-7407"><li class="enumerate_item"><b>Definitions</b>: Let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> be the cell whose objects we want to assess:

<ol class="enumerate" id="magicparlabel-7408"><li class="enumerate_item">The <b>level-1</b> are the cells adjacent to cell <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math>.</li>
<li class="enumerate_item">The <b>level-2 </b>are the cells which have some point less than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math> distance from <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math>. </li>
</ol>
</li><li class="enumerate_item"><b>Cell <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math></b>: it is obvious that all objects in cell <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> are less than distance <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math> from each other. Call <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mo>=</mo><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>C</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>.</li>
<li class="enumerate_item"><b>Level-1 cell pruning rule</b>: let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>l</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>l</mi><mo>-</mo><mn>1</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mo>+</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>&gt;</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">⌈</mo>
<mrow><mi> τ </mi><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">⌉</mo>
</mrow>
</mrow></math>, then every object <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> is not a <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>B</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>r</mi><mo>,</mo><mi> τ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>-outlier because all objects in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>C</mi><mo> ∪ </mo><mi>l</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>l</mi><mo>-</mo><mn>1</mn>
</mrow>
</mrow></math> are in the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>r</mi>
</mrow></math>-neighborhood of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> and there are at least <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mo fence="true" form="prefix" stretchy="true" symmetric="true">⌈</mo>
<mrow><mi> τ </mi><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">⌉</mo>
</mrow></math>.</li>
<li class="enumerate_item"><b>Level-2 cell pruning rule</b>: let <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>l</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>l</mi><mo>-</mo><mn>2</mn>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>. If <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>a</mi><mo>+</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>1</mn>
</mrow>
</msub><mo>+</mo>
<msub>
<mrow><mi>b</mi>
</mrow>
<mrow><mn>2</mn>
</mrow>
</msub><mo>&lt;</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">⌈</mo>
<mrow><mi> τ </mi><mi>n</mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">⌉</mo>
<mo>+</mo><mn>1</mn>
</mrow>
</mrow></math>, then all objects in <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>C</mi>
</mrow></math> are <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi>D</mi><mi>B</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>r</mi><mo>,</mo><mi> τ </mi>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow></math>-outliers.</li>
</ol>
<h4 class="subsubsection" id="magicparlabel-7413"><span class="subsubsection_label">16.4.2</span> Density-based methods</h4>
<div class="standard" id="magicparlabel-7414">The idea in this case is that the density around an outlier object is significantly different from the density around its neighbors. Thus, we can use the relative density of an object against its neighbors as the indicator of the degree of the object being an outlier.</div>
<div class="standard" id="magicparlabel-7415">For this, we define the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-distance of an object <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> as the distance between <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> and its <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msup>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow><mi>t</mi><mi>h</mi>
</mrow>
</mrow>
</msup>
</mrow></math> nearest neighbor, and the <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math>-distance neighbourhood of <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow>
<msub>
<mrow><mi>N</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>o</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mo fence="true" form="prefix" stretchy="true" symmetric="true">{</mo>
<mrow><mi>o</mi><mo>'</mo><mo>|</mo><mi>o</mi><mo>'</mo><mo> ∈ </mo><mi>D</mi><mo>,</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow><mi>o</mi><mo>,</mo><mi>o</mi><mo>'</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
<mo> ≤ </mo><mi>d</mi><mi>i</mi><mi>s</mi>
<msub>
<mrow><mi>t</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>o</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">}</mo>
<mn>.</mn>
</mrow>
</mrow></math> Note that this set can have more than <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>k</mi>
</mrow></math> elements because multiple elements can have identical distance to <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math>. Thus the measure <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mfrac>
<mrow><mi>k</mi>
</mrow>
<mrow>
<mrow><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mrow>
<msub>
<mrow><mi>N</mi>
</mrow>
<mrow><mi>k</mi>
</mrow>
</msub><mo fence="true" form="prefix" stretchy="true" symmetric="true">(</mo>
<mi>o</mi>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
<mo fence="true" form="postfix" stretchy="true" symmetric="true">)</mo>
</mrow>
</mrow>
</mfrac>
</mrow></math> is an indicator of the density around the point <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math>, which can be compared with the rest to decide if <math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>o</mi>
</mrow></math> is an outlier or not.</div>
<h4 class="subsubsection" id="magicparlabel-7416"><span class="subsubsection_label">16.4.3</span> Clustering-based methods</h4>
<div class="standard" id="magicparlabel-7417">The idea now is to cluster the data and classify an object as an outlier if:</div>
<ol class="enumerate" id="magicparlabel-7418"><li class="enumerate_item">It does not belong to any cluster.</li>
<li class="enumerate_item">There is a large distance between the object and its closest cluster.</li>
<li class="enumerate_item">It belongs to a small or sparse cluster.</li>
</ol>
<div class="standard" id="magicparlabel-7421">This approach presents several advantages:</div>
<ul class="itemize" id="magicparlabel-7422"><li class="itemize_item">It can detect outliers without the need to label the data.</li>
<li class="itemize_item">It works for many datatypes.</li>
<li class="itemize_item">Clusters can be regarded as summaries of the data.</li>
<li class="itemize_item">The detection is fast once the clusters are obtained, because we only need to compare any object against the clusters.</li>
</ul>
<div class="standard" id="magicparlabel-7426">But it also has some drawbacks:</div>
<ul class="itemize" id="magicparlabel-7427"><li class="itemize_item">The effectiveness depends on the cluster method used.</li>
<li class="itemize_item">The cost of the clustering can be high. This can be partially fixes using fixed-width clustering:

<ul class="itemize" id="magicparlabel-7429"><li class="itemize_item">A point is assigned to a cluster if the center of the cluster is within a predefined distance threshold from the point.</li>
<li class="itemize_item">If the point cannot be assigned to any existing cluster, a new cluster is created and the distance threshold may be learned from the training data under certain conditions.</li>
</ul>
</li></ul>
<div class="standard" id="magicparlabel-7431"><br/>
</div>
<div class="standard" id="magicparlabel-7432"><h2 class="bibtex">References</h2><div class="bibtex"><div class="bibtexentry" id="LyXCite-Aggarwal_2015"><span class="bibtexlabel">1</span><span class="bibtexinfo"><span class="bib-fullnames:author">Charu C. Aggarwal</span>, <i><span class="bib-title">Data Mining</span></i> (<span class="bib-publisher">Springer International Publishing</span>, <span class="bib-year">2015</span>).</span></div>
<div class="bibtexentry" id="LyXCite-flajolet2007hyperloglog"><span class="bibtexlabel">2</span><span class="bibtexinfo"><span class="bib-fullnames:author">Philippe Flajolet, Éric Fusy, Olivier Gandouet, and Frédéric Meunier</span>, "<span class="bib-title">Hyperloglog: the analysis of a near-optimal cardinality estimation algorithm</span>", in <i><span class="bib-booktitle">Discrete Mathematics and Theoretical Computer Science</span></i> (<span class="bib-year">2007</span>), pp. <span class="bib-pages">137--156</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Sakr2022"><span class="bibtexlabel">3</span><span class="bibtexinfo"><span class="bib-fullnames:author">Mahmoud Sakr</span>, "<span class="bib-title">INFOH423 Data Mining</span>".</span></div>
<div class="bibtexentry" id="LyXCite-witten2011"><span class="bibtexlabel">4</span><span class="bibtexinfo"><span class="bib-fullnames:author">Ian Witten, Eibe Frank, and Mark Hall</span>, <i><span class="bib-title">Data Mining: Practical Machine Learning Tools and Techniques</span></i> (<span class="bib-publisher">Elsevier</span>, <span class="bib-year">2011</span>).</span></div>
</div></div>
</body>
</html>
