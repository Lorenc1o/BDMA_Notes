#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{footmisc}
\usepackage{listings}
\usepackage{colortbl}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{1,0.99,0.94}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,  
    frame=single,
    tabsize=2
}

\lstset{style=mystyle}
\end_preamble
\use_default_options true
\begin_modules
tcolorbox
customHeadersFooters
theorems-ams-bytype
theorems-sec-bytype
algorithm2e
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=blue, urlcolor=blue, citecolor=blue, pdfstartview={FitH}, unicode=true"
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\boxbgcolor #62a0ea
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 3cm
\rightmargin 2cm
\bottommargin 3cm
\headheight 2cm
\headsep 1cm
\footskip 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
BDMA - Machine Learning
\end_layout

\begin_layout Date
Fall 2023
\end_layout

\begin_layout Author
Jose Antonio Lorencio Abril
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename ../../../Decision-Modeling/LectureNotes/source/CS-logo.png
	scale 70

\end_inset


\end_layout

\begin_layout Standard
\align right
Professor: Tom Dupuis
\end_layout

\begin_layout Standard
\align right
Student e-mail: jose-antonio.lorencio-abril@student-cs.fr
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Address
This is a summary of the course 
\emph on
Machine Learning
\emph default
 taught at the Université Paris Saclay - CentraleSupélec by Professor Tom
 Dupuis in the academic year 23/24.
 Most of the content of this document is adapted from the course notes by
 Dupuis, 
\begin_inset CommandInset citation
LatexCommand cite
key "Dupuis2023"
literal "false"

\end_inset

, so I won't be citing it all the time.
 Other references will be provided when used.
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part
Deep Learning
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard

\series bold
Artificial Intelligence
\series default
 is a wide concept, encompassing different aspects and fields.
 We can understand the term AI as the multidisciplinary field of study that
 aims at recreating human intelligence using artificial means.
 This is a bit abstract, and, in fact, there is no single definition for
 what this means.
 Intelligence is not fully understood, and thus it is hard to assess whether
 an artificial invention has achieved intelligence, further than intuitively
 thinking so.
\end_layout

\begin_layout Standard
For instance, AI involves a whole variety of fields:
\end_layout

\begin_layout Itemize
Perception
\end_layout

\begin_layout Itemize
Knowledge
\end_layout

\begin_layout Itemize
Cognitive System
\end_layout

\begin_layout Itemize
Planning
\end_layout

\begin_layout Itemize
Robotics
\end_layout

\begin_layout Itemize
Machine Learning (Neural Networks)
\end_layout

\begin_layout Itemize
Natural Language Processing
\end_layout

\begin_layout Standard
Leveraging all of these, people try to recreate or even surpass human performanc
e in different tasks.
 For example, a computer program that can play chess better than any human
 could ever possibly play, such as Stockfish, or a system that is able to
 understand our messages and reply, based on the knowledge that it has learnt
 in the past, such as ChatGPT and similar tools.
 Other examples are self-driving cars, auto-controlled robots, etc.
\end_layout

\begin_layout Standard
Therefore, AI is a very wide term, which merges many different scientific
 fields.
 
\series bold
Machine Learning
\series default
, on the other side, is a narrower term, which deals with the study of the
 techniques that we can use to make a computer learn to perform some task.
 It takes concepts from Statistics, Optimization Theory, Computer Science,
 Algorithms, etc.
 A relevant subclass of Machine Learning, which has come to be one of the
 most prominent fields of research in the recent years, is 
\series bold
Neural Networks 
\series default
or 
\series bold
Deep Learning
\series default
, which consists on an ML technique based on the human brain.
 Many amazing use cases that we see everywhere, like Siri (Apple assistant),
 Cortana (Windows assistant), Amazon recommender system, Dall-E (OpenAI
 image generation system), etc.
 Not only this, but the trend is growing, and the interest in DL is continuously
 increasing.
\end_layout

\begin_layout Standard
This is partly also due to the increase in computing resources, and the
 continuous optimization that different techniques are constantly experiencing.
 For instance, for a model trained on one trillion data points, in 2021
 the training process required around 16500x less compute than a model trained
 in 2012.
\end_layout

\begin_layout Standard
But not everything is sweet and roses when using DL.
 Since these systems are being involved in decision making processes, there
 are some questions that arise, like whose responsibility is it when a model
 fails? Moreover, data is needed to train the models, so it is relevant
 to address how datasets should be collected, and to respect the privacy
 of the people that produce data.
 In addition, the recent technologies that are able to generate new content
 and to modify real content, make it a new issue that AI can create false
 information, mistrust, and even violence or paranoia.
\end_layout

\begin_layout Standard
Nonetheless, let's not focus on the negative, there are lots of nice application
s of DL, and it is a key component to deal with data, achieving higher performan
ce than traditional ML techniques for huge amount of data.
\end_layout

\begin_layout Subsection
AI History
\end_layout

\begin_layout Standard
In 1950, Alan turing aimed to answer the question '
\emph on
Can machines think?
\emph default
' through a test, which came to be named the 
\series bold
Turing Test
\series default
, and consists in a 3 players game.
 First, a similar game is the following: 2 talkers, a man and a female,
 and 1 interrogator.
 The interrogator asks questions to the talkers, with the aim of determining
 who is the man and who is the female.
 The man tries to trick the interrogator, while the woman tries to help
 him to identify her.
\end_layout

\begin_layout Standard
Then, the Turing Test consists in replacing the man by an artificial machine.
 Turing thought that a machine that could trick a human interrogator, should
 be considered intelligent.
\end_layout

\begin_layout Standard
Later, in 1956, in the Dartmouth Workshop organized by IBM, the term 
\series bold
Artificial Intelligence
\series default
 was first used to describe 
\emph on
every aspect of learning or any other feature of intelligence can be so
 precisely described that a machine can be made to simulate it
\emph default
.
\end_layout

\begin_layout Standard
From this year on, there was a focus on researching about 
\series bold
Symbolic AI
\series default
, specially in three areas of research:
\end_layout

\begin_layout Itemize
Reasoning as search: a different set of actions leads to a certain goal,
 so we can try to find the best choice of action to obtain the best possible
 outcome.
\end_layout

\begin_layout Itemize
Natural Language: different tools were developed, following grammar and
 language rules.
\end_layout

\begin_layout Itemize
Micro world: small block based worlds, that the system can identify and
 move.
\end_layout

\begin_layout Standard
In 1958, the 
\series bold
Perceptron
\series default
 was conceived, giving birth to what is called the connectionism, an approach
 to AI based on the human brain, and a big hype that encouraged funding
 to support AI research.
 At this era, scientists experience a bit of lack of perspective, thinking
 that the power of AI was much higher than it was.
 For instance, H.
 A.
 Simon stated in 1965 that '
\emph on
machines will be capable, within twenty years, of doing any work a man can
 do.
\emph default
' We can relate to our time, with the huge hype that AI is experiencing,
 as well as the many apocaliptic theories that some people are making.
 Maybe we are again overestimating the power of AI.
\end_layout

\begin_layout Standard
The time from 1974 to 1980 is seen as the first winter of AI, in which research
 was slowed down and funding was reduced.
 This was due to several problems found at the time:
\end_layout

\begin_layout Itemize
There were few computational resources.
\end_layout

\begin_layout Itemize
The models at the time were not scalable.
\end_layout

\begin_layout Itemize
The Moravec's paradox: it is comparatively easy to make computers exhibit
 adult level performance on intelligence test or playing checkers, and difficult
 or impossible to give them the skills of a one-year-old when it comes to
 perception and mobility.
\end_layout

\begin_layout Itemize
Marvin Minsky made some devastating critics to connectionism, compared to
 symbolic, rule-based models:
\end_layout

\begin_deeper
\begin_layout Itemize
Limited capacity: Minsky showed that single-layer perceptrons (a simple
 kind of neural network) could not solve certain classes of problems, like
 the XOR problem.
 While it was later shown that multi-layer perceptrons could solve these
 problems, Minsky's work resulted in a shift away from neural networks for
 a time.
\end_layout

\begin_layout Itemize
Lack of clear symbols: Minsky believed that human cognition operates at
 a higher level with symbols and structures (like frames and scripts), rather
 than just distributed patterns of activation.
 He often argued that connectionist models lacked a clear way to represent
 these symbolic structures.
\end_layout

\begin_layout Itemize
Generalization and Abstraction: Minsky was concerned that connectionist
 models struggled with generalizing beyond specific training examples or
 abstracting high-level concepts from raw data.
\end_layout

\begin_layout Itemize
Inefficiency: Minsky pointed out that many problems which seemed simple
 for symbolic models could be extremely computationally intensive for connection
ist models.
\end_layout

\begin_layout Itemize
Lack of explanation: Connectionist models, especially when they become complex,
 can be seen as "black boxes", making it difficult to interpret how they
 arrive at specific conclusions.
\end_layout

\begin_layout Itemize
Over-reliance on learning: Minsky believed that not all knowledge comes
 from learning from scratch, and some of it might be innate or structured
 in advance.
 He felt connectionism put too much emphasis on learning from raw data.
\end_layout

\end_deeper
\begin_layout Standard
In 1980, there was a boom in expert knowledge systems that made AI recover
 interest.
 An 
\series bold
expert system
\series default
 solves specific tasks following an ensemble of rules based on knowledge
 facilitated by experts.
 A remarkable use case was the XCON sorting system, developed for the Digital
 Equipment Corporation, which helped them save 40M$ per year.
 In addition, connectionism also came again on scene, thanks to the development
 of 
\series bold
backpropagation
\series default
 applied to neurons, by Geoffrey Hinton.
 All these achievement made funding to come back to the field.
\end_layout

\begin_layout Standard
Nonetheless, there came a second winter of AI, from 1987 to 1994, mainly
 because several companies were disappointed and AI was seen as a technology
 that couldn't solve wide varieties of tasks.
 The funding was withdrawn from the field and a lot AI companies went bankrupt.
\end_layout

\begin_layout Standard
Luckily, from 1995 there started a new return of AI in the industry.
 The Moore's Law states that speed and memory of computer doubles every
 two years, and so computing power and memory was rapidly increasing, making
 the use of AI systems more feasible each year.
 During this time, many new concepts were introduced, such as 
\series bold
intelligent agents
\series default
 as systems that perceive their environment and take actions which maximize
 their chances of success; or different 
\series bold
probabilistic reasoning tools
\series default
 such as Bayesian networks, hidden Markov models, information theory, SVM,...
 In addition, AI researchers started to reframe their work in terms of mathemati
cs, computer science, physics, etc., making the field more attractive for
 funding.
 A remarkable milestone during this time was the victory of Deep Blue against
 Garry Kasparov.
\end_layout

\begin_layout Standard
The last era of AI comes from 2011 to today, with the advent and popularization
 of 
\series bold
Deep Learning
\series default
 (DL), which are deep graph processing layers mimicking human neurons interactio
ns.
 This happened thanks to the advances of hardware technologies, that have
 enabled the enormous computing requirements needed for DL.
 The huge hype comes from the spectacular results shown by this kind of
 systems in a huge variety of tasks, such as computer vision, natural language
 processing, anomaly detection,...
\end_layout

\begin_layout Standard
In summary, we can see how the history of AI has been a succession of hype
 and dissapointment cycles, with many actors involved and the industry as
 a very important part of the process.
\end_layout

\begin_layout Section
Machine Learning Basics
\end_layout

\begin_layout Standard
In this section, we review some notation, and basic knowledge of Linear
 Algebra, Probability and Machine Learning.
\end_layout

\begin_layout Subsection
Linear Algebra Basics
\end_layout

\begin_layout Standard
A 
\series bold
scalar
\series default
 is a number, either real and usually denoted 
\begin_inset Formula $x\in\mathbb{R}$
\end_inset

, or natural and denoted 
\begin_inset Formula $n\in\mathbb{N}$
\end_inset

.
 A 
\series bold
vector
\series default
 is an array of numbers, usually real, 
\begin_inset Formula $x\in\mathbb{R}^{n},$
\end_inset

 or
\begin_inset Formula 
\[
x=\left[\begin{array}{c}
x_{1}\\
x_{2}\\
\vdots\\
x_{n}
\end{array}\right].
\]

\end_inset

 A 
\series bold
matrix
\series default
 is a 2-dimensional array of numbers, 
\begin_inset Formula $A\in\mathbb{R}^{n\times m}$
\end_inset

, or
\begin_inset Formula 
\[
A=\left[\begin{array}{ccc}
A_{11} & \dots & A_{1n}\\
\vdots & \ddots & \vdots\\
A_{m1} & \dots & A_{mn}
\end{array}\right].
\]

\end_inset

 A 
\series bold
tensor
\series default
 is an 
\begin_inset Formula $n$
\end_inset

-dimensional array of numbers, for example 
\begin_inset Formula $A\in\mathbb{R}^{m\times k\times p}$
\end_inset

 is a 3-dimensional tensor.
\end_layout

\begin_layout Standard
Usually, we will be working with matrices, which can be operated in different
 ways:
\end_layout

\begin_layout Itemize
Transposition: 
\begin_inset Formula $A^{T}$
\end_inset

 is the transposed of 
\begin_inset Formula $A$
\end_inset

, defined as 
\begin_inset Formula $\left(A^{T}\right)_{ij}=A_{j,i}$
\end_inset

.
\end_layout

\begin_layout Itemize
Multiplication: Let 
\begin_inset Formula $A\in\mathbb{R}^{m\times k},B\in\mathbb{R}^{k\times n}$
\end_inset

, their multiplication, 
\begin_inset Formula $C\in\mathbb{R}^{m\times n}$
\end_inset

 is defined as 
\begin_inset Formula 
\[
C=A\cdot B=AB=\left(C_{ij}\right)_{i\leq m,j\leq n}=\left(\sum_{k}A_{ik}B_{kj}\right)_{i\leq m,j\leq n}.
\]

\end_inset

 Note that the following holds for every matrix 
\begin_inset Formula $A,B$
\end_inset

:
\begin_inset Formula 
\[
\left(AB\right)^{T}=B^{T}A^{T}.
\]

\end_inset


\end_layout

\begin_layout Itemize
Point-wise operations: if we have two matrices of the same size, 
\begin_inset Formula $A,B\in\mathbb{R}^{m\times n}$
\end_inset

, we can use apply scalar operator point-wise to each pair of elements in
 the same position in the two matrices.
 For example, the sum or the substraction of matrices.
\end_layout

\begin_layout Standard
There are also special matrices:
\end_layout

\begin_layout Itemize
Identity matrix: the identity matrix is a square matrix that preserves any
 vector it is multiplied with.
 For vectors of size 
\begin_inset Formula $n$
\end_inset

, the identity matrix 
\begin_inset Formula $I_{n}$
\end_inset

 verifies
\begin_inset Formula 
\[
I_{n}x=x,\forall x\in\mathbb{R}^{n}.
\]

\end_inset


\end_layout

\begin_layout Itemize
Inverse matrix: the inverse of a square matrix, 
\begin_inset Formula $A\in\mathbb{R}^{n\times n}$
\end_inset

, when it exists, is defined as the only matrix 
\begin_inset Formula $A^{-1}$
\end_inset

 such that
\begin_inset Formula 
\[
A^{-1}A=AA^{-1}=I_{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
Another important concept is that of the norm, which is basically measuring
 how far a point is from the origin of the space and can be used to measure
 distances:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
A 
\series bold
norm
\series default
 is a function 
\begin_inset Formula $f$
\end_inset

 that measures the size of vectors, and must have the following properties:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $f\left(x\right)=0\iff x=0,$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $f\left(x+y\right)\leq f\left(x\right)+f\left(y\right),$
\end_inset

 and
\end_layout

\begin_layout Itemize
\begin_inset Formula $\forall\alpha\in\mathbb{R},f\left(\alpha x\right)=\left|\alpha\right|f\left(x\right).$
\end_inset


\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
A very important family of norms is the 
\begin_inset Formula $L^{p}$
\end_inset

 norm, defined as
\begin_inset Formula 
\[
\left\Vert x\right\Vert _{p}=\left(\sum_{i}\left|x_{i}\right|^{p}\right)^{\frac{1}{p}}.
\]

\end_inset

 The 
\series bold
Euclidean norm
\series default
 is the 
\begin_inset Formula $L^{2}$
\end_inset

 norm, noted 
\begin_inset Formula $\left\Vert x\right\Vert $
\end_inset

 and equivalent to computing 
\begin_inset Formula $\sqrt{x^{T}x}$
\end_inset

.
 In Machine Learning, it is not uncommon to find the use of the squared
 Euclidean norm, since it maintains the ordinals and is easier to operate
 with.
 The 
\series bold
Manhattan norm
\series default
 is the 
\begin_inset Formula $L^{1}$
\end_inset

 norm, and it is used when the difference between zero and nonzero elements
 is important.
 Finally, the 
\series bold
Max norm
\series default
 is the 
\begin_inset Formula $L^{\infty}$
\end_inset

, or 
\begin_inset Formula $\left\Vert x\right\Vert _{\infty}=\max_{i}\left|x_{i}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Probability Basics
\end_layout

\begin_layout Standard
A 
\series bold
random variable
\series default
, 
\begin_inset Formula $X$
\end_inset

, is a variable that can take different values, 
\begin_inset Formula $x$
\end_inset

, randomly.
 They can be 
\series bold
discrete
\series default
, like the number drawn from a dice, or 
\series bold
continuous
\series default
, like the humidity in the air.
\end_layout

\begin_layout Standard
A probability distribution, 
\begin_inset Formula $p$
\end_inset

, is a 
\series bold
Probability Mass Function (PMF)
\series default
 for discrete variables, and a 
\series bold
Probability Density Function (PDF)
\series default
 for continuous random variables.
 It must satisfy:
\end_layout

\begin_layout Itemize
The domain of 
\begin_inset Formula $p$
\end_inset

 describe all possible states of 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\forall x\in X,p\left(x\right)\geq0$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\int_{x\in X}p\left(x\right)dx=1$
\end_inset

.
\end_layout

\begin_layout Standard
It is usual to have two (or more) random variables, 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

, and to be interested in the probability distribution of their combination,
 
\begin_inset Formula $p\left(x,y\right)$
\end_inset

.
 In this context, we define the 
\series bold
marginal probability
\series default
 of the variable 
\begin_inset Formula $X$
\end_inset

 as
\begin_inset Formula 
\[
p\left(X=x\right)=\int_{y\in Y}p\left(x,y\right)dy,\forall x\in X.
\]

\end_inset

 The 
\series bold
conditional probability
\series default
 of the variable 
\begin_inset Formula $Y$
\end_inset

 conditioned to 
\begin_inset Formula $X=x$
\end_inset

 is
\begin_inset Formula 
\[
p\left(Y=y|X=x\right)=\frac{p\left(Y=y,X=x\right)}{P\left(X=x\right)}.
\]

\end_inset

 Finally, there is the 
\series bold
chain rule of conditional probabilities
\series default
, in which we start with 
\begin_inset Formula $n$
\end_inset

 random variables, 
\begin_inset Formula $X_{1},...,X_{n}$
\end_inset

, and it follows:
\begin_inset Formula 
\[
p\left(X_{1}=x_{1},...,X_{n}=x_{n}\right)=p\left(X_{1}=x_{1}\right)\prod_{i=2}^{n}p\left(X_{i}=x_{i}|X_{1}=x_{1},...,X_{i-1}=x_{i-1}\right).
\]

\end_inset


\end_layout

\begin_layout Example
For example, let's say 
\begin_inset Formula $X=\left\{ 1,2,3\right\} $
\end_inset

, 
\begin_inset Formula $Y=\left\{ 1,2\right\} $
\end_inset

 and 
\begin_inset Formula $Z=\left\{ 1,2\right\} $
\end_inset

 with the following probabilities:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p\left(x,y,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{6}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{6}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{12}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{24}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{24}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{20}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{20}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{20}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{6}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{12}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{20}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{20}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Example
Then, the marginal probabilities for the variable 
\begin_inset Formula $X$
\end_inset

 are
\begin_inset Formula 
\[
P\left(X=1\right)=\frac{1}{6}+\frac{1}{6}+\frac{1}{12}+\frac{1}{24}=\frac{11}{24},
\]

\end_inset


\begin_inset Formula 
\[
P\left(X=2\right)=\frac{1}{24}+\frac{1}{20}+\frac{1}{20}+\frac{1}{20}=\frac{23}{120},
\]

\end_inset


\begin_inset Formula 
\[
P\left(X=3\right)=\frac{1}{6}+\frac{1}{12}+\frac{1}{20}+\frac{1}{20}=\frac{21}{60}=\frac{7}{20}.
\]

\end_inset


\end_layout

\begin_layout Example
The conditional probability for the event 
\begin_inset Formula $\left\{ Y=1|X=3\right\} $
\end_inset

 is:
\begin_inset Formula 
\[
P\left(Y=1|X=3\right)=\frac{P\left(Y=1,X=3\right)}{P\left(X=3\right)}=\frac{\frac{1}{6}+\frac{1}{12}}{\frac{7}{20}}=\frac{\frac{1}{4}}{\frac{7}{20}}=\frac{5}{7}.
\]

\end_inset


\end_layout

\begin_layout Example
The conditional probability for the event 
\begin_inset Formula $\left\{ Z=1|X=3,Y=1\right\} $
\end_inset

 is:
\begin_inset Formula 
\[
P\left(Z=1|X=3,Y=1\right)=\frac{P\left(X=3,Y=1,Z=1\right)}{P\left(X=3,Y=1\right)}=\frac{\frac{1}{6}}{\frac{1}{4}}=\frac{2}{3}.
\]

\end_inset


\end_layout

\begin_layout Example
The probability of the event 
\begin_inset Formula $\left\{ X=3,Y=1,Z=1\right\} $
\end_inset

 could be computed from the conditional probabilities as follows, in case
 we only knew these:
\begin_inset Formula 
\begin{align*}
P\left(X=3,Y=1,Z=1\right)= & P\left(X=3\right)\cdot P\left(Y=1|X=3\right)\cdot P\left(Z=1|X=3,Y=1\right)\\
= & \frac{7}{20}\cdot\frac{5}{7}\cdot\frac{2}{3}=\frac{10}{60}=\frac{1}{6}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
When there are several variables, it is possible that the value of one of
 them is dependant, somehow, on the values that the other variables take;
 or that it is not:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
Two random variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are 
\series bold
independant
\series default
, denoted 
\begin_inset Formula $X\perp Y$
\end_inset

, if 
\begin_inset Formula $\forall x\in X,y\in Y,p\left(X=x,Y=y\right)=p\left(X=x\right)\cdot p\left(Y=y\right).$
\end_inset

 
\end_layout

\begin_layout Definition
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are 
\series bold
conditionally independent
\series default
 given the random variable 
\begin_inset Formula $Z$
\end_inset

, written 
\begin_inset Formula $X\perp_{Z}Y$
\end_inset

 if 
\begin_inset Formula $\forall x\in X,y\in Y,z\in Z$
\end_inset

,
\begin_inset Formula 
\[
p\left(X=x,Y=y|Z=z\right)=p\left(X=x|Z=z\right)\cdot p\left(Y=y|Z=z\right).
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In Statistics and Machine Learning, there are some measures that summarize
 information about random variables, and that hold great importance.
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
The 
\series bold
expectation
\series default
 of a function 
\begin_inset Formula $f\left(x\right)$
\end_inset

 where 
\begin_inset Formula $x\sim p\left(x\right)$
\end_inset

 is the average value of 
\begin_inset Formula $f$
\end_inset

 over 
\begin_inset Formula $x$
\end_inset

:
\begin_inset Formula 
\[
\mathbb{E}_{x\sim p}\left[f\left(x\right)\right]=\int_{x\in X}p\left(x\right)f\left(x\right)dx.
\]

\end_inset

 The 
\series bold
variance
\series default
 of 
\begin_inset Formula $f\left(x\right)$
\end_inset

 measures how the values of 
\begin_inset Formula $f$
\end_inset

 varies from its average:
\begin_inset Formula 
\[
Var\left[f\left(x\right)\right]=\mathbb{E}\left[\left(f\left(x\right)-\mathbb{E}\left[f\left(x\right)\right]\right)^{2}\right],
\]

\end_inset

 and the 
\series bold
standard deviation 
\series default
is the square root of the variance.
\end_layout

\begin_layout Definition
The 
\series bold
covariance
\series default
 of two random variables provides informaiton about how much two values
 are linearly related.
 More generally, if we apply two functions 
\begin_inset Formula $f\left(x\right),$
\end_inset

 where 
\begin_inset Formula $x\sim p\left(x\right)$
\end_inset

, and 
\begin_inset Formula $g\left(y\right)$
\end_inset

, where 
\begin_inset Formula $y\sim p\left(y\right)$
\end_inset

, the covariance between them is:
\begin_inset Formula 
\[
Cov\left[f\left(x\right),g\left(y\right)\right]=\mathbb{E}\left[\left(f\left(x\right)-\mathbb{E}\left[f\left(x\right)\right]\right)\left(g\left(y\right)-\mathbb{E}\left[g\left(y\right)\right]\right)\right].
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Machine Learning Basics
\end_layout

\begin_layout Standard
To finalize with this review chapter, we are going to remember some basic
 concepts of Machine Learning.
\end_layout

\begin_layout Standard
First, let's give a definition of the concept:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
A computer program is said to 
\series bold
learn
\series default
 from experience 
\begin_inset Formula $E$
\end_inset

 with respect to some class of tasks 
\begin_inset Formula $T$
\end_inset

 and performance measure 
\begin_inset Formula $P$
\end_inset

, if its performance at tasks in 
\begin_inset Formula $T$
\end_inset

, as measured by 
\begin_inset Formula $P$
\end_inset

, improves with experience 
\begin_inset Formula $E$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\series bold
task
\series default
 
\begin_inset Formula $T$
\end_inset

 can be classification, regression, translation, generation, anomaly detection,...
\end_layout

\begin_layout Itemize
The 
\series bold
performance measure 
\begin_inset Formula $P$
\end_inset

 
\series default
is specific to the tasks involved, and can be accuracy for classification,
 for example.
 It is measured on a 
\series bold
test set
\series default
.
\end_layout

\begin_layout Itemize
The 
\series bold
experience
\series default
 
\begin_inset Formula $E$
\end_inset

 is divided into two main categories:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Supervised learning
\series default
: a dataset of points associated with a label or a target determines the
 expected outcome of each event.
\end_layout

\begin_layout Itemize

\series bold
Unsupervised learning
\series default
: a dataset of points without labels or targets, in which the desirable
 outcome needs to be define in some different way.
\end_layout

\end_deeper
\begin_layout Standard
Mathematically, we can formalize this as having a dataset of 
\begin_inset Formula $m$
\end_inset

 points and 
\begin_inset Formula $k$
\end_inset

 features, which can be represented as a matrix 
\begin_inset Formula $X\in\mathbb{R}^{m\times k}$
\end_inset

.
 In the case of supervised learning, 
\begin_inset Formula $X$
\end_inset

 is associated with a vector of labels, 
\begin_inset Formula $y$
\end_inset

, and we aim to learn a joint distribution, 
\begin_inset Formula $p\left(X,y\right)$
\end_inset

 to infer
\begin_inset Formula 
\[
p\left(Y=y|X=x\right)=\frac{p\left(x,y\right)}{\sum_{y'}p\left(x,y'\right)}.
\]

\end_inset

 The goal is then to find a function 
\begin_inset Formula $\hat{f}$
\end_inset

 that associates each 
\begin_inset Formula $x$
\end_inset

 to the best approximation of 
\begin_inset Formula $y$
\end_inset

, and that is capable of generalizing to unseen data.
 Usually, 
\begin_inset Formula $\hat{f}$
\end_inset

 is parameterized by a set of parameters, 
\begin_inset Formula $\theta$
\end_inset

, which are learnt during training.
\end_layout

\begin_layout Standard
The main challenge of an ML model is 
\series bold
generalization
\series default
 to unseen data estimated on test data after the training on training data.
 
\series bold
Overfitting
\series default
 occurs when the gap between training error and test error is too large,
 while 
\series bold
underfitting
\series default
 occurs when the training error is too large.
 The 
\series bold
capacity
\series default
 of a model is the range of functions that it is able to leanr and control
 how likely the model can overfit or underfit.
 This is visualized in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Appropriate-capacity,-overfittin"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename pegado1.png
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Appropriate-capacity,-overfittin"

\end_inset

Appropriate capacity, overfitting and underfitting visualization.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
When we want to train a model, we will define the parameters that characterize
 it, and then we need to obtain the best possible of the parameters, according
 to the data.
 For this, we use estimators:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
Given an unknown parameter 
\begin_inset Formula $\theta$
\end_inset

, we estimate it through an 
\series bold
estimator
\series default
, 
\begin_inset Formula $\hat{\theta}$
\end_inset

.
 A 
\series bold
point estimator
\series default
 is a function of the data, 
\begin_inset Formula $X$
\end_inset

,
\begin_inset Formula 
\[
\hat{\theta}=g\left(X\right).
\]

\end_inset

 The 
\series bold
bias
\series default
 of an estimator is
\begin_inset Formula 
\[
bias\left(\hat{\theta}\right)=\mathbb{E}\left[\hat{\theta}\right]-\theta.
\]

\end_inset

 An estimator is 
\series bold
unbiased 
\series default
if 
\begin_inset Formula $bias\left(\hat{\theta}\right)=0$
\end_inset

.
\end_layout

\begin_layout Definition
The 
\series bold
variance
\series default
 of an estimator is 
\begin_inset Formula $Var\left(\hat{\theta}\right)$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
There are different ways to construct estimators, but one that is frequently
 used and that has solid mathematical foundations is the 
\series bold
maximum likelihood estimator
\series default
.
 Consider a dataset 
\begin_inset Formula $X=\left\{ x_{1},...,x_{n}\right\} $
\end_inset

 and 
\begin_inset Formula $p\left(x;\theta\right)$
\end_inset

 a parametric family of probability distribution that maps for each 
\begin_inset Formula $x$
\end_inset

 the probability 
\begin_inset Formula $p_{data}\left(x\right)$
\end_inset

.
 This is, for each 
\begin_inset Formula $\theta$
\end_inset

, 
\begin_inset Formula $p\left(x;\theta\right)$
\end_inset

 is a probability density function.
 The maximum likelihood estimator is then
\begin_inset Formula 
\begin{align*}
\theta_{ML}= & \arg\max_{\theta}p_{model}\left(X;\theta\right)\\
= & \arg\max_{\theta}\prod_{i=1}^{n}p_{model}\left(x_{i};\theta\right),
\end{align*}

\end_inset

 considering that all instances of data are independent and identically
 distributed (iid).
 It is also a common practice to use the maximum 
\series bold
log
\series default
-likelihood instead, removing the product and avoiding floating point issues,
 since when the dataset is large, the product will rapidly go to 0.
 In addition, the logarithm does not modify the ordinals of the function.
 Therefore, we can use:
\begin_inset Formula 
\[
\theta_{ML}=\arg\max_{\theta}\sum_{i=1}^{n}\log\left(p_{model}\left(x_{i};\theta\right)\right).
\]

\end_inset


\end_layout

\begin_layout Section
Deep Neural Networks
\end_layout

\begin_layout Subsection
Perceptron
\end_layout

\begin_layout Standard
A deeper explanation of the perceptron can be read in my notes from another
 course, 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://lorenc1o.github.io/BDMA_Notes/universities/UPC/Machine_Learning_summary.pdf
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
A perceptron is an algorithm for supervised learning of binary classifiers.
 That is, we have a dataset 
\begin_inset Formula $X\in\mathbb{R}^{n\times m}$
\end_inset

 associated with a vector of labels 
\begin_inset Formula $y\in\left\{ 0,1\right\} ^{n}$
\end_inset

.
 Then, the perceptron learns a function 
\begin_inset Formula $\hat{f}$
\end_inset

 parametrized by a vector of weights 
\begin_inset Formula $w\in\mathbb{R}^{m}$
\end_inset

 and a bias 
\begin_inset Formula $b$
\end_inset

, such that:
\begin_inset Formula 
\[
\hat{f}\left(x\right)=\begin{cases}
1 & if\ w\cdot x+b>0\\
0 & \sim
\end{cases}.
\]

\end_inset


\end_layout

\begin_layout Standard
Therefore, it is a linear classifier, which divides the input space into
 two regions separated by a hyperplane.
 This means that a perceptron cannot separate non-linear data.
\end_layout

\begin_layout Subsection
Multi-layer perceptron
\end_layout

\begin_layout Standard
A deeper explanation of the MLP can be read in my notes from another course,
 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://lorenc1o.github.io/BDMA_Notes/universities/UPC/Machine_Learning_summary.pdf
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
When we say 'Deep' neural network, we refer to a series of stacked perceptrons.
 However, just like this, the model is still linear.
 This is why activation functions are introduced.
 An 
\series bold
activation function
\series default
 is a function that is applied to the output of a perceptron, to make it
 non linear.
\end_layout

\begin_layout Standard
For example, ReLU is a piecewise-linear function defined as
\begin_inset Formula 
\[
ReLU\left(z\right)=\begin{cases}
z & if\ z\geq0\\
0 & \sim
\end{cases}=\max\left\{ z,0\right\} .
\]

\end_inset

 This function preserves much of the good oprimization properties of a linear
 function, i.e., it is differentiable (apart from one point), and its derivative
 is constant.
\end_layout

\begin_layout Example
Learn the XOR function with a 2-layer MLP.
\end_layout

\begin_layout Example
The XOR function is represented with the table:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Example
We want to use a 2-layer MLP to learn this function:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename xor.drawio.png
	scale 60

\end_inset


\end_layout

\end_deeper
\begin_layout Example
In 
\begin_inset Formula $h_{1}$
\end_inset

, it will be
\begin_inset Formula 
\[
w_{11}x_{1}+w_{12}x_{2}+b_{1},
\]

\end_inset

 and in 
\begin_inset Formula $h_{2}$
\end_inset


\begin_inset Formula 
\[
w_{11}x_{1}+w_{12}x_{2}+b_{1}.
\]

\end_inset

 This can be represented as
\begin_inset Formula 
\[
h=W_{h}^{T}X+b_{h}.
\]

\end_inset

 Then, we apply ReLU
\begin_inset Formula 
\[
\max\left(0,W_{h}^{T}X+b_{h}\right),
\]

\end_inset

 and finally the output layer
\begin_inset Formula 
\[
y=W_{y}^{T}\max\left(0,W_{h}^{T}X+b_{h}\right)+b_{y}.
\]

\end_inset


\end_layout

\begin_layout Example
Let's see the different inputs:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
w_{11} & w_{12}\\
w_{21} & w_{22}
\end{array}\right)\left(\begin{array}{c}
0\\
0
\end{array}\right)+\left(\begin{array}{c}
b_{1}\\
b_{2}
\end{array}\right)=\left(\begin{array}{c}
b_{1}\\
b_{2}
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
w_{1}^{y} & w_{2}^{y}\end{array}\right)\left(\begin{array}{c}
\max\left(0,b_{1}\right)\\
\max\left(0,b_{2}\right)
\end{array}\right)+b_{y}\leq0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
w_{12}+b_{1}\\
w_{22}+b_{2}
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
w_{1}^{y} & w_{2}^{y}\end{array}\right)\left(\begin{array}{c}
\max\left(0,w_{12}+b_{1}\right)\\
\max\left(0,w_{22}+b_{2}\right)
\end{array}\right)+b_{y}>0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
w_{11}+b_{1}\\
w_{21}+b_{2}
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
w_{1}^{y} & w_{2}^{y}\end{array}\right)\left(\begin{array}{c}
\max\left(0,w_{11}+b_{1}\right)\\
\max\left(0,w_{21}+b_{2}\right)
\end{array}\right)+b_{y}>0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
w_{11}+w_{12}+b_{1}\\
w_{21}+w_{22}+b_{2}
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
w_{1}^{y} & w_{2}^{y}\end{array}\right)\left(\begin{array}{c}
\max\left(0,w_{11}+w_{12}+b_{1}\right)\\
\max\left(0,w_{21}+w_{22}+b_{2}\right)
\end{array}\right)+b_{y}\leq0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Example
A solution is:
\begin_inset Formula 
\[
W_{h}=\left(\begin{array}{cc}
1 & 1\\
1 & 1
\end{array}\right),b_{h}=\left(\begin{array}{c}
0\\
-1
\end{array}\right),W_{y}=\left(\begin{array}{c}
1\\
-2
\end{array}\right),b=0.
\]

\end_inset

 Let's check:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
0\\
-1
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
1 & -2\end{array}\right)\left(\begin{array}{c}
0\\
0
\end{array}\right)=0\leq0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
1\\
1-1
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
1 & -2\end{array}\right)\left(\begin{array}{c}
1\\
0
\end{array}\right)=1>0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
1\\
1-1
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
1 & -2\end{array}\right)\left(\begin{array}{c}
1\\
0
\end{array}\right)=1>0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{c}
1+1\\
1+1-1
\end{array}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\begin{array}{cc}
1 & -2\end{array}\right)\left(\begin{array}{c}
2\\
1
\end{array}\right)=0\leq0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Example
So, it works! Note that this solution is not unique!
\end_layout

\begin_layout Example
What happens is actually that the solution for the XOR problem is not linearly
 separable:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename xor_space.png
	scale 60

\end_inset


\end_layout

\end_deeper
\begin_layout Example
But, the hidden layer transforms this space, making the problem linearly
 separable, and therefore solvable in the last layer:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename xor_space_trans.png
	scale 60

\end_inset


\end_layout

\end_deeper
\begin_layout Subsection
Cost Functions
\end_layout

\begin_layout Standard
The cost function is important when working with neural networks, because
 our goal is to ultimately train the model to solve some problem, and the
 cost functions will be the function that our model will aim at minimizing,
 thus guiding the training process.
\end_layout

\begin_layout Standard
Usually, we will need to choose a cost function 
\begin_inset Formula $\mathcal{L}$
\end_inset

 that is suitable for our problem.
 Then, we will minimize 
\begin_inset Formula $\mathcal{L}$
\end_inset

 with stochastic gradient descent, by:
\end_layout

\begin_layout Itemize
Training on a training dataset.
\end_layout

\begin_layout Itemize
Estimating error on an evaluation dataset.
\end_layout

\begin_layout Itemize
Computing the gradients using backpropagation.
\end_layout

\begin_layout Standard
In this process, we will aim to find good local minima, instead of global
 minimum.
 This is related to overfitting (learning only the training data, losing
 generalization capabilities), and to the empirical fact that deep neural
 network have surprisingly good local and non-global optima.
\end_layout

\begin_layout Subsubsection
Choice of cost function
\end_layout

\begin_layout Standard
In the general case, we use the maximum likelihood principle, taking the
 output types of the network into account.
 This means that we assume our dataset 
\begin_inset Formula $\left\{ x_{1},...,x_{n}\right\} $
\end_inset

 to be independently and identically distributed (i.i.d.) from an unknown distribut
ion, 
\begin_inset Formula $p_{data}\left(x\right)$
\end_inset

.
 We choose a parametric model family 
\begin_inset Formula $p_{model}\left(x;\theta\right)$
\end_inset

 represented as a neural network, which we use to estimate an approximation
 of the true distribution.
 For this, we utilize the 
\series bold
maximum likelihood estimator
\series default
, defined as
\begin_inset Formula 
\[
\theta_{ML}=\arg\max_{\theta}\prod_{i=1}^{n}p_{model}\left(x_{i};\theta\right).
\]

\end_inset

 Usually, to avoid floating point errors, the log-likelihood is used instead:
\begin_inset Formula 
\[
\theta_{ML}=\arg\max_{\theta}\sum_{i=1}^{n}\log p_{model}\left(x_{i};\theta\right).
\]

\end_inset


\end_layout

\begin_layout Standard
In the maximum likelihood estimation framework, we might apply activation
 functions to the output layer to get a desired structure for our distribution.
 This choice will also influence the mathematical form of the cost function.
 For example, we can use linear units for regression or for Gaussian distributio
ns, sigmoid units for binary classification or softmax units for multi-class
 classification.
\end_layout

\begin_layout Paragraph
Linear units for regression
\end_layout

\begin_layout Standard
A 
\series bold
linear output layer
\series default
 is such that, given the features 
\begin_inset Formula $h$
\end_inset

, the output is
\begin_inset Formula 
\[
\hat{y}=W^{T}h+b,
\]

\end_inset

 where 
\begin_inset Formula $W$
\end_inset

 is the weights vector and 
\begin_inset Formula $b$
\end_inset

 the bias.
\end_layout

\begin_layout Standard
We can use this to predict real or vector valued variables, such as prices,
 biometrics,...
\end_layout

\begin_layout Paragraph
Linear unit for Gaussian distribution
\end_layout

\begin_layout Standard
A 
\series bold
Gaussian output unit
\series default
 is such that, given features 
\begin_inset Formula $h$
\end_inset

, a linear layer produces a vector 
\begin_inset Formula $\hat{y}$
\end_inset

 representing the mean and the covariance matrix of a conditional Gaussian
 distribution:
\begin_inset Formula 
\[
p\left(y|x\right)=\mathcal{N}\left(y;\hat{y},I\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Covariance is usually not modelled or simplified to be diagonal (in which
 case we need to ensure that the output is non-negative).
\end_layout

\begin_layout Paragraph
Binary classification
\end_layout

\begin_layout Standard
In this case, the objective is to predict a binary variable, 
\begin_inset Formula $y$
\end_inset

: the neural network must predict 
\begin_inset Formula $P\left(y=1|x\right)$
\end_inset

.
 Thus, we must ensure that the output is a probability, in the interval
 
\begin_inset Formula $\left[0,1\right]$
\end_inset

.
 For this, we can take
\begin_inset Formula 
\[
P\left(y=1|x\right)=\max\left\{ 0,\min\left\{ 1,W^{T}h+b\right\} \right\} .
\]

\end_inset

 The problem with this approach is that if 
\begin_inset Formula $W^{T}h+b\notin\left[0,1\right]$
\end_inset

 then the gradient is 0 and the training will stop.
 To solve this issue, we can use a 
\series bold
sigmoid unit
\series default
, which is 
\begin_inset Formula 
\[
\hat{y}=\sigma\left(W^{T}h+b\right)=\frac{1}{1+e^{-W^{T}h+b}}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
Softmax unit for multi-class classification
\end_layout

\begin_layout Standard
Now our objective is to classify the input data into one among 
\begin_inset Formula $N>2$
\end_inset

 classes.
 We want to predict 
\begin_inset Formula $\hat{y}$
\end_inset

 with 
\begin_inset Formula $\hat{y_{i}}P\left(y=i|x\right)$
\end_inset

, subject to 
\begin_inset Formula $\hat{y_{i}}\in\left[0,1\right],\forall i$
\end_inset

 and 
\begin_inset Formula $\sum_{i}y_{i}=1$
\end_inset

.
\end_layout

\begin_layout Standard
In the output layer we can have 
\begin_inset Formula $N$
\end_inset

 perceptrons, each of them computing 
\begin_inset Formula $z_{i}=\log P\left(y=i|x\right)$
\end_inset

, i.e., the 
\series bold
logits
\series default
.
 With this, we can apply the 
\series bold
softmax output unit
\series default
 to all of them, obtaining our vector of probabilities, as
\begin_inset Formula 
\[
softmax\left(z\right)_{i}=\frac{e^{z_{i}}}{\sum_{j}e^{z_{j}}}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Cross-entropy
\end_layout

\begin_layout Standard
In classification problems we want to estimate the probability of different
 outcomes.
 Let the estimated probability of outcome 
\begin_inset Formula $i$
\end_inset

 be 
\begin_inset Formula $p_{model}\left(x=i\right)$
\end_inset

 with to-be-optimized parameters 
\begin_inset Formula $\theta$
\end_inset

 and let the frequency of outcome 
\begin_inset Formula $i$
\end_inset

 in the training set be 
\begin_inset Formula $p\left(x=i\right)$
\end_inset

.
 Given 
\begin_inset Formula $N$
\end_inset

 conditionally independent samples in the training set, then the likelihood
 of the parameters 
\begin_inset Formula $\theta$
\end_inset

 of the model 
\begin_inset Formula $p_{model}\left(x=i\right)$
\end_inset

 on the training set is:
\begin_inset Formula 
\[
\mathcal{L}\left(\theta\right)=\prod_{i\in X}p_{model}\left(x=i\right)^{N\cdot p\left(x=i\right)}.
\]

\end_inset

 Therefore, the log-likelihood, divided by 
\begin_inset Formula $N$
\end_inset

, is
\begin_inset Formula 
\[
\frac{1}{N}\log\left(\mathcal{L}\left(\theta\right)\right)=\frac{1}{N}N\cdot\sum_{i\in X}p\left(x=i\right)\log p_{model}\left(x=i\right)=\sum_{i\in X}p\left(x=i\right)\log p_{model}\left(x=i\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Cross-entropy minimization is frequently used in optimization and rare-event
 probability estimation.
 When comparing a distribution 
\begin_inset Formula $q$
\end_inset

 against a fixed reference distribution 
\begin_inset Formula $p$
\end_inset

, cross-entropy and KL divergence are identical up to an additive constant
 (since 
\begin_inset Formula $p$
\end_inset

 is fixed): According to the Gibbs' inequality, both take on their minimal
 values when 
\begin_inset Formula $p=q$
\end_inset

, which is 
\begin_inset Formula $0$
\end_inset

 for KL divergence, and 
\begin_inset Formula $H\left(p\right)$
\end_inset

 for cross-entropy.
 In the engineering literature, the principle of minimizing KL divergence
 (Kullback's "Principle of Minimum Discrimination Information") is often
 called the Principle of Minimum Cross-Entropy (MCE), or Minxent.
\end_layout

\begin_layout Subsection
Why deep NN?
\end_layout

\begin_layout Standard
Depth is the longest data path data can take from input to output.
 For a deep feed forward NN, depth is the number of hidden layers plus the
 output layer.
 State-of-the-art architectures used in practice have dozens to hundreds
 of layers.
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Theorem
Universal Approximation Theorem
\end_layout

\begin_layout Theorem
Let 
\begin_inset Formula $\varphi\left(\right)$
\end_inset

 be a nonconstant, bounded, and monotonically increasing continuous function.
 Let 
\begin_inset Formula $I_{m_{0}}$
\end_inset

 denote the 
\begin_inset Formula $m_{0}-$
\end_inset

dimensional unit hypercube, 
\begin_inset Formula $\left[0,1\right]^{m_{0}}$
\end_inset

.
 The space of continuous functions on 
\begin_inset Formula $I_{m_{0}}$
\end_inset

 is denoted by 
\begin_inset Formula $C\left(I_{m_{0}}\right)$
\end_inset

.
\end_layout

\begin_layout Theorem
Then, given any function 
\begin_inset Formula $f\in C\left(I_{m_{0}}\right)$
\end_inset

 and 
\begin_inset Formula $\varepsilon>0$
\end_inset

, there exists an integer 
\begin_inset Formula $m_{1}$
\end_inset

 and sets of real constants 
\begin_inset Formula $\alpha_{i},b_{i}$
\end_inset

 and 
\begin_inset Formula $w_{ij}\in\mathbb{R}$
\end_inset

 where 
\begin_inset Formula $i=1,...,m_{1}$
\end_inset

 and 
\begin_inset Formula $j=1,...,m_{0}$
\end_inset

 such that we may define
\begin_inset Formula 
\[
F\left(x\right)=\sum_{i=1}^{m_{1}}\alpha_{i}\cdot\varphi\left(\sum_{j=1}^{m_{0}}w_{ij}\cdot x_{j}+b_{i}\right)
\]

\end_inset

 as an approximate realization of the function 
\begin_inset Formula $f$
\end_inset

, that is
\begin_inset Formula 
\[
\left|F\left(x\right)-f\left(x\right)\right|<\varepsilon,\forall x\in I_{m}.
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This theorem is very relevant, because it says that for any mapping function
 
\begin_inset Formula $f$
\end_inset

 in supervised learning, there exists a MLP with 
\begin_inset Formula $m_{1}$
\end_inset

 neurons in the hidden layer which is able to approximate it with a desired
 precision.
\end_layout

\begin_layout Standard
However, it only proves the existence of a shallow (just one hidden layer)
 MLP with 
\begin_inset Formula $m_{1}$
\end_inset

 neurons in the hidden layer that can approximate the function, but it does
 not tell how to find this number.
\end_layout

\begin_layout Standard
As a rule of thumb for the generalization error, it is
\begin_inset Formula 
\[
\varepsilon=\frac{VC_{dim}\left(MLP\right)}{N},
\]

\end_inset

 where 
\begin_inset Formula $VC_{dim}$
\end_inset

 is the Vapnik-Chervonenkis dimension, a measure of the capacity of a model.
 It refers to the largest set of points that the model can shatter.
 It is not easy to compute, but a rough upper bound for a FFNN is 
\begin_inset Formula $O\left(W\log W\right)$
\end_inset

, with 
\begin_inset Formula $W$
\end_inset

 being the total number of weight in the network.
\end_layout

\begin_layout Standard
Also, this theorem hints us that having more neurons in the hidden layers
 will give us better training error, but worse generalization error: overfitting.
\end_layout

\begin_layout Standard
However, for most functions 
\begin_inset Formula $m_{1}$
\end_inset

 is very high, and becomes quickly computationally intractable: so we need
 to go deeper.
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Theorem
No Free Lunch Theorem
\end_layout

\begin_layout Theorem
Multiple informal formulations:
\end_layout

\begin_deeper
\begin_layout Itemize
For every learning algorithm A and B, there are as many problems where A
 has a better generalization error than problems where B has a better one.
\end_layout

\begin_layout Itemize
All learning algorithms ahve the same generalization error if we average
 over all learning problems.
\end_layout

\begin_layout Itemize
There is no universally better learning algorithm.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Plain Layout

\series bold
Depth Property
\end_layout

\begin_layout Plain Layout
The number of polygonal regions generated by a MLP with a ReLU function,
 
\begin_inset Formula $d$
\end_inset

 inputs, 
\begin_inset Formula $n$
\end_inset

 neurons per hidden layer and 
\begin_inset Formula $l$
\end_inset

 layers is
\begin_inset Formula 
\[
O\left(\binom{n}{d}^{d\left(l-1\right)}n^{d}\right).
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This number grows exponentially with depth.
 This means that adding depth basically allows for more transformations
 of the input space.
\end_layout

\begin_layout Subsection
Gradient-based Learning
\end_layout

\begin_layout Standard
The 
\series bold
gradient
\series default
 of a function 
\begin_inset Formula $f:\mathbb{R}^{n}\rightarrow\mathbb{R}$
\end_inset

, is 
\begin_inset Formula $\nabla f:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}$
\end_inset

, defined at the point 
\begin_inset Formula $p=\left(x_{1},...,x_{n}\right)$
\end_inset

 as
\begin_inset Formula 
\[
\nabla f\left(p\right)=\left(\begin{array}{c}
\frac{\partial f}{\partial x_{1}}\left(p\right)\\
\vdots\\
\frac{\partial f}{\partial x_{n}}\left(p\right)
\end{array}\right).
\]

\end_inset

 This is, it's the local derivative or slope of each dimension at a certain
 point.
\end_layout

\begin_layout Standard
Going in the opposite direction of the gradient is a naïve but practical
 guess of the direction of the local minimum.
 This is the base for the gradient descent method.
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Plain Layout

\series bold
Gradient-descent method 
\series default
(Cauchy, 1847)
\end_layout

\begin_layout Plain Layout
A parametric function 
\begin_inset Formula $f\left(\theta\right)$
\end_inset

 can be iteratively minimized by following the opposite direction of the
 gradient:
\begin_inset Formula 
\[
\theta_{t+1}=\theta_{t}-\varepsilon\nabla_{\theta}f\left(\theta\right),
\]

\end_inset

 where 
\begin_inset Formula $\varepsilon>0$
\end_inset

 is the 
\series bold
learning rate
\series default
.
\end_layout

\begin_layout Plain Layout
We stop iterating when the gradient is near to 0.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Notice that this is useless if we have a close form for the gradient! In
 that case it is easier to just minimize it.
 This is useful when this is not the case, which always happens for neural
 networks.
\end_layout

\begin_layout Standard
In addition, there are variations to the method, for example, we can vary
 
\begin_inset Formula $\varepsilon$
\end_inset

 during training.
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Plain Layout

\series bold
Stochastic gradient descent
\end_layout

\begin_layout Plain Layout
Given a cost function 
\begin_inset Formula $f\left(\theta\right)$
\end_inset

, parameters of the network are updated with
\begin_inset Formula 
\[
\theta\leftarrow\theta-\varepsilon\nabla_{\theta}f\left(\theta\right).
\]

\end_inset


\end_layout

\begin_layout Plain Layout
For the negative log-likelihood (MLE), the function is:
\begin_inset Formula 
\[
f\left(\theta\right)=\frac{1}{m}\sum_{i=1}^{m}L\left(x^{\left(i\right)},y^{\left(i\right)},\theta\right),
\]

\end_inset

 so the estimated gradient is
\begin_inset Formula 
\[
\nabla_{\theta}f\left(\theta\right)=\frac{1}{m}\sum_{i=1}^{m}\nabla_{\theta}L\left(x^{\left(i\right)},y^{\left(i\right)},\theta\right).
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\color red
problem
\color inherit
 with this approach is that to take a single step of gradient descent, we
 must compute the loss over the whole dataset everytime, making the method
 not scalable at all.
 This is called 
\series bold
batch gradient descent
\series default
.
\end_layout

\begin_layout Standard
One 
\color lime
solution
\color inherit
 is to compute the gradient with 1 sample only at each step, which is very
 noisy and inefficient, but works.
 This is the 
\series bold
stochastic gradient descent
\series default
.
\end_layout

\begin_layout Standard
In the middle ground, we find the 
\series bold
mini-batch gradient descent
\series default
, which divides the dataset into subsets, and updates the parameters after
 processing each of these subsets.
 A batch is a collection is a collection of samples used at each iteration
 for performing SDG in DL.
 A bigger batch provides a better gradient estimation, and therefore a faster
 learning, but also implies more device memory and slower descent.
\end_layout

\begin_layout Standard
Therefore, there is a tradeoff between money and performance at companies.
 In practice, a batch is set between 1 to 256 on one GPU.
\end_layout

\begin_layout Standard
But there is an even 
\series bold
\color red
greater problem
\series default
\color inherit
, the computation of the gradient is computationally very costly.
 To go around this problem, 
\series bold
back-propagation
\series default
 was invented, as an efficient technique for gradient computation.
 
\end_layout

\begin_layout Subsubsection
Back-propagation
\end_layout

\begin_layout Standard
The back-propagation algorithm is based on the chain rule for the derivative
 of composite functions: if we have 
\begin_inset Formula $y=g\left(x\right)$
\end_inset

 and 
\begin_inset Formula $z=f\left(y\right)=f\left(g\left(x\right)\right)=\left(f\circ g\right)\left(x\right)$
\end_inset

, then
\begin_inset Formula 
\[
\frac{df}{dx}\left(x\right)=f'\left(g\left(x\right)\right)g'\left(x\right),
\]

\end_inset

 or, abusing notation, 
\begin_inset Formula 
\[
\frac{dz}{dx}=\frac{dz}{dy}\frac{dy}{dx}.
\]

\end_inset

 This is generalized to multivariate funtions as follows: let 
\begin_inset Formula $x\in\mathbb{R}^{m},y\in\mathbb{R}^{n},g:\mathbb{R}^{m}\rightarrow\mathbb{R}^{n}$
\end_inset

 and 
\begin_inset Formula $f:\mathbb{R}^{n}\rightarrow\mathbb{R}$
\end_inset

.
 If 
\begin_inset Formula $z=f\left(y\right)=f\left(g\left(x\right)\right)$
\end_inset

, then
\begin_inset Formula 
\[
\frac{\partial z}{\partial x_{i}}\left(x\right)=\sum_{j}\frac{\partial z}{\partial y_{j}}\frac{\partial y_{j}}{\partial x_{i}},
\]

\end_inset

 or, 
\begin_inset Formula 
\[
\nabla_{x}z=\left(\frac{\partial y}{\partial x}\right)^{T}\nabla_{y}z,
\]

\end_inset

 where 
\begin_inset Formula $\left(\frac{\partial y}{\partial x}\right)$
\end_inset

 is the Jacobian of 
\begin_inset Formula $g$
\end_inset

.
\end_layout

\begin_layout Standard
Now, back-propagation is a recursive application of the chain rule, starting
 from the cost function.
 The algorithm works as follows:
\end_layout

\begin_layout Enumerate

\series bold
Forward pass
\series default
: a feedforward network takes as input 
\begin_inset Formula $x$
\end_inset

 and produces the output 
\begin_inset Formula $\hat{y}$
\end_inset

.
 The information flows from layer to layer.
\end_layout

\begin_layout Enumerate

\series bold
Cost function
\series default
: compute the error between expected output and actual output.
\end_layout

\begin_layout Enumerate

\series bold
Back-propagate
\series default
: evaluate the individual gradient of each parameter and propagates them
 backwards to update them.
 For this, we use the concept of 
\series bold
local derivative
\series default
: the derivative of connected nodes are computed locally on the edges of
 the graph.
 For non-connected nodes, we multiply the edges connected between the nodes,
 and we sum over all incoming edges.
\end_layout

\begin_layout Standard
If we do this in a forward way, summing over all paths becomes intractable
 pretty quickly, while when doing it in a backwards way, it allows to obtain
 the derivative of the output with respect to every node directly in one
 pass.
 This leads to massive parallelization.
\end_layout

\begin_layout Standard
I did a more detailed explanation, with visualizations in my previous notes,
 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://lorenc1o.github.io/BDMA_Notes/universities/UPC/Machine_Learning_summary.pdf
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part
Reinforcement Learning
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
People and animals learn by interacting with the environment that sorround
 them, differing from certain other types of learning.
 This process is active, rather than passive: the subject needs to perform
 interactions with the environment, to obtain knowledge.
 Also, the interactions are usually sequential, with future interactions
 possibly depending on earlier ones.
\end_layout

\begin_layout Standard
Not only this, but we are goal oriented: we act towards an objective.
 And, more importantly, we can learn without examples of optimal behavior!
 Instead, we optimise some reward signal obtained from the outcome of our
 actions.
\end_layout

\begin_layout Standard
It is in these observation that 
\series bold
Reinforcement Learning (RL)
\series default
 arises as a learning paradigm, based on the 
\series bold
interaction loop
\series default
: there is an agent in an environment; the agent can make actions in the
 environment, and get observations from it.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename interaction_loop.png
	scale 60

\end_inset


\end_layout

\begin_layout Standard
RL relies on the reward hypothesis:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Conjecture
Reward Hypothesis
\end_layout

\begin_layout Conjecture
Any goal can be formalized as the outcome of maximizing a cumulative reward.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This hypothesis basically says that every objective that an agent can have,
 can be stated in terms of maximizing a reward associated to the actions
 of the agent with respect to this objective.
\end_layout

\begin_layout Standard
For example, if the objective of the agent is to fly a helicopter from point
 A to point B, then the reward could be negatively affected by the distance
 to point B, by the time taken to reach B,...
\end_layout

\begin_layout Standard
Now, it is important to realize that there exist different reasons to learn:
\end_layout

\begin_layout Itemize
Find solutions to problems.
\end_layout

\begin_layout Itemize
Adapt online to unforseen circumstances.
\end_layout

\begin_layout Standard
Well, RL can provide algorithm for both cases! Note that the second point
 is not just about generalization, but also to cope with the so-called data
 shift, efficiently, during operation.
\end_layout

\begin_layout Standard
With all this, now we can define RL:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
Reinforcement Learning is the science and framework of learning to make
 decisions from interaction.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This requires us to think about time, consequences of actions, experience
 gathering, future prediction, uncertainty,...
\end_layout

\begin_layout Standard
It has a huge potential scope and is a formalisation of the AI problem.
\end_layout

\begin_layout Section
Definition and components
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
The 
\series bold
environment
\series default
 is the world of the problem at hand, with 
\series bold
agents
\series default
 in it that can perform actions, over time.
\end_layout

\begin_layout Definition
At each time step 
\begin_inset Formula $t$
\end_inset

, the agent:
\end_layout

\begin_deeper
\begin_layout Itemize
Receives observation 
\begin_inset Formula $O_{t}$
\end_inset

 and reward 
\begin_inset Formula $R_{t}$
\end_inset

 from the environment.
\end_layout

\begin_layout Itemize
Executes action 
\begin_inset Formula $A_{t}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Definition
And the environment:
\end_layout

\begin_deeper
\begin_layout Itemize
Receives action 
\begin_inset Formula $A_{t}$
\end_inset

.
\end_layout

\begin_layout Itemize
Emits observation 
\begin_inset Formula $O_{t+1}$
\end_inset

 and reward 
\begin_inset Formula $R_{t+1}$
\end_inset

.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
But, what is a reward?
\end_layout

\begin_layout Standard
A 
\series bold
reward
\series default
, 
\begin_inset Formula $R_{t}$
\end_inset

, is a scalar feedback signal which indicates how well the agent is doing
 at step 
\begin_inset Formula $t$
\end_inset

: it defines how well the goal is being accomplished!
\end_layout

\begin_layout Standard
Therefore, the agent's job is to maximize the cummulative reward of the
 future steps, i.e., 
\begin_inset Formula 
\[
G_{t}=R_{t+1}+R_{t+2}+R_{t+3}+...
\]

\end_inset

 This is called the 
\series bold
return
\series default
.
 But, when one thinks about it carefully, one realizes that it is hard to
 know the future rewards with such precision.
 Therefore, it is also usual to use the 
\series bold
value
\series default
, which is the expected return, taking into account the current state, 
\begin_inset Formula $s$
\end_inset

:
\begin_inset Formula 
\[
v\left(s\right)=\mathbb{E}\left[G_{t}|S_{t}=s\right].
\]

\end_inset

 This depends on the actions the agents takes, and the goal is to 
\color blue
maximize it
\color inherit
! To achieve this, the agent must pick suitable actions.
\end_layout

\begin_layout Standard
Therefore, rewards and values define the utility of states and actions,
 and in this setup there is no supervised feedback.
\end_layout

\begin_layout Standard
Note, also, that this values can be defined recursively as
\begin_inset Formula 
\[
G_{t}=R_{t+1}+G_{t+1},
\]

\end_inset

 
\begin_inset Formula 
\[
v\left(s\right)=\mathbb{E}\left[R_{t+1}+v\left(S_{t+1}\right)|S_{t}=s\right].
\]

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
environment state
\series default
 is the environment's internal state, which is usually invisible or partially
 visible to the agent.
 It is very important, but it can also contain lots of irrelevant information.
\end_layout

\begin_layout Standard
An environment is 
\series bold
fully observable
\series default
 when the agent can see the full environment state, so every observation
 reveals the whole environment state.
 That is, the agent state could just be the observation:
\begin_inset Formula 
\[
S_{t}=O_{t}.
\]

\end_inset


\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $S_{t}$
\end_inset

 is the agent state, not the environment state!
\end_layout

\begin_layout Subsection
Maximising the value by taking actions
\end_layout

\begin_layout Standard
As we have outlined, the goal is to select the actions that maximise the
 value.
 For this, we may need to take into account that actions may have long term
 consequences, delaying rewards.
 Thus, it may be better to sacrifice immediate reward to gain long-term
 reward.
\end_layout

\begin_layout Standard
The decision making process that for a given state chooses which action
 to take is called a 
\series bold
policy
\series default
.
 
\end_layout

\begin_layout Standard
To decide which action to take, we can also condition the value on actions:
\begin_inset Formula 
\[
q\left(s,a\right)=\mathbb{E}\left[G_{t}|S_{t}=s,A_{t}=a\right],
\]

\end_inset

 so, for a given state 
\begin_inset Formula $s$
\end_inset

, a possible set of actions 
\begin_inset Formula $A_{t}^{s}$
\end_inset

, we could decide which action to take as
\begin_inset Formula 
\[
a_{t}=\max_{a\in A_{t}^{s}}q\left(s,a\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Then, the 
\series bold
history
\series default
 is the full sequence of observation, actions and rewards:
\begin_inset Formula 
\[
\mathcal{H}_{t}=O_{0},A_{0},R_{1},O_{1},...,O_{t-1},A_{t-1},R_{t},O_{t}.
\]

\end_inset


\end_layout

\begin_layout Subsection
Markov Decision Processes
\end_layout

\begin_layout Standard
Markov Decision Processes (MDPs) are a useful mathematical framework, defined
 as:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
A decision process is Markov if
\begin_inset Formula 
\[
p\left(r,s|S_{t},A_{t}\right)=p\left(r,s|\mathcal{H}_{t},A_{t}\right).
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This means that the current state is the only information needed to make
 a decision, we don't need the full story.
 For example, think in a chess game: there are many ways to arrive to a
 certain position, but it really does not matter how to got to the position,
 the past does not affect your choice now.
\end_layout

\begin_layout Standard
In order for a process to be Markov, full observability is required.
 When the situation is of 
\series bold
partial observability
\series default
, the observations are not Markovian, so using the observation as state
 is not enough to make the decision.
 This is called a 
\series bold
partially observable Markov decision process (POMDP)
\series default
.
 Note that the environment state can still be Markov, but the agent does
 not know it.
 In this case, we might be able to construct a Markov agent state.
\end_layout

\begin_layout Standard
In the general case, the agent state is a function of the history:
\begin_inset Formula 
\[
S_{t+1}=u\left(S_{t},A_{t},R_{t+1},O_{t+1}\right),
\]

\end_inset

 where 
\begin_inset Formula $u$
\end_inset

 is a 
\series bold
state update function
\series default
.
\end_layout

\begin_layout Standard
Usually, the agent state is much smaller than the environment state.
\end_layout

\begin_layout Example
A not Markov process:
\end_layout

\begin_layout Example
Consider the following maze to be the full environment:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename pegado2.png

\end_inset


\end_layout

\end_deeper
\begin_layout Example
And consider the following observations:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename pegado3.png

\end_inset


\begin_inset Graphics
	filename pegado4.png

\end_inset


\end_layout

\end_deeper
\begin_layout Example
They are indistinguishable! This process is not Markov, because only taking
 into account the current state, we cannot identify where we are.
\end_layout

\begin_layout Standard
To deal with partial observability, agent can construct suitable state represent
ations.
 Some examples of agent states are:
\end_layout

\begin_layout Itemize
Last observation: 
\begin_inset Formula $S_{t}=O_{t}$
\end_inset

 (might not be enough).
\end_layout

\begin_layout Itemize
Complete history: 
\begin_inset Formula $S_{t}=\mathcal{H}_{t}$
\end_inset

 (might be too large).
\end_layout

\begin_layout Itemize
A generic update: 
\begin_inset Formula $S_{t}=u\left(S_{t-1},A_{t-1},R_{t},O_{t}\right)$
\end_inset

 (but how to design 
\begin_inset Formula $u$
\end_inset

?)
\end_layout

\begin_layout Standard
Constructing a fully Markovian agent state is often not feasible and, more
 importantly, the state should allow for good policies and value predictions.
\end_layout

\begin_layout Subsection
Policies
\end_layout

\begin_layout Standard
As we saw, a 
\series bold
policy
\series default
 defines the agent's behavior: it is a map from the agent state to an action.
 Policies can be deterministic,
\begin_inset Formula 
\[
A=\pi\left(S\right),
\]

\end_inset

 or stochastic,
\begin_inset Formula 
\[
\pi\left(A|S\right)=p\left(A|S\right).
\]

\end_inset


\end_layout

\begin_layout Subsection
Value Functions
\end_layout

\begin_layout Standard
We saw the value before, which is the expected return.
 However, it is usual to introduce a 
\series bold
discount factor
\series default
, 
\begin_inset Formula $\gamma\in\left[0,1\right]$
\end_inset

, which trades off importance of immediate and long-term rewards.
 This way, the value becomes
\begin_inset Formula 
\[
v_{\pi}\left(s\right)=\mathbb{E}\left[G_{t}|S_{t}=s,\pi\right]=\mathbb{E}\left[R_{t+1}+\gamma R_{t+2}+\gamma^{2}R_{t+3}+...|S_{t}=s,\pi\right].
\]

\end_inset

 The value depends on the policy, 
\begin_inset Formula $\pi$
\end_inset

, and can be used to evaluate the desirability of states, as well as to
 select between actions.
\end_layout

\begin_layout Standard
Note the role of the discount factor: the higher it is, the higher the focus
 on long term outcomes.
\end_layout

\begin_layout Standard
Now, using the recursive expression of the return, 
\begin_inset Formula $G_{t}=R_{t+1}+\gamma G_{t+1}$
\end_inset

, we can rewrite the value as
\begin_inset Formula 
\[
v_{\pi}\left(s\right)=\mathbb{E}\left[R_{t+1}+\gamma v_{\pi}\left(S_{t+1}\right)|S_{t}=a,A_{t}\sim\pi\left(s\right)\right],
\]

\end_inset

 where 
\begin_inset Formula $A\sim\pi\left(s\right)$
\end_inset

 means 
\begin_inset Formula $A$
\end_inset

 is chosen by policy 
\begin_inset Formula $\pi$
\end_inset

 in state 
\begin_inset Formula $s$
\end_inset

.
 This is known as a 
\series bold
Bellman equation
\series default
.
 A similar equation holds for the optimal value, i.e., the highest possible
 value:
\begin_inset Formula 
\[
v_{*}\left(s\right)=\max_{a}\mathbb{E}\left[R_{t+1}+\gamma v_{*}\left(S_{t+1}\right)|S_{t}=s,A_{t}=a\right].
\]

\end_inset

 Note how this does not depend on a policy, it is just the maximum achievable
 value from the current state.
\end_layout

\begin_layout Subsubsection
Value Function Approximations
\end_layout

\begin_layout Standard
Agents often approximate value functions, and with an accurate value function
 approximation, the agent can behave optimally, or very well, even in intractabl
y big domains.
\end_layout

\begin_layout Subsection
Model
\end_layout

\begin_layout Standard
A 
\series bold
model
\series default
 predicts what the environment will do next.
 For example, 
\begin_inset Formula $\mathcal{P}$
\end_inset

 predicts the next state, given the current state and an action:
\begin_inset Formula 
\[
\mathcal{P}\left(s,a,s'\right)\approx p\left(S_{t+1}=s'|S_{t}=s,A_{t}=a\right).
\]

\end_inset

 Or 
\begin_inset Formula $\mathcal{R}$
\end_inset

 predicts the next immediate reward:
\begin_inset Formula 
\[
\mathcal{R}\left(s,a\right)\approx\mathbb{E}\left[R_{t+1}|S_{t}=s,A_{t}=a\right].
\]

\end_inset

 Note that a model does not immediately give us a good policy! We still
 need to plan and see how actions and states are related.
 
\end_layout

\begin_layout Example
Consider the following maze, where the rewards are -1 per time-step, the
 actions are to go N, E, S and W, and the states are the agent's location:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="10">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

Start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

End
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Example
The following arrows represent the policy, 
\begin_inset Formula $\pi\left(s\right)$
\end_inset

, for each state 
\begin_inset Formula $s$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="10">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado9.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

Start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado6.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado6.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado9.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado6.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado8.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado9.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado8.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado6.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado8.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado9.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado9.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado6.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado9.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado6.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado8.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\begin_inset Graphics
	filename pegado5.png
	scale 30

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

End
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Example
In the following one, the numbers represent the value 
\begin_inset Formula $v_{\pi}\left(s\right)$
\end_inset

 of each state 
\begin_inset Formula $s$
\end_inset

:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="10">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

Start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-18
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-19
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

-1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset

End
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
rowcolor{black}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cellcolor{white}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The grid layout represents the partial transition model 
\begin_inset Formula $\mathcal{P}_{ss'}^{a}$
\end_inset

, and numbers represent the immediate reward, 
\begin_inset Formula $\mathcal{R}_{ss'}^{a}$
\end_inset

 from each state 
\begin_inset Formula $s$
\end_inset

, which is -1 for all 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $s'$
\end_inset

 in this case.
\end_layout

\begin_layout Subsection
Agent categories
\end_layout

\begin_layout Standard
An agent is 
\series bold
model free
\series default
 when the behavior of the environment is not known.
 The agent needs a policy or a value function to operate and there is no
 model.
 On the other hand, it is 
\series bold
model based
\series default
 when the environment is known by means of a model.
 In this case, a policy and a value function might be optional, since it
 is possible that the agent can operate just knowing the model.
\end_layout

\begin_layout Standard
Model free agents are simpler, while model based agents are more sample
 efficient.
\end_layout

\begin_layout Standard
Another categorization is the following:
\end_layout

\begin_layout Itemize
Value based: there is no policy, it is implicit in the value function.
\end_layout

\begin_layout Itemize
Policy based: there is no value function, the model operates only by means
 of the policy.
\end_layout

\begin_layout Itemize
Actor critic: they have both a policy and a value function.
\end_layout

\begin_layout Subsection
Subproblems of RL
\end_layout

\begin_layout Standard

\series bold
Prediction 
\series default
consists in evaluating the future, for a given policy, i.e., what are the
 values in each state?
\end_layout

\begin_layout Standard

\series bold
Control
\series default
 refers to the problem of optimising the future to find the best policy,
 i.e., which actions to take?
\end_layout

\begin_layout Standard
These two problems are strongly related, because the best actions to take
 will be decided using our predictions about the future:
\begin_inset Formula 
\[
\pi_{*}\left(s\right)=\arg\max_{\pi}v_{\pi}\left(s\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Two fundamental problems in RL are:
\end_layout

\begin_layout Itemize
Learning: the environment is initially unknown and the agent interacts with
 it to learn.
\end_layout

\begin_layout Itemize
Planning/search: a model of the environment is given or learnt, and the
 agent plans in this model.
\end_layout

\begin_layout Standard
In order to learn, we need to define all components of the problem as functions:
\end_layout

\begin_layout Itemize
Policy: 
\begin_inset Formula $\pi:S\rightarrow A$
\end_inset

 (or probabilities over 
\begin_inset Formula $A$
\end_inset

).
\end_layout

\begin_layout Itemize
Value functions: 
\begin_inset Formula $v:S\rightarrow\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Itemize
Models: 
\begin_inset Formula $p:S\rightarrow S$
\end_inset

 or 
\begin_inset Formula $r:S\rightarrow\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Itemize
State update: 
\begin_inset Formula $u:S\times O\rightarrow S$
\end_inset

.
\end_layout

\begin_layout Standard
Then, we can use, for example, neural networks and deep learning techniques
 to learn.
 But we do need to be careful, because in RL it is usual to violate assumptios
 made in supervised learning, such as having i.i.d.
 samples, or stationarity.
\end_layout

\begin_layout Section
Markov Decision Processes
\end_layout

\begin_layout Standard
We saw the notion of MDP, and now we formalize it:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
A 
\series bold
Markov Decision Process (MDP)
\series default
 is a tuple 
\begin_inset Formula $\left(S,A,p,\gamma\right)$
\end_inset

 where:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $S$
\end_inset

 is the set of all possible states with the Markov Property.
\end_layout

\begin_layout Itemize
\begin_inset Formula $A$
\end_inset

 is the set of all possible actions.
\end_layout

\begin_layout Itemize
\begin_inset Formula $p\left(r,s'|s,a\right)$
\end_inset

 is the joint probability of a reward, 
\begin_inset Formula $r$
\end_inset

, and next state, 
\begin_inset Formula $s'$
\end_inset

, given a state 
\begin_inset Formula $s$
\end_inset

 and an action 
\begin_inset Formula $a$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\gamma\in\left[0,1\right]$
\end_inset

 is a discount factor that trades off later rewards to earlier ones.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Remark
\begin_inset Formula $p$
\end_inset

 defines the dynamics of the problem.
\end_layout

\begin_layout Remark
Sometimes, it is useful to marginalise out the state transitions or expected
 rewards:
\begin_inset Formula 
\[
p\left(s'|s,a\right)=\sum_{r}p\left(s',r|s,a\right),
\]

\end_inset

 to obtain the probability of arriving to a certain state.
\end_layout

\begin_layout Remark
Also, the expected reward:
\begin_inset Formula 
\[
\mathbb{E}\left[R|s,a\right]=\sum_{r}r\sum_{s'}p\left(r,s'|s,a\right).
\]

\end_inset


\end_layout

\begin_layout Standard
There is an alternative equivalent definition, which introduces the notion
 of the expected reward into the concept, and takes it out of the probabity
 function:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
A MDP is a tuple 
\begin_inset Formula $\left(S,A,p,r,\gamma\right)$
\end_inset

 where:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $S$
\end_inset

 is the set of all possible states with the Markov Property.
\end_layout

\begin_layout Itemize
\begin_inset Formula $A$
\end_inset

 is the set of all possible actions.
\end_layout

\begin_layout Itemize
\begin_inset Formula $p\left(s'|s,a\right)$
\end_inset

 is the probability of transitioning to 
\begin_inset Formula $s'$
\end_inset

, fiven a state 
\begin_inset Formula $s$
\end_inset

 and an action 
\begin_inset Formula $a$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $r:S\times A\rightarrow\mathbb{R}$
\end_inset

 is the expected reward, achieved on a transition starting in 
\begin_inset Formula $\left(s,a\right)$
\end_inset

,
\begin_inset Formula 
\[
r=\mathbb{E}\left[R|s,a\right].
\]

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\gamma\in\left[0,1\right]$
\end_inset

 is a discount factor that trades off later rewards to earlier ones.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
Now, we have to clarify what is the Markov Property:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
Consider a sequence of random variables, 
\begin_inset Formula $\left\{ S_{t}\right\} _{t\in\mathbb{N}}$
\end_inset

, indexed by time and taken from a set of states 
\begin_inset Formula $S$
\end_inset

.
 Consider also the set of actions 
\begin_inset Formula $A$
\end_inset

 and rewards in 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Definition
A state 
\begin_inset Formula $s$
\end_inset

 has the 
\series bold
Markov Property
\series default
 when, for all 
\begin_inset Formula $s'\in S$
\end_inset

,
\begin_inset Formula 
\[
p\left(S_{t+1}=s'|S_{t}=s\right)=p\left(S_{t+1}=s'|h_{t-1},S_{t}=s\right),
\]

\end_inset

 for all possible histories 
\begin_inset Formula $h_{t-1}=\left\{ S_{1},...,S_{t-1},A_{1},...,A_{t-1},R_{1},...,R_{t-1}\right\} $
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Therefore, in an MDP, the current state captures all relevant information
 from the history, it is a sufficient statistic of the past.
 So, once the state is known, the history may be thrown away.
\end_layout

\begin_layout Exercise
In an MDP, which of the following statemest are true?
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $p\left(S_{t+1}=s'|S_{t}=s,A_{t}=a\right)=p\left(S_{t+1}=s'|S_{1},...,S_{t-1},A_{1},...,A_{t},S_{t}=s\right)$
\end_inset

: false, the RHS does not condition on 
\begin_inset Formula $A_{t}=a$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $p\left(S_{t+1}=s'|S_{t}=s,A_{t}=a\right)=p\left(S_{t+1}=s'|S_{1},...,S_{t-1},S_{t}=s,A_{t}=a\right)$
\end_inset

: true.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $p\left(S_{t+1}=s'|S_{t}=s,A_{t}=a\right)=p\left(S_{t+1}=s'|S_{1},...,S_{t-1},S_{t}=s\right)$
\end_inset

: false, the RHS does not condition on 
\begin_inset Formula $A_{t}=a$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $p\left(R_{t+1}=r,S_{t+1}=s'|S_{t}=s\right)=p\left(R_{t+1}=r,S_{t+1}=s'|S_{1},...,S_{t-1},S_{t}=s\right)$
\end_inset

: true.
\end_layout

\end_deeper
\begin_layout Standard
It is also worth noting that most MDPs are discounted, and there are several
 reasons for these:
\end_layout

\begin_layout Itemize
Problem specification: immediate rewards may actually be more valuable.
 For instance, animal/human behavior shows preference for immediate reward.
\end_layout

\begin_layout Itemize
Solution side: it is mathematically convenient to discount rewards, because
 it allows for easier proofs of convergence, and avoids infinite returns
 in cyclic Markov processes.
\end_layout

\begin_layout Standard
As we outlined previously, the 
\series bold
goal of an RL agent
\series default
 is to find a behavior policy that maximises the expected return 
\begin_inset Formula $G_{t}$
\end_inset

.
 Recall our definition for value funtion
\begin_inset Formula 
\[
v_{\pi}\left(s\right)=\mathbb{E}\left[G_{t}|S_{t}=s,\pi\right].
\]

\end_inset

 Similarly, we can define the 
\series bold
state-action values
\series default
, as
\begin_inset Formula 
\[
q_{\pi}\left(s,a\right)=\mathbb{E}\left[G_{t}|S_{t}=s,A_{t}=a,\pi\right],
\]

\end_inset

 and there is the following connection between them:
\begin_inset Formula 
\[
v_{\pi}\left(s\right)=\sum_{a}\pi\left(a|s\right)q_{\pi}\left(s,a\right)=\mathbb{E}\left[q_{\pi}\left(S_{t},A_{t}\right)|S_{t}=s,\pi\right],\forall s\in S.
\]

\end_inset


\end_layout

\begin_layout Standard
Also, we can define the maximum possible value functions:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Definition
The 
\series bold
optimal state value function
\series default
, 
\begin_inset Formula $v^{*}\left(s\right)$
\end_inset

, is the maximum value function over all policies,
\begin_inset Formula 
\[
v^{*}\left(s\right)=\max_{\pi}v_{\pi}\left(s\right).
\]

\end_inset

 The 
\series bold
optimal state-action value function
\series default
, 
\begin_inset Formula $q^{*}\left(s,a\right)$
\end_inset

, is the amximum state-action value function over all policies,
\begin_inset Formula 
\[
q^{*}\left(s,a\right)=\max_{\pi}q_{\pi}\left(s,a\right).
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The optimal value function specifies the best possible performance in the
 MDP.
 We can consider the MDP to be solved when we know the optimal value function.
\end_layout

\begin_layout Standard
In addition, value functions allow us to define a partial ordering over
 policies, having
\begin_inset Formula 
\[
\pi\geq\pi'\iff v_{\pi}\left(s\right)\geq v_{\pi'}\left(s\right),\forall s\in S.
\]

\end_inset


\end_layout

\begin_layout Standard
With this partial ordering, the following theorem state that optimal policies
 exist for every MDP:
\end_layout

\begin_layout Standard
\begin_inset Flex Color Box
status open

\begin_layout Theorem

\series bold
Optimal Policies Theorem
\end_layout

\begin_layout Theorem
For any MDP:
\end_layout

\begin_deeper
\begin_layout Itemize
There exists an optimal policy 
\begin_inset Formula $\pi^{*}$
\end_inset

 that is better than or equal to all other policies,
\begin_inset Formula 
\[
\pi^{*}\geq\pi,\forall\pi.
\]

\end_inset


\end_layout

\begin_layout Itemize
All optimal policies achieve the optimal value function,
\begin_inset Formula 
\[
v^{\pi^{*}}\left(s\right)=v^{*}\left(s\right).
\]

\end_inset


\end_layout

\begin_layout Itemize
All optimal policies achieve the optimal state-action value function, 
\begin_inset Formula 
\[
q^{\pi^{*}}\left(s,a\right)=q^{*}\left(s,a\right).
\]

\end_inset


\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
To find an optimal policy, we can maximise over 
\begin_inset Formula $q^{*}\left(s,a\right)$
\end_inset

:
\begin_inset Formula 
\[
\pi^{*}\left(s,a\right)=\begin{cases}
1 & if\ a=\arg\max_{a\in A}q^{*}\left(s,a\right)\\
0 & otherwise
\end{cases}.
\]

\end_inset


\end_layout

\begin_layout Standard
That is, the optimal policy is to take action 
\begin_inset Formula $a$
\end_inset

 in state 
\begin_inset Formula $s$
\end_inset

 if 
\begin_inset Formula $a$
\end_inset

 is the action that gives the highes state-action value given state 
\begin_inset Formula $s$
\end_inset

.
\end_layout

\begin_layout Remark
There is always a deterministic optimal policy for any MDP, and we know
 
\begin_inset Formula $q^{*}\left(s,a\right)$
\end_inset

, we know it imm
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "ps-cs"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
